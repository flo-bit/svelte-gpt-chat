import{J as K1,S as Bt,i as It,s as kt,k as qe,K as l0,l as Ye,m as He,L as o0,h as we,n as de,b as u0,G as pe,M as Z0,H as rt,N as jt,o as w1,a as i0,c as s0,O as yt,g as z0,v as xa,f as Ta,d as at,P as x1,I as x0,q as d0,r as h0,e as Pa,w as Q1,Q as W1,y as Gt,z as qt,A as Yt,R as j1,B as Ut,T as T1,U as $t,u as M1}from"./index.e6c0d8b8.js";import{_ as z1}from"./preload-helper.41c905a7.js";import{w as dt,r as R1}from"./index.f7323257.js";function Zt(d,{delay:o=0,duration:t=400,easing:s=K1}={}){const h=+getComputedStyle(d).opacity;return{delay:o,duration:t,easing:s,css:S=>`opacity: ${S*h}`}}var Mt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function J1(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function g1(d){return new Int8Array(d)}function E1(d){return new Int16Array(d)}function B1(d){return new Int32Array(d)}function I1(d){return new Float32Array(d)}function er(d){return new Float64Array(d)}function k1(d){if(d.length==1)return I1(d[0]);var o=d[0];d=d.slice(1);for(var t=[],s=0;s<o;s++)t.push(k1(d));return t}function L1(d){if(d.length==1)return B1(d[0]);var o=d[0];d=d.slice(1);for(var t=[],s=0;s<o;s++)t.push(L1(d));return t}function C1(d){if(d.length==1)return E1(d[0]);var o=d[0];d=d.slice(1);for(var t=[],s=0;s<o;s++)t.push(C1(d));return t}function O1(d){if(d.length==1)return new Array(d[0]);var o=d[0];d=d.slice(1);for(var t=[],s=0;s<o;s++)t.push(O1(d));return t}var H1={};H1.fill=function(d,o,t,s){if(arguments.length==2)for(var h=0;h<d.length;h++)d[h]=arguments[1];else for(var h=o;h<t;h++)d[h]=s};var Lt={};Lt.arraycopy=function(d,o,t,s,h){for(var S=o+h;o<S;)t[s++]=d[o++]};Lt.out={};Lt.out.println=function(d){console.log(d)};Lt.out.printf=function(){console.log.apply(console,arguments)};var zt={};zt.SQRT2=1.4142135623730951;zt.FAST_LOG10=function(d){return Math.log10(d)};zt.FAST_LOG10_X=function(d,o){return Math.log10(d)*o};function it(d){this.ordinal=d}it.short_block_allowed=new it(0);it.short_block_coupled=new it(1);it.short_block_dispensed=new it(2);it.short_block_forced=new it(3);var V1={};V1.MAX_VALUE=34028235e31;function q0(d){this.ordinal=d}q0.vbr_off=new q0(0);q0.vbr_mt=new q0(1);q0.vbr_rh=new q0(2);q0.vbr_abr=new q0(3);q0.vbr_mtrh=new q0(4);q0.vbr_default=q0.vbr_mtrh;var tr=function(d){},t0={System:Lt,VbrMode:q0,Float:V1,ShortBlock:it,Util:zt,Arrays:H1,new_array_n:O1,new_byte:g1,new_double:er,new_float:I1,new_float_n:k1,new_int:B1,new_int_n:L1,new_short:E1,new_short_n:C1,assert:tr},ua,Ga;function ar(){if(Ga)return ua;Ga=1;var d=t0,o=d.System;d.VbrMode,d.Float,d.ShortBlock;var t=d.Util,s=d.Arrays;d.new_array_n,d.new_byte,d.new_double;var h=d.new_float;d.new_float_n,d.new_int,d.new_int_n,d.assert;var S=b0();function c(){var x=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*t.SQRT2*.5/2384e-9,.017876148*t.SQRT2*.5/2384e-9,.003134727*t.SQRT2*.5/2384e-9,.002457142*t.SQRT2*.5/2384e-9,971317e-9*t.SQRT2*.5/2384e-9,218868e-9*t.SQRT2*.5/2384e-9,101566e-9*t.SQRT2*.5/2384e-9,13828e-9*t.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],H=12,$=36,y=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],e=y[S.SHORT_TYPE],a=y[S.SHORT_TYPE],f=y[S.SHORT_TYPE],A=y[S.SHORT_TYPE],k=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function I(b,M,r){for(var p=10,L=M+238-14-286,P=-15;P<0;P++){var N,V,Q;N=x[p+-10],V=b[L+-224]*N,Q=b[M+224]*N,N=x[p+-9],V+=b[L+-160]*N,Q+=b[M+160]*N,N=x[p+-8],V+=b[L+-96]*N,Q+=b[M+96]*N,N=x[p+-7],V+=b[L+-32]*N,Q+=b[M+32]*N,N=x[p+-6],V+=b[L+32]*N,Q+=b[M+-32]*N,N=x[p+-5],V+=b[L+96]*N,Q+=b[M+-96]*N,N=x[p+-4],V+=b[L+160]*N,Q+=b[M+-160]*N,N=x[p+-3],V+=b[L+224]*N,Q+=b[M+-224]*N,N=x[p+-2],V+=b[M+-256]*N,Q-=b[L+256]*N,N=x[p+-1],V+=b[M+-192]*N,Q-=b[L+192]*N,N=x[p+0],V+=b[M+-128]*N,Q-=b[L+128]*N,N=x[p+1],V+=b[M+-64]*N,Q-=b[L+64]*N,N=x[p+2],V+=b[M+0]*N,Q-=b[L+0]*N,N=x[p+3],V+=b[M+64]*N,Q-=b[L+-64]*N,N=x[p+4],V+=b[M+128]*N,Q-=b[L+-128]*N,N=x[p+5],V+=b[M+192]*N,Q-=b[L+-192]*N,V*=x[p+6],N=Q-V,r[30+P*2]=Q+V,r[31+P*2]=x[p+7]*N,p+=18,M--,L++}{var V,Q,j,B;Q=b[M+-16]*x[p+-10],V=b[M+-32]*x[p+-2],Q+=(b[M+-48]-b[M+16])*x[p+-9],V+=b[M+-96]*x[p+-1],Q+=(b[M+-80]+b[M+48])*x[p+-8],V+=b[M+-160]*x[p+0],Q+=(b[M+-112]-b[M+80])*x[p+-7],V+=b[M+-224]*x[p+1],Q+=(b[M+-144]+b[M+112])*x[p+-6],V-=b[M+32]*x[p+2],Q+=(b[M+-176]-b[M+144])*x[p+-5],V-=b[M+96]*x[p+3],Q+=(b[M+-208]+b[M+176])*x[p+-4],V-=b[M+160]*x[p+4],Q+=(b[M+-240]-b[M+208])*x[p+-3],V-=b[M+224],j=V-Q,B=V+Q,Q=r[14],V=r[15]-Q,r[31]=B+Q,r[30]=j+V,r[15]=j-V,r[14]=B-Q}{var n;n=r[28]-r[0],r[0]+=r[28],r[28]=n*x[p+-2*18+7],n=r[29]-r[1],r[1]+=r[29],r[29]=n*x[p+-2*18+7],n=r[26]-r[2],r[2]+=r[26],r[26]=n*x[p+-4*18+7],n=r[27]-r[3],r[3]+=r[27],r[27]=n*x[p+-4*18+7],n=r[24]-r[4],r[4]+=r[24],r[24]=n*x[p+-6*18+7],n=r[25]-r[5],r[5]+=r[25],r[25]=n*x[p+-6*18+7],n=r[22]-r[6],r[6]+=r[22],r[22]=n*t.SQRT2,n=r[23]-r[7],r[7]+=r[23],r[23]=n*t.SQRT2-r[7],r[7]-=r[6],r[22]-=r[7],r[23]-=r[22],n=r[6],r[6]=r[31]-n,r[31]=r[31]+n,n=r[7],r[7]=r[30]-n,r[30]=r[30]+n,n=r[22],r[22]=r[15]-n,r[15]=r[15]+n,n=r[23],r[23]=r[14]-n,r[14]=r[14]+n,n=r[20]-r[8],r[8]+=r[20],r[20]=n*x[p+-10*18+7],n=r[21]-r[9],r[9]+=r[21],r[21]=n*x[p+-10*18+7],n=r[18]-r[10],r[10]+=r[18],r[18]=n*x[p+-12*18+7],n=r[19]-r[11],r[11]+=r[19],r[19]=n*x[p+-12*18+7],n=r[16]-r[12],r[12]+=r[16],r[16]=n*x[p+-14*18+7],n=r[17]-r[13],r[13]+=r[17],r[17]=n*x[p+-14*18+7],n=-r[20]+r[24],r[20]+=r[24],r[24]=n*x[p+-12*18+7],n=-r[21]+r[25],r[21]+=r[25],r[25]=n*x[p+-12*18+7],n=r[4]-r[8],r[4]+=r[8],r[8]=n*x[p+-12*18+7],n=r[5]-r[9],r[5]+=r[9],r[9]=n*x[p+-12*18+7],n=r[0]-r[12],r[0]+=r[12],r[12]=n*x[p+-4*18+7],n=r[1]-r[13],r[1]+=r[13],r[13]=n*x[p+-4*18+7],n=r[16]-r[28],r[16]+=r[28],r[28]=n*x[p+-4*18+7],n=-r[17]+r[29],r[17]+=r[29],r[29]=n*x[p+-4*18+7],n=t.SQRT2*(r[2]-r[10]),r[2]+=r[10],r[10]=n,n=t.SQRT2*(r[3]-r[11]),r[3]+=r[11],r[11]=n,n=t.SQRT2*(-r[18]+r[26]),r[18]+=r[26],r[26]=n-r[18],n=t.SQRT2*(-r[19]+r[27]),r[19]+=r[27],r[27]=n-r[19],n=r[2],r[19]-=r[3],r[3]-=n,r[2]=r[31]-n,r[31]+=n,n=r[3],r[11]-=r[19],r[18]-=n,r[3]=r[30]-n,r[30]+=n,n=r[18],r[27]-=r[11],r[19]-=n,r[18]=r[15]-n,r[15]+=n,n=r[19],r[10]-=n,r[19]=r[14]-n,r[14]+=n,n=r[10],r[11]-=n,r[10]=r[23]-n,r[23]+=n,n=r[11],r[26]-=n,r[11]=r[22]-n,r[22]+=n,n=r[26],r[27]-=n,r[26]=r[7]-n,r[7]+=n,n=r[27],r[27]=r[6]-n,r[6]+=n,n=t.SQRT2*(r[0]-r[4]),r[0]+=r[4],r[4]=n,n=t.SQRT2*(r[1]-r[5]),r[1]+=r[5],r[5]=n,n=t.SQRT2*(r[16]-r[20]),r[16]+=r[20],r[20]=n,n=t.SQRT2*(r[17]-r[21]),r[17]+=r[21],r[21]=n,n=-t.SQRT2*(r[8]-r[12]),r[8]+=r[12],r[12]=n-r[8],n=-t.SQRT2*(r[9]-r[13]),r[9]+=r[13],r[13]=n-r[9],n=-t.SQRT2*(r[25]-r[29]),r[25]+=r[29],r[29]=n-r[25],n=-t.SQRT2*(r[24]+r[28]),r[24]-=r[28],r[28]=n-r[24],n=r[24]-r[16],r[24]=n,n=r[20]-n,r[20]=n,n=r[28]-n,r[28]=n,n=r[25]-r[17],r[25]=n,n=r[21]-n,r[21]=n,n=r[29]-n,r[29]=n,n=r[17]-r[1],r[17]=n,n=r[9]-n,r[9]=n,n=r[25]-n,r[25]=n,n=r[5]-n,r[5]=n,n=r[21]-n,r[21]=n,n=r[13]-n,r[13]=n,n=r[29]-n,r[29]=n,n=r[1]-r[0],r[1]=n,n=r[16]-n,r[16]=n,n=r[17]-n,r[17]=n,n=r[8]-n,r[8]=n,n=r[9]-n,r[9]=n,n=r[24]-n,r[24]=n,n=r[25]-n,r[25]=n,n=r[4]-n,r[4]=n,n=r[5]-n,r[5]=n,n=r[20]-n,r[20]=n,n=r[21]-n,r[21]=n,n=r[12]-n,r[12]=n,n=r[13]-n,r[13]=n,n=r[28]-n,r[28]=n,n=r[29]-n,r[29]=n,n=r[0],r[0]+=r[31],r[31]-=n,n=r[1],r[1]+=r[30],r[30]-=n,n=r[16],r[16]+=r[15],r[15]-=n,n=r[17],r[17]+=r[14],r[14]-=n,n=r[8],r[8]+=r[23],r[23]-=n,n=r[9],r[9]+=r[22],r[22]-=n,n=r[24],r[24]+=r[7],r[7]-=n,n=r[25],r[25]+=r[6],r[6]-=n,n=r[4],r[4]+=r[27],r[27]-=n,n=r[5],r[5]+=r[26],r[26]-=n,n=r[20],r[20]+=r[11],r[11]-=n,n=r[21],r[21]+=r[10],r[10]-=n,n=r[12],r[12]+=r[19],r[19]-=n,n=r[13],r[13]+=r[18],r[18]-=n,n=r[28],r[28]+=r[3],r[3]-=n,n=r[29],r[29]+=r[2],r[2]-=n}}function u(b,M){for(var r=0;r<3;r++){var p,L,P,N,V,Q;N=b[M+2*3]*y[S.SHORT_TYPE][0]-b[M+5*3],p=b[M+0*3]*y[S.SHORT_TYPE][2]-b[M+3*3],L=N+p,P=N-p,N=b[M+5*3]*y[S.SHORT_TYPE][0]+b[M+2*3],p=b[M+3*3]*y[S.SHORT_TYPE][2]+b[M+0*3],V=N+p,Q=-N+p,p=(b[M+1*3]*y[S.SHORT_TYPE][1]-b[M+4*3])*2069978111953089e-26,N=(b[M+4*3]*y[S.SHORT_TYPE][1]+b[M+1*3])*2069978111953089e-26,b[M+3*0]=L*190752519173728e-25+p,b[M+3*5]=-V*190752519173728e-25+N,P=P*.8660254037844387*1907525191737281e-26,V=V*.5*1907525191737281e-26+N,b[M+3*1]=P-V,b[M+3*2]=P+V,L=L*.5*1907525191737281e-26-p,Q=Q*.8660254037844387*1907525191737281e-26,b[M+3*3]=L+Q,b[M+3*4]=L-Q,M++}}function l(b,M,r){var p,L;{var P,N,V,Q,j,B,n,O;P=r[17]-r[9],V=r[15]-r[11],Q=r[14]-r[12],j=r[0]+r[8],B=r[1]+r[7],n=r[2]+r[6],O=r[3]+r[5],b[M+17]=j+n-O-(B-r[4]),L=(j+n-O)*a[12+7]+(B-r[4]),p=(P-V-Q)*a[12+6],b[M+5]=p+L,b[M+6]=p-L,N=(r[16]-r[10])*a[12+6],B=B*a[12+7]+r[4],p=P*a[12+0]+N+V*a[12+1]+Q*a[12+2],L=-j*a[12+4]+B-n*a[12+5]+O*a[12+3],b[M+1]=p+L,b[M+2]=p-L,p=P*a[12+1]-N-V*a[12+2]+Q*a[12+0],L=-j*a[12+5]+B-n*a[12+3]+O*a[12+4],b[M+9]=p+L,b[M+10]=p-L,p=P*a[12+2]-N+V*a[12+0]-Q*a[12+1],L=j*a[12+3]-B+n*a[12+4]-O*a[12+5],b[M+13]=p+L,b[M+14]=p-L}{var q,Z,G,ee,D,F,v,m;q=r[8]-r[0],G=r[6]-r[2],ee=r[5]-r[3],D=r[17]+r[9],F=r[16]+r[10],v=r[15]+r[11],m=r[14]+r[12],b[M+0]=D+v+m+(F+r[13]),p=(D+v+m)*a[12+7]-(F+r[13]),L=(q-G+ee)*a[12+6],b[M+11]=p+L,b[M+12]=p-L,Z=(r[7]-r[1])*a[12+6],F=r[13]-F*a[12+7],p=D*a[12+3]-F+v*a[12+4]+m*a[12+5],L=q*a[12+2]+Z+G*a[12+0]+ee*a[12+1],b[M+3]=p+L,b[M+4]=p-L,p=-D*a[12+5]+F-v*a[12+3]-m*a[12+4],L=q*a[12+1]+Z-G*a[12+2]-ee*a[12+0],b[M+7]=p+L,b[M+8]=p-L,p=-D*a[12+4]+F-v*a[12+5]-m*a[12+3],L=q*a[12+0]-Z+G*a[12+1]-ee*a[12+2],b[M+15]=p+L,b[M+16]=p-L}}this.mdct_sub48=function(b,M,r){for(var p=M,L=286,P=0;P<b.channels_out;P++){for(var N=0;N<b.mode_gr;N++){for(var V,Q=b.l3_side.tt[N][P],j=Q.xr,B=0,n=b.sb_sample[P][1-N],O=0,q=0;q<18/2;q++)for(I(p,L,n[O]),I(p,L+32,n[O+1]),O+=2,L+=64,V=1;V<32;V+=2)n[O-1][V]*=-1;for(V=0;V<32;V++,B+=18){var Z=Q.block_type,G=b.sb_sample[P][N],ee=b.sb_sample[P][1-N];if(Q.mixed_block_flag!=0&&V<2&&(Z=0),b.amp_filter[V]<1e-12)s.fill(j,B+0,B+18,0);else{if(b.amp_filter[V]<1)for(var q=0;q<18;q++)ee[q][k[V]]*=b.amp_filter[V];if(Z==S.SHORT_TYPE){for(var q=-H/4;q<0;q++){var D=y[S.SHORT_TYPE][q+3];j[B+q*3+9]=G[9+q][k[V]]*D-G[8-q][k[V]],j[B+q*3+18]=G[14-q][k[V]]*D+G[15+q][k[V]],j[B+q*3+10]=G[15+q][k[V]]*D-G[14-q][k[V]],j[B+q*3+19]=ee[2-q][k[V]]*D+ee[3+q][k[V]],j[B+q*3+11]=ee[3+q][k[V]]*D-ee[2-q][k[V]],j[B+q*3+20]=ee[8-q][k[V]]*D+ee[9+q][k[V]]}u(j,B)}else{for(var F=h(18),q=-$/4;q<0;q++){var v,m;v=y[Z][q+27]*ee[q+9][k[V]]+y[Z][q+36]*ee[8-q][k[V]],m=y[Z][q+9]*G[q+9][k[V]]-y[Z][q+18]*G[8-q][k[V]],F[q+9]=v-m*e[3+q+9],F[q+18]=v*e[3+q+9]+m}l(j,B,F)}}if(Z!=S.SHORT_TYPE&&V!=0)for(var q=7;q>=0;--q){var i,T;i=j[B+q]*f[20+q]+j[B+-1-q]*A[28+q],T=j[B+q]*A[28+q]-j[B+-1-q]*f[20+q],j[B+-1-q]=i,j[B+q]=T}}}if(p=r,L=286,b.mode_gr==1)for(var K=0;K<18;K++)o.arraycopy(b.sb_sample[P][1][K],0,b.sb_sample[P][0][K],0,32)}}}return ua=c,ua}var fa,qa;function N1(){if(qa)return fa;qa=1;var d=b0(),o=t0,t=o.System;o.VbrMode,o.Float,o.ShortBlock,o.Util,o.Arrays,o.new_array_n,o.new_byte,o.new_double;var s=o.new_float,h=o.new_float_n;o.new_int,o.new_int_n,o.assert;function S(){this.l=s(d.SBMAX_l),this.s=h([d.SBMAX_s,3]);var c=this;this.assign=function(x){t.arraycopy(x.l,0,c.l,0,d.SBMAX_l);for(var H=0;H<d.SBMAX_s;H++)for(var $=0;$<3;$++)c.s[H][$]=x.s[H][$]}}return fa=S,fa}var va,Ya;function rr(){if(Ya)return va;Ya=1;var d=N1();function o(){this.thm=new d,this.en=new d}return va=o,va}function J0(d){var o=d;this.ordinal=function(){return o}}J0.STEREO=new J0(0);J0.JOINT_STEREO=new J0(1);J0.DUAL_CHANNEL=new J0(2);J0.MONO=new J0(3);J0.NOT_SET=new J0(4);var Ct=J0,ca,Ua;function b0(){if(Ua)return ca;Ua=1;var d=t0,o=d.System,t=d.VbrMode;d.Float,d.ShortBlock,d.Util,d.Arrays;var s=d.new_array_n;d.new_byte,d.new_double;var h=d.new_float,S=d.new_float_n,c=d.new_int;d.new_int_n;var x=d.assert;H.ENCDELAY=576,H.POSTDELAY=1152,H.MDCTDELAY=48,H.FFTOFFSET=224+H.MDCTDELAY,H.DECDELAY=528,H.SBLIMIT=32,H.CBANDS=64,H.SBPSY_l=21,H.SBPSY_s=12,H.SBMAX_l=22,H.SBMAX_s=13,H.PSFB21=6,H.PSFB12=6,H.BLKSIZE=1024,H.HBLKSIZE=H.BLKSIZE/2+1,H.BLKSIZE_s=256,H.HBLKSIZE_s=H.BLKSIZE_s/2+1,H.NORM_TYPE=0,H.START_TYPE=1,H.SHORT_TYPE=2,H.STOP_TYPE=3,H.MPG_MD_LR_LR=0,H.MPG_MD_LR_I=1,H.MPG_MD_MS_LR=2,H.MPG_MD_MS_I=3,H.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function H(){var $=ar(),y=rr(),e=Ct,a=H.FFTOFFSET,f=H.MPG_MD_MS_LR,A=null;this.psy=null;var k=null,I=null,u=null;this.setModules=function(p,L,P,N){A=p,this.psy=L,k=L,I=N,u=P};var l=new $;function b(p){var L,P;if(p.ATH.useAdjust==0){p.ATH.adjust=1;return}if(P=p.loudness_sq[0][0],L=p.loudness_sq[1][0],p.channels_out==2?(P+=p.loudness_sq[0][1],L+=p.loudness_sq[1][1]):(P+=P,L+=L),p.mode_gr==2&&(P=Math.max(P,L)),P*=.5,P*=p.ATH.aaSensitivityP,P>.03125)p.ATH.adjust>=1?p.ATH.adjust=1:p.ATH.adjust<p.ATH.adjustLimit&&(p.ATH.adjust=p.ATH.adjustLimit),p.ATH.adjustLimit=1;else{var N=31.98*P+625e-6;p.ATH.adjust>=N?(p.ATH.adjust*=N*.075+.925,p.ATH.adjust<N&&(p.ATH.adjust=N)):p.ATH.adjustLimit>=N?p.ATH.adjust=N:p.ATH.adjust<p.ATH.adjustLimit&&(p.ATH.adjust=p.ATH.adjustLimit),p.ATH.adjustLimit=N}}function M(p){var L,P;for(x(0<=p.bitrate_index&&p.bitrate_index<16),x(0<=p.mode_ext&&p.mode_ext<4),p.bitrate_stereoMode_Hist[p.bitrate_index][4]++,p.bitrate_stereoMode_Hist[15][4]++,p.channels_out==2&&(p.bitrate_stereoMode_Hist[p.bitrate_index][p.mode_ext]++,p.bitrate_stereoMode_Hist[15][p.mode_ext]++),L=0;L<p.mode_gr;++L)for(P=0;P<p.channels_out;++P){var N=p.l3_side.tt[L][P].block_type|0;p.l3_side.tt[L][P].mixed_block_flag!=0&&(N=4),p.bitrate_blockType_Hist[p.bitrate_index][N]++,p.bitrate_blockType_Hist[p.bitrate_index][5]++,p.bitrate_blockType_Hist[15][N]++,p.bitrate_blockType_Hist[15][5]++}}function r(p,L){var P=p.internal_flags,N,V;if(P.lame_encode_frame_init==0){var Q,j,B=h(2014),n=h(286+1152+576);for(P.lame_encode_frame_init=1,Q=0,j=0;Q<286+576*(1+P.mode_gr);++Q)Q<576*P.mode_gr?(B[Q]=0,P.channels_out==2&&(n[Q]=0)):(B[Q]=L[0][j],P.channels_out==2&&(n[Q]=L[1][j]),++j);for(V=0;V<P.mode_gr;V++)for(N=0;N<P.channels_out;N++)P.l3_side.tt[V][N].block_type=H.SHORT_TYPE;l.mdct_sub48(P,B,n),x(576>=H.FFTOFFSET),x(P.mf_size>=H.BLKSIZE+p.framesize-H.FFTOFFSET),x(P.mf_size>=512+p.framesize-32)}}this.lame_encode_mp3_frame=function(p,L,P,N,V,Q){var j,B=s([2,2]);B[0][0]=new y,B[0][1]=new y,B[1][0]=new y,B[1][1]=new y;var n=s([2,2]);n[0][0]=new y,n[0][1]=new y,n[1][0]=new y,n[1][1]=new y;var O,q=[null,null],Z=p.internal_flags,G=S([2,4]),ee=[.5,.5],D=[[0,0],[0,0]],F=[[0,0],[0,0]],v,m,i;if(q[0]=L,q[1]=P,Z.lame_encode_frame_init==0&&r(p,q),Z.padding=0,(Z.slot_lag-=Z.frac_SpF)<0&&(Z.slot_lag+=p.out_samplerate,Z.padding=1),Z.psymodel!=0){var T,K=[null,null],ne=0,g=c(2);for(i=0;i<Z.mode_gr;i++){for(m=0;m<Z.channels_out;m++)K[m]=q[m],ne=576+i*576-H.FFTOFFSET;if(p.VBR==t.vbr_mtrh||p.VBR==t.vbr_mt?T=k.L3psycho_anal_vbr(p,K,ne,i,B,n,D[i],F[i],G[i],g):T=k.L3psycho_anal_ns(p,K,ne,i,B,n,D[i],F[i],G[i],g),T!=0)return-4;for(p.mode==e.JOINT_STEREO&&(ee[i]=G[i][2]+G[i][3],ee[i]>0&&(ee[i]=G[i][3]/ee[i])),m=0;m<Z.channels_out;m++){var Y=Z.l3_side.tt[i][m];Y.block_type=g[m],Y.mixed_block_flag=0}}}else for(i=0;i<Z.mode_gr;i++)for(m=0;m<Z.channels_out;m++)Z.l3_side.tt[i][m].block_type=H.NORM_TYPE,Z.l3_side.tt[i][m].mixed_block_flag=0,F[i][m]=D[i][m]=700;if(b(Z),l.mdct_sub48(Z,q[0],q[1]),Z.mode_ext=H.MPG_MD_LR_LR,p.force_ms)Z.mode_ext=H.MPG_MD_MS_LR;else if(p.mode==e.JOINT_STEREO){var re=0,_e=0;for(i=0;i<Z.mode_gr;i++)for(m=0;m<Z.channels_out;m++)re+=F[i][m],_e+=D[i][m];if(re<=1*_e){var he=Z.l3_side.tt[0],ke=Z.l3_side.tt[Z.mode_gr-1];he[0].block_type==he[1].block_type&&ke[0].block_type==ke[1].block_type&&(Z.mode_ext=H.MPG_MD_MS_LR)}}if(Z.mode_ext==f?(O=n,v=F):(O=B,v=D),p.analysis&&Z.pinfo!=null)for(i=0;i<Z.mode_gr;i++)for(m=0;m<Z.channels_out;m++)Z.pinfo.ms_ratio[i]=Z.ms_ratio[i],Z.pinfo.ms_ener_ratio[i]=ee[i],Z.pinfo.blocktype[i][m]=Z.l3_side.tt[i][m].block_type,Z.pinfo.pe[i][m]=v[i][m],o.arraycopy(Z.l3_side.tt[i][m].xr,0,Z.pinfo.xr[i][m],0,576),Z.mode_ext==f&&(Z.pinfo.ers[i][m]=Z.pinfo.ers[i][m+2],o.arraycopy(Z.pinfo.energy[i][m+2],0,Z.pinfo.energy[i][m],0,Z.pinfo.energy[i][m].length));if(p.VBR==t.vbr_off||p.VBR==t.vbr_abr){var Se,be;for(Se=0;Se<18;Se++)Z.nsPsy.pefirbuf[Se]=Z.nsPsy.pefirbuf[Se+1];for(be=0,i=0;i<Z.mode_gr;i++)for(m=0;m<Z.channels_out;m++)be+=v[i][m];for(Z.nsPsy.pefirbuf[18]=be,be=Z.nsPsy.pefirbuf[9],Se=0;Se<9;Se++)be+=(Z.nsPsy.pefirbuf[Se]+Z.nsPsy.pefirbuf[18-Se])*H.fircoef[Se];for(be=670*5*Z.mode_gr*Z.channels_out/be,i=0;i<Z.mode_gr;i++)for(m=0;m<Z.channels_out;m++)v[i][m]*=be}if(Z.iteration_loop.iteration_loop(p,v,ee,O),A.format_bitstream(p),j=A.copy_buffer(Z,N,V,Q,1),p.bWriteVbrTag&&I.addVbrFrame(p),p.analysis&&Z.pinfo!=null){for(m=0;m<Z.channels_out;m++){var Le;for(Le=0;Le<a;Le++)Z.pinfo.pcmdata[m][Le]=Z.pinfo.pcmdata[m][Le+p.framesize];for(Le=a;Le<1600;Le++)Z.pinfo.pcmdata[m][Le]=q[m][Le-a]}u.set_frame_pinfo(p,O)}return M(Z),j}}return ca=H,ca}var T0=t0;T0.System;T0.VbrMode;T0.Float;T0.ShortBlock;var $a=T0.Util;T0.Arrays;T0.new_array_n;T0.new_byte;T0.new_double;var Za=T0.new_float;T0.new_float_n;T0.new_int;T0.new_int_n;T0.assert;var n0=b0();function nr(){var d=Za(n0.BLKSIZE),o=Za(n0.BLKSIZE_s/2),t=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function s(S,c,x){var H=0,$,y,e;x<<=1;var a=c+x;$=4;do{var f,A,k,I,u,l,b;b=$>>1,I=$,u=$<<1,l=u+I,$=u<<1,y=c,e=y+b;do{var M,r,p,L;r=S[y+0]-S[y+I],M=S[y+0]+S[y+I],L=S[y+u]-S[y+l],p=S[y+u]+S[y+l],S[y+u]=M-p,S[y+0]=M+p,S[y+l]=r-L,S[y+I]=r+L,r=S[e+0]-S[e+I],M=S[e+0]+S[e+I],L=$a.SQRT2*S[e+l],p=$a.SQRT2*S[e+u],S[e+u]=M-p,S[e+0]=M+p,S[e+l]=r-L,S[e+I]=r+L,e+=$,y+=$}while(y<a);for(A=t[H+0],f=t[H+1],k=1;k<b;k++){var P,N;P=1-2*f*f,N=2*f*A,y=c+k,e=c+I-k;do{var V,Q,j,M,r,B,p,n,L,O;Q=N*S[y+I]-P*S[e+I],V=P*S[y+I]+N*S[e+I],r=S[y+0]-V,M=S[y+0]+V,B=S[e+0]-Q,j=S[e+0]+Q,Q=N*S[y+l]-P*S[e+l],V=P*S[y+l]+N*S[e+l],L=S[y+u]-V,p=S[y+u]+V,O=S[e+u]-Q,n=S[e+u]+Q,Q=f*p-A*O,V=A*p+f*O,S[y+u]=M-V,S[y+0]=M+V,S[e+l]=B-Q,S[e+I]=B+Q,Q=A*n-f*L,V=f*n+A*L,S[e+u]=j-V,S[e+0]=j+V,S[y+l]=r-Q,S[y+I]=r+Q,e+=$,y+=$}while(y<a);P=A,A=P*t[H+0]-f*t[H+1],f=P*t[H+1]+f*t[H+0]}H+=2}while($<x)}var h=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(S,c,x,H,$){for(var y=0;y<3;y++){var e=n0.BLKSIZE_s/2,a=65535&576/3*(y+1),f=n0.BLKSIZE_s/8-1;do{var A,k,I,u,l,b=h[f<<2]&255;A=o[b]*H[x][$+b+a],l=o[127-b]*H[x][$+b+a+128],k=A-l,A=A+l,I=o[b+64]*H[x][$+b+a+64],l=o[63-b]*H[x][$+b+a+192],u=I-l,I=I+l,e-=4,c[y][e+0]=A+I,c[y][e+2]=A-I,c[y][e+1]=k+u,c[y][e+3]=k-u,A=o[b+1]*H[x][$+b+a+1],l=o[126-b]*H[x][$+b+a+129],k=A-l,A=A+l,I=o[b+65]*H[x][$+b+a+65],l=o[62-b]*H[x][$+b+a+193],u=I-l,I=I+l,c[y][e+n0.BLKSIZE_s/2+0]=A+I,c[y][e+n0.BLKSIZE_s/2+2]=A-I,c[y][e+n0.BLKSIZE_s/2+1]=k+u,c[y][e+n0.BLKSIZE_s/2+3]=k-u}while(--f>=0);s(c[y],e,n0.BLKSIZE_s/2)}},this.fft_long=function(S,c,x,H,$){var y=n0.BLKSIZE/8-1,e=n0.BLKSIZE/2;do{var a,f,A,k,I,u=h[y]&255;a=d[u]*H[x][$+u],I=d[u+512]*H[x][$+u+512],f=a-I,a=a+I,A=d[u+256]*H[x][$+u+256],I=d[u+768]*H[x][$+u+768],k=A-I,A=A+I,e-=4,c[e+0]=a+A,c[e+2]=a-A,c[e+1]=f+k,c[e+3]=f-k,a=d[u+1]*H[x][$+u+1],I=d[u+513]*H[x][$+u+513],f=a-I,a=a+I,A=d[u+257]*H[x][$+u+257],I=d[u+769]*H[x][$+u+769],k=A-I,A=A+I,c[e+n0.BLKSIZE/2+0]=a+A,c[e+n0.BLKSIZE/2+2]=a-A,c[e+n0.BLKSIZE/2+1]=f+k,c[e+n0.BLKSIZE/2+3]=f-k}while(--y>=0);s(c,e,n0.BLKSIZE/2)},this.init_fft=function(S){for(var c=0;c<n0.BLKSIZE;c++)d[c]=.42-.5*Math.cos(2*Math.PI*(c+.5)/n0.BLKSIZE)+.08*Math.cos(4*Math.PI*(c+.5)/n0.BLKSIZE);for(var c=0;c<n0.BLKSIZE_s/2;c++)o[c]=.5*(1-Math.cos(2*Math.PI*(c+.5)/n0.BLKSIZE_s))}}var ir=nr,M0=t0;M0.System;var mt=M0.VbrMode,Ka=M0.Float,bt=M0.ShortBlock,y0=M0.Util,sr=M0.Arrays;M0.new_array_n;M0.new_byte;M0.new_double;var _0=M0.new_float,Y0=M0.new_float_n,_t=M0.new_int;M0.new_int_n;var Te=M0.assert,lr=ir,oe=b0();function or(){var d=Ct,o=new lr,t=2.302585092994046,s=2,h=16,S=2,c=16,x=.34,H=1/(14752*14752)/(oe.BLKSIZE/2),$=.01,y=.8,e=.6,a=.3,f=3.5,A=21,k=.2302585093;function I(R){return R}function u(R,E){for(var X=0,U=0;U<oe.BLKSIZE/2;++U)X+=R[U]*E.ATH.eql_w[U];return X*=H,X}function l(R,E,X,U,J,C,W,te,z,se,ae){var le=R.internal_flags;if(z<2)o.fft_long(le,U[J],z,se,ae),o.fft_short(le,C[W],z,se,ae);else if(z==2){for(var me=oe.BLKSIZE-1;me>=0;--me){var Ve=U[J+0][me],fe=U[J+1][me];U[J+0][me]=(Ve+fe)*y0.SQRT2*.5,U[J+1][me]=(Ve-fe)*y0.SQRT2*.5}for(var Oe=2;Oe>=0;--Oe)for(var me=oe.BLKSIZE_s-1;me>=0;--me){var Ve=C[W+0][Oe][me],fe=C[W+1][Oe][me];C[W+0][Oe][me]=(Ve+fe)*y0.SQRT2*.5,C[W+1][Oe][me]=(Ve-fe)*y0.SQRT2*.5}}E[0]=U[J+0][0],E[0]*=E[0];for(var me=oe.BLKSIZE/2-1;me>=0;--me){var ie=U[J+0][oe.BLKSIZE/2-me],Me=U[J+0][oe.BLKSIZE/2+me];E[oe.BLKSIZE/2-me]=(ie*ie+Me*Me)*.5}for(var Oe=2;Oe>=0;--Oe){X[Oe][0]=C[W+0][Oe][0],X[Oe][0]*=X[Oe][0];for(var me=oe.BLKSIZE_s/2-1;me>=0;--me){var ie=C[W+0][Oe][oe.BLKSIZE_s/2-me],Me=C[W+0][Oe][oe.BLKSIZE_s/2+me];X[Oe][oe.BLKSIZE_s/2-me]=(ie*ie+Me*Me)*.5}}{for(var Ge=0,me=11;me<oe.HBLKSIZE;me++)Ge+=E[me];le.tot_ener[z]=Ge}if(R.analysis){for(var me=0;me<oe.HBLKSIZE;me++)le.pinfo.energy[te][z][me]=le.pinfo.energy_save[z][me],le.pinfo.energy_save[z][me]=E[me];le.pinfo.pe[te][z]=le.pe[z]}R.athaa_loudapprox==2&&z<2&&(le.loudness_sq[te][z]=le.loudness_sq_save[z],le.loudness_sq_save[z]=u(E,le))}var b=8,M=23,r=15,p,L,P,N=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function V(){p=Math.pow(10,(b+1)/16),L=Math.pow(10,(M+1)/16),P=Math.pow(10,r/10)}var Q=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],j=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],B=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function n(R,E,X,U,J,C){var W;if(E>R)if(E<R*L)W=E/R;else return R+E;else{if(R>=E*L)return R+E;W=R/E}if(Te(R>=0),Te(E>=0),R+=E,U+3<=3+3){if(W>=p)return R;var te=0|y0.FAST_LOG10_X(W,16);return R*j[te]}var te=0|y0.FAST_LOG10_X(W,16);if(C!=0?E=J.ATH.cb_s[X]*J.ATH.adjust:E=J.ATH.cb_l[X]*J.ATH.adjust,Te(E>=0),R<P*E){if(R>E){var z,se;return z=1,te<=13&&(z=B[te]),se=y0.FAST_LOG10_X(R/E,10/15),R*((Q[te]-z)*se+z)}return te>13?R:R*B[te]}return R*Q[te]}var O=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function q(R,E,X){var U;if(R<0&&(R=0),E<0&&(E=0),R<=0)return E;if(E<=0)return R;if(E>R?U=E/R:U=R/E,-2<=X&&X<=2){if(U>=p)return R+E;var J=0|y0.FAST_LOG10_X(U,16);return(R+E)*O[J]}return U<L?R+E:(R<E&&(R=E),R)}function Z(R,E){var X=R.internal_flags;if(X.channels_out>1){for(var U=0;U<oe.SBMAX_l;U++){var J=X.thm[0].l[U],C=X.thm[1].l[U];X.thm[0].l[U]+=C*E,X.thm[1].l[U]+=J*E}for(var U=0;U<oe.SBMAX_s;U++)for(var W=0;W<3;W++){var J=X.thm[0].s[U][W],C=X.thm[1].s[U][W];X.thm[0].s[U][W]+=C*E,X.thm[1].s[U][W]+=J*E}}}function G(R){for(var E=0;E<oe.SBMAX_l;E++)if(!(R.thm[0].l[E]>1.58*R.thm[1].l[E]||R.thm[1].l[E]>1.58*R.thm[0].l[E])){var X=R.mld_l[E]*R.en[3].l[E],U=Math.max(R.thm[2].l[E],Math.min(R.thm[3].l[E],X));X=R.mld_l[E]*R.en[2].l[E];var J=Math.max(R.thm[3].l[E],Math.min(R.thm[2].l[E],X));R.thm[2].l[E]=U,R.thm[3].l[E]=J}for(var E=0;E<oe.SBMAX_s;E++)for(var C=0;C<3;C++)if(!(R.thm[0].s[E][C]>1.58*R.thm[1].s[E][C]||R.thm[1].s[E][C]>1.58*R.thm[0].s[E][C])){var X=R.mld_s[E]*R.en[3].s[E][C],U=Math.max(R.thm[2].s[E][C],Math.min(R.thm[3].s[E][C],X));X=R.mld_s[E]*R.en[2].s[E][C];var J=Math.max(R.thm[3].s[E][C],Math.min(R.thm[2].s[E][C],X));R.thm[2].s[E][C]=U,R.thm[3].s[E][C]=J}}function ee(R,E,X){var U=E,J=Math.pow(10,X);E*=2,U*=2;for(var C=0;C<oe.SBMAX_l;C++){var W,te,z,se;if(se=R.ATH.cb_l[R.bm_l[C]]*J,W=Math.min(Math.max(R.thm[0].l[C],se),Math.max(R.thm[1].l[C],se)),te=Math.max(R.thm[2].l[C],se),z=Math.max(R.thm[3].l[C],se),W*E<te+z){var ae=W*U/(te+z);te*=ae,z*=ae,Te(te+z>0)}R.thm[2].l[C]=Math.min(te,R.thm[2].l[C]),R.thm[3].l[C]=Math.min(z,R.thm[3].l[C])}J*=oe.BLKSIZE_s/oe.BLKSIZE;for(var C=0;C<oe.SBMAX_s;C++)for(var le=0;le<3;le++){var W,te,z,se;if(se=R.ATH.cb_s[R.bm_s[C]]*J,W=Math.min(Math.max(R.thm[0].s[C][le],se),Math.max(R.thm[1].s[C][le],se)),te=Math.max(R.thm[2].s[C][le],se),z=Math.max(R.thm[3].s[C][le],se),W*E<te+z){var ae=W*E/(te+z);te*=ae,z*=ae,Te(te+z>0)}R.thm[2].s[C][le]=Math.min(R.thm[2].s[C][le],te),R.thm[3].s[C][le]=Math.min(R.thm[3].s[C][le],z)}}function D(R,E,X,U,J){var C,W,te=0,z=0;for(C=W=0;C<oe.SBMAX_s;++W,++C){for(var se=R.bo_s[C],ae=R.npart_s,le=se<ae?se:ae;W<le;)Te(E[W]>=0),Te(X[W]>=0),te+=E[W],z+=X[W],W++;if(R.en[U].s[C][J]=te,R.thm[U].s[C][J]=z,W>=ae){++C;break}Te(E[W]>=0),Te(X[W]>=0);{var me=R.PSY.bo_s_weight[C],Ve=1-me;te=me*E[W],z=me*X[W],R.en[U].s[C][J]+=te,R.thm[U].s[C][J]+=z,te=Ve*E[W],z=Ve*X[W]}}for(;C<oe.SBMAX_s;++C)R.en[U].s[C][J]=0,R.thm[U].s[C][J]=0}function F(R,E,X,U){var J,C,W=0,te=0;for(J=C=0;J<oe.SBMAX_l;++C,++J){for(var z=R.bo_l[J],se=R.npart_l,ae=z<se?z:se;C<ae;)Te(E[C]>=0),Te(X[C]>=0),W+=E[C],te+=X[C],C++;if(R.en[U].l[J]=W,R.thm[U].l[J]=te,C>=se){++J;break}Te(E[C]>=0),Te(X[C]>=0);{var le=R.PSY.bo_l_weight[J],me=1-le;W=le*E[C],te=le*X[C],R.en[U].l[J]+=W,R.thm[U].l[J]+=te,W=me*E[C],te=me*X[C]}}for(;J<oe.SBMAX_l;++J)R.en[U].l[J]=0,R.thm[U].l[J]=0}function v(R,E,X,U,J,C){var W=R.internal_flags,te,z;for(z=te=0;z<W.npart_s;++z){for(var se=0,ae=W.numlines_s[z],le=0;le<ae;++le,++te){var me=E[C][te];se+=me}X[z]=se}for(Te(z==W.npart_s),Te(te==129),te=z=0;z<W.npart_s;z++){var Ve=W.s3ind_s[z][0],fe=W.s3_ss[te++]*X[Ve];for(++Ve;Ve<=W.s3ind_s[z][1];)fe+=W.s3_ss[te]*X[Ve],++te,++Ve;{var Oe=S*W.nb_s1[J][z];U[z]=Math.min(fe,Oe)}if(W.blocktype_old[J&1]==oe.SHORT_TYPE){var Oe=c*W.nb_s2[J][z],ie=U[z];U[z]=Math.min(Oe,ie)}W.nb_s2[J][z]=W.nb_s1[J][z],W.nb_s1[J][z]=fe,Te(U[z]>=0)}for(;z<=oe.CBANDS;++z)X[z]=0,U[z]=0}function m(R,E,X,U){var J=R.internal_flags;R.short_blocks==bt.short_block_coupled&&!(E[0]!=0&&E[1]!=0)&&(E[0]=E[1]=0);for(var C=0;C<J.channels_out;C++)U[C]=oe.NORM_TYPE,R.short_blocks==bt.short_block_dispensed&&(E[C]=1),R.short_blocks==bt.short_block_forced&&(E[C]=0),E[C]!=0?(Te(J.blocktype_old[C]!=oe.START_TYPE),J.blocktype_old[C]==oe.SHORT_TYPE&&(U[C]=oe.STOP_TYPE)):(U[C]=oe.SHORT_TYPE,J.blocktype_old[C]==oe.NORM_TYPE&&(J.blocktype_old[C]=oe.START_TYPE),J.blocktype_old[C]==oe.STOP_TYPE&&(J.blocktype_old[C]=oe.SHORT_TYPE)),X[C]=J.blocktype_old[C],J.blocktype_old[C]=U[C]}function i(R,E,X){return X>=1?R:X<=0?E:E>0?Math.pow(R/E,X)*E:0}var T=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function K(R,E){for(var X=309.07,U=0;U<oe.SBMAX_s-1;U++)for(var J=0;J<3;J++){var C=R.thm.s[U][J];if(Te(U<T.length),C>0){var W=C*E,te=R.en.s[U][J];te>W&&(te>W*1e10?X+=T[U]*(10*t):(Te(W>0),X+=T[U]*y0.FAST_LOG10(te/W)))}}return X}var ne=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function g(R,E){for(var X=281.0575,U=0;U<oe.SBMAX_l-1;U++){var J=R.thm.l[U];if(Te(U<ne.length),J>0){var C=J*E,W=R.en.l[U];W>C&&(W>C*1e10?X+=ne[U]*(10*t):(Te(C>0),X+=ne[U]*y0.FAST_LOG10(W/C)))}}return X}function Y(R,E,X,U,J){var C,W;for(C=W=0;C<R.npart_l;++C){var te=0,z=0,se;for(se=0;se<R.numlines_l[C];++se,++W){var ae=E[W];Te(ae>=0),te+=ae,z<ae&&(z=ae)}X[C]=te,U[C]=z,J[C]=te*R.rnumlines_l[C],Te(R.rnumlines_l[C]>=0),Te(te>=0),Te(X[C]>=0),Te(U[C]>=0),Te(J[C]>=0)}}function re(R,E,X,U){var J=N.length-1,C=0,W=X[C]+X[C+1];if(Te(W>=0),W>0){var te=E[C];te<E[C+1]&&(te=E[C+1]),Te(R.numlines_l[C]+R.numlines_l[C+1]-1>0),W=20*(te*2-W)/(W*(R.numlines_l[C]+R.numlines_l[C+1]-1));var z=0|W;z>J&&(z=J),U[C]=z}else U[C]=0;for(C=1;C<R.npart_l-1;C++)if(W=X[C-1]+X[C]+X[C+1],Te(W>=0),W>0){var te=E[C-1];te<E[C]&&(te=E[C]),te<E[C+1]&&(te=E[C+1]),Te(R.numlines_l[C-1]+R.numlines_l[C]+R.numlines_l[C+1]-1>0),W=20*(te*3-W)/(W*(R.numlines_l[C-1]+R.numlines_l[C]+R.numlines_l[C+1]-1));var z=0|W;z>J&&(z=J),U[C]=z}else U[C]=0;if(Te(C>0),Te(C==R.npart_l-1),W=X[C-1]+X[C],Te(W>=0),W>0){var te=E[C-1];te<E[C]&&(te=E[C]),Te(R.numlines_l[C-1]+R.numlines_l[C]-1>0),W=20*(te*2-W)/(W*(R.numlines_l[C-1]+R.numlines_l[C]-1));var z=0|W;z>J&&(z=J),U[C]=z}else U[C]=0;Te(C==R.npart_l-1)}var _e=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(R,E,X,U,J,C,W,te,z,se){var ae=R.internal_flags,le=Y0([2,oe.BLKSIZE]),me=Y0([2,3,oe.BLKSIZE_s]),Ve=_0(oe.CBANDS+1),fe=_0(oe.CBANDS+1),Oe=_0(oe.CBANDS+2),ie=_t(2),Me=_t(2),Ge,ve,Ee,ue,Ne,je,ye,De,Ue=Y0([2,576]),ge,D0=_t(oe.CBANDS+2),r0=_t(oe.CBANDS+2);for(sr.fill(r0,0),Ge=ae.channels_out,R.mode==d.JOINT_STEREO&&(Ge=4),R.VBR==mt.vbr_off?ge=ae.ResvMax==0?0:ae.ResvSize/ae.ResvMax*.5:R.VBR==mt.vbr_rh||R.VBR==mt.vbr_mtrh||R.VBR==mt.vbr_mt?ge=.6:ge=1,ve=0;ve<ae.channels_out;ve++){var ze=E[ve],p0=X+576-350-A+192;for(Te(_e.length==(A-1)/2),ue=0;ue<576;ue++){var P0,G0;for(P0=ze[p0+ue+10],G0=0,Ne=0;Ne<(A-1)/2-1;Ne+=2)P0+=_e[Ne]*(ze[p0+ue+Ne]+ze[p0+ue+A-Ne]),G0+=_e[Ne+1]*(ze[p0+ue+Ne+1]+ze[p0+ue+A-Ne-1]);Ue[ve][ue]=P0+G0}J[U][ve].en.assign(ae.en[ve]),J[U][ve].thm.assign(ae.thm[ve]),Ge>2&&(C[U][ve].en.assign(ae.en[ve+2]),C[U][ve].thm.assign(ae.thm[ve+2]))}for(ve=0;ve<Ge;ve++){var K0,Q0,m0=_0(12),g0=[0,0,0,0],ht=_0(12),aa=1,Ha,Va=_0(oe.CBANDS),Na=_0(oe.CBANDS),e0=[0,0,0,0],Fa=_0(oe.HBLKSIZE),Xa=Y0([3,oe.HBLKSIZE_s]);for(Te(ae.npart_s<=oe.CBANDS),Te(ae.npart_l<=oe.CBANDS),ue=0;ue<3;ue++)m0[ue]=ae.nsPsy.last_en_subshort[ve][ue+6],Te(ae.nsPsy.last_en_subshort[ve][ue+4]>0),ht[ue]=m0[ue]/ae.nsPsy.last_en_subshort[ve][ue+4],g0[0]+=m0[ue];if(ve==2)for(ue=0;ue<576;ue++){var ra,na;ra=Ue[0][ue],na=Ue[1][ue],Ue[0][ue]=ra+na,Ue[1][ue]=ra-na}{var Da=Ue[ve&1],St=0;for(ue=0;ue<9;ue++){for(var Z1=St+64,v0=1;St<Z1;St++)v0<Math.abs(Da[St])&&(v0=Math.abs(Da[St]));ae.nsPsy.last_en_subshort[ve][ue]=m0[ue+3]=v0,g0[1+ue/3]+=v0,v0>m0[ue+3-2]?(Te(m0[ue+3-2]>0),v0=v0/m0[ue+3-2]):m0[ue+3-2]>v0*10?(Te(v0>0),v0=m0[ue+3-2]/(v0*10)):v0=0,ht[ue+3]=v0}}if(R.analysis){var ia=ht[0];for(ue=1;ue<12;ue++)ia<ht[ue]&&(ia=ht[ue]);ae.pinfo.ers[U][ve]=ae.pinfo.ers_save[ve],ae.pinfo.ers_save[ve]=ia}for(Ha=ve==3?ae.nsPsy.attackthre_s:ae.nsPsy.attackthre,ue=0;ue<12;ue++)e0[ue/3]==0&&ht[ue]>Ha&&(e0[ue/3]=ue%3+1);for(ue=1;ue<4;ue++){var sa;g0[ue-1]>g0[ue]?(Te(g0[ue]>0),sa=g0[ue-1]/g0[ue]):(Te(g0[ue-1]>0),sa=g0[ue]/g0[ue-1]),sa<1.7&&(e0[ue]=0,ue==1&&(e0[0]=0))}for(e0[0]!=0&&ae.nsPsy.lastAttacks[ve]!=0&&(e0[0]=0),(ae.nsPsy.lastAttacks[ve]==3||e0[0]+e0[1]+e0[2]+e0[3]!=0)&&(aa=0,e0[1]!=0&&e0[0]!=0&&(e0[1]=0),e0[2]!=0&&e0[1]!=0&&(e0[2]=0),e0[3]!=0&&e0[2]!=0&&(e0[3]=0)),ve<2?Me[ve]=aa:aa==0&&(Me[0]=Me[1]=0),z[ve]=ae.tot_ener[ve],Q0=me,K0=le,l(R,Fa,Xa,K0,ve&1,Q0,ve&1,U,ve,E,X),Y(ae,Fa,Ve,Va,Na),re(ae,Va,Na,D0),De=0;De<3;De++){var la,A0;for(v(R,Xa,fe,Oe,ve,De),D(ae,fe,Oe,ve,De),ye=0;ye<oe.SBMAX_s;ye++){if(A0=ae.thm[ve].s[ye][De],A0*=y,e0[De]>=2||e0[De+1]==1){var wt=De!=0?De-1:2,v0=i(ae.thm[ve].s[ye][wt],A0,e*ge);A0=Math.min(A0,v0)}if(e0[De]==1){var wt=De!=0?De-1:2,v0=i(ae.thm[ve].s[ye][wt],A0,a*ge);A0=Math.min(A0,v0)}else if(De!=0&&e0[De-1]==3||De==0&&ae.nsPsy.lastAttacks[ve]==3){var wt=De!=2?De+1:0,v0=i(ae.thm[ve].s[ye][wt],A0,a*ge);A0=Math.min(A0,v0)}la=m0[De*3+3]+m0[De*3+4]+m0[De*3+5],m0[De*3+5]*6<la&&(A0*=.5,m0[De*3+4]*6<la&&(A0*=.5)),ae.thm[ve].s[ye][De]=A0}}for(ae.nsPsy.lastAttacks[ve]=e0[2],je=0,Ee=0;Ee<ae.npart_l;Ee++){for(var lt=ae.s3ind[Ee][0],oa=Ve[lt]*N[D0[lt]],ot=ae.s3_ll[je++]*oa;++lt<=ae.s3ind[Ee][1];)oa=Ve[lt]*N[D0[lt]],ot=n(ot,ae.s3_ll[je++]*oa,lt,lt-Ee,ae,0);ot*=.158489319246111,ae.blocktype_old[ve&1]==oe.SHORT_TYPE?Oe[Ee]=ot:Oe[Ee]=i(Math.min(ot,Math.min(s*ae.nb_1[ve][Ee],h*ae.nb_2[ve][Ee])),ot,ge),ae.nb_2[ve][Ee]=ae.nb_1[ve][Ee],ae.nb_1[ve][Ee]=ot}for(;Ee<=oe.CBANDS;++Ee)Ve[Ee]=0,Oe[Ee]=0;F(ae,Ve,Oe,ve)}if((R.mode==d.STEREO||R.mode==d.JOINT_STEREO)&&R.interChRatio>0&&Z(R,R.interChRatio),R.mode==d.JOINT_STEREO){var _a;G(ae),_a=R.msfix,Math.abs(_a)>0&&ee(ae,_a,R.ATHlower*ae.ATH.adjust)}for(m(R,Me,se,ie),ve=0;ve<Ge;ve++){var xt,Tt=0,Ot,Ht;ve>1?(xt=te,Tt=-2,Ot=oe.NORM_TYPE,(se[0]==oe.SHORT_TYPE||se[1]==oe.SHORT_TYPE)&&(Ot=oe.SHORT_TYPE),Ht=C[U][ve-2]):(xt=W,Tt=0,Ot=se[ve],Ht=J[U][ve]),Ot==oe.SHORT_TYPE?xt[Tt+ve]=K(Ht,ae.masking_lower):xt[Tt+ve]=g(Ht,ae.masking_lower),R.analysis&&(ae.pinfo.pe[U][ve]=xt[Tt+ve])}return 0};function he(R,E,X,U,J,C,W,te){var z=R.internal_flags;if(U<2)o.fft_long(z,W[te],U,E,X);else if(U==2)for(var se=oe.BLKSIZE-1;se>=0;--se){var ae=W[te+0][se],le=W[te+1][se];W[te+0][se]=(ae+le)*y0.SQRT2*.5,W[te+1][se]=(ae-le)*y0.SQRT2*.5}C[0]=W[te+0][0],C[0]*=C[0];for(var se=oe.BLKSIZE/2-1;se>=0;--se){var me=W[te+0][oe.BLKSIZE/2-se],Ve=W[te+0][oe.BLKSIZE/2+se];C[oe.BLKSIZE/2-se]=(me*me+Ve*Ve)*.5}{for(var fe=0,se=11;se<oe.HBLKSIZE;se++)fe+=C[se];z.tot_ener[U]=fe}if(R.analysis){for(var se=0;se<oe.HBLKSIZE;se++)z.pinfo.energy[J][U][se]=z.pinfo.energy_save[U][se],z.pinfo.energy_save[U][se]=C[se];z.pinfo.pe[J][U]=z.pe[U]}}function ke(R,E,X,U,J,C,W,te){var z=R.internal_flags;if(J==0&&U<2&&o.fft_short(z,W[te],U,E,X),U==2)for(var se=oe.BLKSIZE_s-1;se>=0;--se){var ae=W[te+0][J][se],le=W[te+1][J][se];W[te+0][J][se]=(ae+le)*y0.SQRT2*.5,W[te+1][J][se]=(ae-le)*y0.SQRT2*.5}C[J][0]=W[te+0][J][0],C[J][0]*=C[J][0];for(var se=oe.BLKSIZE_s/2-1;se>=0;--se){var me=W[te+0][J][oe.BLKSIZE_s/2-se],Ve=W[te+0][J][oe.BLKSIZE_s/2+se];C[J][oe.BLKSIZE_s/2-se]=(me*me+Ve*Ve)*.5}}function Se(R,E,X,U){var J=R.internal_flags;R.athaa_loudapprox==2&&X<2&&(J.loudness_sq[E][X]=J.loudness_sq_save[X],J.loudness_sq_save[X]=u(U,J))}var be=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function Le(R,E,X,U,J,C,W,te,z,se){for(var ae=Y0([2,576]),le=R.internal_flags,me=le.channels_out,Ve=R.mode==d.JOINT_STEREO?4:me,fe=0;fe<me;fe++){firbuf=E[fe];var Oe=X+576-350-A+192;Te(be.length==(A-1)/2);for(var ie=0;ie<576;ie++){var Me,Ge;Me=firbuf[Oe+ie+10],Ge=0;for(var ve=0;ve<(A-1)/2-1;ve+=2)Me+=be[ve]*(firbuf[Oe+ie+ve]+firbuf[Oe+ie+A-ve]),Ge+=be[ve+1]*(firbuf[Oe+ie+ve+1]+firbuf[Oe+ie+A-ve-1]);ae[fe][ie]=Me+Ge}J[U][fe].en.assign(le.en[fe]),J[U][fe].thm.assign(le.thm[fe]),Ve>2&&(C[U][fe].en.assign(le.en[fe+2]),C[U][fe].thm.assign(le.thm[fe+2]))}for(var fe=0;fe<Ve;fe++){var Ee=_0(12),ue=_0(12),Ne=[0,0,0,0],je=ae[fe&1],ye=0,De=fe==3?le.nsPsy.attackthre_s:le.nsPsy.attackthre,Ue=1;if(fe==2)for(var ie=0,ve=576;ve>0;++ie,--ve){var ge=ae[0][ie],D0=ae[1][ie];ae[0][ie]=ge+D0,ae[1][ie]=ge-D0}for(var ie=0;ie<3;ie++)ue[ie]=le.nsPsy.last_en_subshort[fe][ie+6],Te(le.nsPsy.last_en_subshort[fe][ie+4]>0),Ee[ie]=ue[ie]/le.nsPsy.last_en_subshort[fe][ie+4],Ne[0]+=ue[ie];for(var ie=0;ie<9;ie++){for(var r0=ye+64,ze=1;ye<r0;ye++)ze<Math.abs(je[ye])&&(ze=Math.abs(je[ye]));le.nsPsy.last_en_subshort[fe][ie]=ue[ie+3]=ze,Ne[1+ie/3]+=ze,ze>ue[ie+3-2]?(Te(ue[ie+3-2]>0),ze=ze/ue[ie+3-2]):ue[ie+3-2]>ze*10?(Te(ze>0),ze=ue[ie+3-2]/(ze*10)):ze=0,Ee[ie+3]=ze}for(var ie=0;ie<3;++ie){var p0=ue[ie*3+3]+ue[ie*3+4]+ue[ie*3+5],P0=1;ue[ie*3+5]*6<p0&&(P0*=.5,ue[ie*3+4]*6<p0&&(P0*=.5)),te[fe][ie]=P0}if(R.analysis){for(var G0=Ee[0],ie=1;ie<12;ie++)G0<Ee[ie]&&(G0=Ee[ie]);le.pinfo.ers[U][fe]=le.pinfo.ers_save[fe],le.pinfo.ers_save[fe]=G0}for(var ie=0;ie<12;ie++)z[fe][ie/3]==0&&Ee[ie]>De&&(z[fe][ie/3]=ie%3+1);for(var ie=1;ie<4;ie++){var K0=Ne[ie-1],Q0=Ne[ie],m0=Math.max(K0,Q0);m0<4e4&&K0<1.7*Q0&&Q0<1.7*K0&&(ie==1&&z[fe][0]<=z[fe][ie]&&(z[fe][0]=0),z[fe][ie]=0)}z[fe][0]<=le.nsPsy.lastAttacks[fe]&&(z[fe][0]=0),(le.nsPsy.lastAttacks[fe]==3||z[fe][0]+z[fe][1]+z[fe][2]+z[fe][3]!=0)&&(Ue=0,z[fe][1]!=0&&z[fe][0]!=0&&(z[fe][1]=0),z[fe][2]!=0&&z[fe][1]!=0&&(z[fe][2]=0),z[fe][3]!=0&&z[fe][2]!=0&&(z[fe][3]=0)),fe<2?se[fe]=Ue:Ue==0&&(se[0]=se[1]=0),W[fe]=le.tot_ener[fe]}}function $e(R,E,X){if(X==0)for(var U=0;U<R.npart_s;U++)R.nb_s2[E][U]=R.nb_s1[E][U],R.nb_s1[E][U]=0}function c0(R,E){for(var X=0;X<R.npart_l;X++)R.nb_2[E][X]=R.nb_1[E][X],R.nb_1[E][X]=0}function _(R,E,X,U){var J=N.length-1,C=0,W=X[C]+X[C+1];if(Te(W>=0),W>0){var te=E[C];te<E[C+1]&&(te=E[C+1]),Te(R.numlines_s[C]+R.numlines_s[C+1]-1>0),W=20*(te*2-W)/(W*(R.numlines_s[C]+R.numlines_s[C+1]-1));var z=0|W;z>J&&(z=J),U[C]=z}else U[C]=0;for(C=1;C<R.npart_s-1;C++)if(W=X[C-1]+X[C]+X[C+1],Te(C+1<R.npart_s),Te(W>=0),W>0){var te=E[C-1];te<E[C]&&(te=E[C]),te<E[C+1]&&(te=E[C+1]),Te(R.numlines_s[C-1]+R.numlines_s[C]+R.numlines_s[C+1]-1>0),W=20*(te*3-W)/(W*(R.numlines_s[C-1]+R.numlines_s[C]+R.numlines_s[C+1]-1));var z=0|W;z>J&&(z=J),U[C]=z}else U[C]=0;if(Te(C>0),Te(C==R.npart_s-1),W=X[C-1]+X[C],Te(W>=0),W>0){var te=E[C-1];te<E[C]&&(te=E[C]),Te(R.numlines_s[C-1]+R.numlines_s[C]-1>0),W=20*(te*2-W)/(W*(R.numlines_s[C-1]+R.numlines_s[C]-1));var z=0|W;z>J&&(z=J),U[C]=z}else U[C]=0;Te(C==R.npart_s-1)}function w(R,E,X,U,J,C){var W=R.internal_flags,te=new float[oe.CBANDS],z=_0(oe.CBANDS),se,ae,le,me=new int[oe.CBANDS];for(le=ae=0;le<W.npart_s;++le){var Ve=0,fe=0,Oe=W.numlines_s[le];for(se=0;se<Oe;++se,++ae){var ie=E[C][ae];Ve+=ie,fe<ie&&(fe=ie)}X[le]=Ve,Te(Ve>=0),te[le]=fe,Te(Oe>0),z[le]=Ve/Oe,Te(z[le]>=0)}for(Te(le==W.npart_s),Te(ae==129);le<oe.CBANDS;++le)te[le]=0,z[le]=0;for(_(W,te,z,me),ae=le=0;le<W.npart_s;le++){var Me=W.s3ind_s[le][0],Ge=W.s3ind_s[le][1],ve,Ee,ue,Ne,je;for(ve=me[Me],Ee=1,Ne=W.s3_ss[ae]*X[Me]*N[me[Me]],++ae,++Me;Me<=Ge;)ve+=me[Me],Ee+=1,ue=W.s3_ss[ae]*X[Me]*N[me[Me]],Ne=q(Ne,ue,Me-le),++ae,++Me;ve=(1+2*ve)/(2*Ee),je=N[ve]*.5,Ne*=je,U[le]=Ne,W.nb_s2[J][le]=W.nb_s1[J][le],W.nb_s1[J][le]=Ne,ue=te[le],ue*=W.minval_s[le],ue*=je,U[le]>ue&&(U[le]=ue),W.masking_lower>1&&(U[le]*=W.masking_lower),U[le]>X[le]&&(U[le]=X[le]),W.masking_lower<1&&(U[le]*=W.masking_lower),Te(U[le]>=0)}for(;le<oe.CBANDS;++le)X[le]=0,U[le]=0}function xe(R,E,X,U,J){var C=_0(oe.CBANDS),W=_0(oe.CBANDS),te=_t(oe.CBANDS+2),z;Y(R,E,X,C,W),re(R,C,W,te);var se=0;for(z=0;z<R.npart_l;z++){var ae,le,me,Ve,fe=R.s3ind[z][0],Oe=R.s3ind[z][1],ie=0,Me=0;for(ie=te[fe],Me+=1,le=R.s3_ll[se]*X[fe]*N[te[fe]],++se,++fe;fe<=Oe;)ie+=te[fe],Me+=1,ae=R.s3_ll[se]*X[fe]*N[te[fe]],Ve=q(le,ae,fe-z),le=Ve,++se,++fe;if(ie=(1+2*ie)/(2*Me),me=N[ie]*.5,le*=me,R.blocktype_old[J&1]==oe.SHORT_TYPE){var Ge=s*R.nb_1[J][z];Ge>0?U[z]=Math.min(le,Ge):U[z]=Math.min(le,X[z]*a)}else{var ve=h*R.nb_2[J][z],Ee=s*R.nb_1[J][z],Ge;ve<=0&&(ve=le),Ee<=0&&(Ee=le),R.blocktype_old[J&1]==oe.NORM_TYPE?Ge=Math.min(Ee,ve):Ge=Ee,U[z]=Math.min(le,Ge)}R.nb_2[J][z]=R.nb_1[J][z],R.nb_1[J][z]=le,ae=C[z],ae*=R.minval_l[z],ae*=me,U[z]>ae&&(U[z]=ae),R.masking_lower>1&&(U[z]*=R.masking_lower),U[z]>X[z]&&(U[z]=X[z]),R.masking_lower<1&&(U[z]*=R.masking_lower),Te(U[z]>=0)}for(;z<oe.CBANDS;++z)X[z]=0,U[z]=0}function Re(R,E){var X=R.internal_flags;R.short_blocks==bt.short_block_coupled&&!(E[0]!=0&&E[1]!=0)&&(E[0]=E[1]=0);for(var U=0;U<X.channels_out;U++)R.short_blocks==bt.short_block_dispensed&&(E[U]=1),R.short_blocks==bt.short_block_forced&&(E[U]=0)}function Xe(R,E,X){for(var U=R.internal_flags,J=0;J<U.channels_out;J++){var C=oe.NORM_TYPE;E[J]!=0?(Te(U.blocktype_old[J]!=oe.START_TYPE),U.blocktype_old[J]==oe.SHORT_TYPE&&(C=oe.STOP_TYPE)):(C=oe.SHORT_TYPE,U.blocktype_old[J]==oe.NORM_TYPE&&(U.blocktype_old[J]=oe.START_TYPE),U.blocktype_old[J]==oe.STOP_TYPE&&(U.blocktype_old[J]=oe.SHORT_TYPE)),X[J]=U.blocktype_old[J],U.blocktype_old[J]=C}}function Fe(R,E,X,U,J,C,W){for(var te=C*2,z=C>0?Math.pow(10,J):1,se,ae,le=0;le<W;++le){var me=R[2][le],Ve=R[3][le],fe=E[0][le],Oe=E[1][le],ie=E[2][le],Me=E[3][le];if(fe<=1.58*Oe&&Oe<=1.58*fe){var Ge=X[le]*Ve,ve=X[le]*me;ae=Math.max(ie,Math.min(Me,Ge)),se=Math.max(Me,Math.min(ie,ve))}else ae=ie,se=Me;if(C>0){var Ee,ue,Ne=U[le]*z;if(Ee=Math.min(Math.max(fe,Ne),Math.max(Oe,Ne)),ie=Math.max(ae,Ne),Me=Math.max(se,Ne),ue=ie+Me,ue>0&&Ee*te<ue){var je=Ee*te/ue;ie*=je,Me*=je,Te(ue>0)}ae=Math.min(ie,ae),se=Math.min(Me,se)}ae>me&&(ae=me),se>Ve&&(se=Ve),E[2][le]=ae,E[3][le]=se}}this.L3psycho_anal_vbr=function(R,E,X,U,J,C,W,te,z,se){var ae=R.internal_flags,le,me,Ve=_0(oe.HBLKSIZE),fe=Y0([3,oe.HBLKSIZE_s]),Oe=Y0([2,oe.BLKSIZE]),ie=Y0([2,3,oe.BLKSIZE_s]),Me=Y0([4,oe.CBANDS]),Ge=Y0([4,oe.CBANDS]),ve=Y0([4,3]),Ee=.6,ue=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Ne=_t(2),je=R.mode==d.JOINT_STEREO?4:ae.channels_out;Le(R,E,X,U,J,C,z,ve,ue,Ne),Re(R,Ne);{for(var ye=0;ye<je;ye++){var De=ye&1;le=Oe,he(R,E,X,ye,U,Ve,le,De),Se(R,U,ye,Ve),Ne[De]!=0?xe(ae,Ve,Me[ye],Ge[ye],ye):c0(ae,ye)}Ne[0]+Ne[1]==2&&R.mode==d.JOINT_STEREO&&Fe(Me,Ge,ae.mld_cb_l,ae.ATH.cb_l,R.ATHlower*ae.ATH.adjust,R.msfix,ae.npart_l);for(var ye=0;ye<je;ye++){var De=ye&1;Ne[De]!=0&&F(ae,Me[ye],Ge[ye],ye)}}{for(var Ue=0;Ue<3;Ue++){for(var ye=0;ye<je;++ye){var De=ye&1;Ne[De]!=0?$e(ae,ye,Ue):(me=ie,ke(R,E,X,ye,Ue,fe,me,De),w(R,fe,Me[ye],Ge[ye],ye,Ue))}Ne[0]+Ne[1]==0&&R.mode==d.JOINT_STEREO&&Fe(Me,Ge,ae.mld_cb_s,ae.ATH.cb_s,R.ATHlower*ae.ATH.adjust,R.msfix,ae.npart_s);for(var ye=0;ye<je;++ye){var De=ye&1;Ne[De]==0&&D(ae,Me[ye],Ge[ye],ye,Ue)}}for(var ye=0;ye<je;ye++){var De=ye&1;if(Ne[De]==0)for(var ge=0;ge<oe.SBMAX_s;ge++){for(var D0=_0(3),Ue=0;Ue<3;Ue++){var r0=ae.thm[ye].s[ge][Ue];if(r0*=y,ue[ye][Ue]>=2||ue[ye][Ue+1]==1){var ze=Ue!=0?Ue-1:2,p0=i(ae.thm[ye].s[ge][ze],r0,e*Ee);r0=Math.min(r0,p0)}else if(ue[ye][Ue]==1){var ze=Ue!=0?Ue-1:2,p0=i(ae.thm[ye].s[ge][ze],r0,a*Ee);r0=Math.min(r0,p0)}else if(Ue!=0&&ue[ye][Ue-1]==3||Ue==0&&ae.nsPsy.lastAttacks[ye]==3){var ze=Ue!=2?Ue+1:0,p0=i(ae.thm[ye].s[ge][ze],r0,a*Ee);r0=Math.min(r0,p0)}r0*=ve[ye][Ue],D0[Ue]=r0}for(var Ue=0;Ue<3;Ue++)ae.thm[ye].s[ge][Ue]=D0[Ue]}}}for(var ye=0;ye<je;ye++)ae.nsPsy.lastAttacks[ye]=ue[ye][2];Xe(R,Ne,se);for(var ye=0;ye<je;ye++){var P0,G0,K0,Q0;ye>1?(P0=te,G0=-2,K0=oe.NORM_TYPE,(se[0]==oe.SHORT_TYPE||se[1]==oe.SHORT_TYPE)&&(K0=oe.SHORT_TYPE),Q0=C[U][ye-2]):(P0=W,G0=0,K0=se[ye],Q0=J[U][ye]),K0==oe.SHORT_TYPE?P0[G0+ye]=K(Q0,ae.masking_lower):P0[G0+ye]=g(Q0,ae.masking_lower),R.analysis&&(ae.pinfo.pe[U][ye]=P0[G0+ye])}return 0};function Ie(R,E){var X=R,U;return X>=0?U=-X*27:U=X*E,U<=-72?0:Math.exp(U*k)}function Be(R){var E=0,X=0;{var U=0,J,C;for(U=0;Ie(U,R)>1e-20;U-=1);for(J=U,C=0;Math.abs(C-J)>1e-12;)U=(C+J)/2,Ie(U,R)>0?C=U:J=U;E=J}{var U=0,J,C;for(U=0;Ie(U,R)>1e-20;U+=1);for(J=0,C=U;Math.abs(C-J)>1e-12;)U=(C+J)/2,Ie(U,R)>0?J=U:C=U;X=C}{var W=0,te=1e3,z;for(z=0;z<=te;++z){var U=E+z*(X-E)/te,se=Ie(U,R);W+=se}{var ae=(te+1)/(W*(X-E));return ae}}}function Pe(R){var E,X,U,J;return E=R,E>=0?E*=3:E*=1.5,E>=.5&&E<=2.5?(J=E-.5,X=8*(J*J-2*J)):X=0,E+=.474,U=15.811389+7.5*E-17.5*Math.sqrt(1+E*E),U<=-60?0:(E=Math.exp((X+U)*k),E/=.6609193,E)}function Ce(R){return R<0&&(R=0),R=R*.001,13*Math.atan(.76*R)+3.5*Math.atan(R*R/(7.5*7.5))}function Ae(R,E,X,U,J,C,W,te,z,se,ae,le){var me=_0(oe.CBANDS+1),Ve=te/(le>15?2*576:2*192),fe=_t(oe.HBLKSIZE),Oe;te/=z;var ie=0,Me=0;for(Oe=0;Oe<oe.CBANDS;Oe++){var Ge,ve;for(Ge=Ce(te*ie),me[Oe]=te*ie,ve=ie;Ce(te*ve)-Ge<x&&ve<=z/2;ve++);for(R[Oe]=ve-ie,Me=Oe+1;ie<ve;)Te(ie<oe.HBLKSIZE),fe[ie++]=Oe;if(ie>z/2){ie=z/2,++Oe;break}}Te(Oe<oe.CBANDS),me[Oe]=te*ie;for(var Ee=0;Ee<le;Ee++){var ue,Ne,je,ye,De;je=se[Ee],ye=se[Ee+1],ue=0|Math.floor(.5+ae*(je-.5)),ue<0&&(ue=0),Ne=0|Math.floor(.5+ae*(ye-.5)),Ne>z/2&&(Ne=z/2),X[Ee]=(fe[ue]+fe[Ne])/2,E[Ee]=fe[Ne];var Ue=Ve*ye;W[Ee]=(Ue-me[E[Ee]])/(me[E[Ee]+1]-me[E[Ee]]),W[Ee]<0?W[Ee]=0:W[Ee]>1&&(W[Ee]=1),De=Ce(te*se[Ee]*ae),De=Math.min(De,15.5)/15.5,C[Ee]=Math.pow(10,1.25*(1-Math.cos(Math.PI*De))-2.5)}ie=0;for(var ge=0;ge<Me;ge++){var D0=R[ge],Ge,r0;Ge=Ce(te*ie),r0=Ce(te*(ie+D0-1)),U[ge]=.5*(Ge+r0),Ge=Ce(te*(ie-.5)),r0=Ce(te*(ie+D0-.5)),J[ge]=r0-Ge,ie+=D0}return Me}function We(R,E,X,U,J,C){var W=Y0([oe.CBANDS,oe.CBANDS]),te,z=0;if(C)for(var se=0;se<E;se++)for(te=0;te<E;te++){var ae=Pe(X[se]-X[te])*U[te];W[se][te]=ae*J[se]}else for(te=0;te<E;te++)for(var le=15+Math.min(21/X[te],12),me=Be(le),se=0;se<E;se++){var ae=me*Ie(X[se]-X[te],le)*U[te];W[se][te]=ae*J[se]}for(var se=0;se<E;se++){for(te=0;te<E&&!(W[se][te]>0);te++);for(R[se][0]=te,te=E-1;te>0&&!(W[se][te]>0);te--);R[se][1]=te,z+=R[se][1]-R[se][0]+1}for(var Ve=_0(z),fe=0,se=0;se<E;se++)for(te=R[se][0];te<=R[se][1];te++)Ve[fe++]=W[se][te];return Ve}function f0(R){var E=Ce(R);return E=Math.min(E,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*E))-2.5)}this.psymodel_init=function(R){var E=R.internal_flags,X,U=!0,J=13,C=24,W=0,te=0,z=-8.25,se=-4.5,ae=_0(oe.CBANDS),le=_0(oe.CBANDS),me=_0(oe.CBANDS),Ve=R.out_samplerate;switch(R.experimentalZ){default:case 0:U=!0;break;case 1:U=!(R.VBR==mt.vbr_mtrh||R.VBR==mt.vbr_mt);break;case 2:U=!1;break;case 3:J=8,W=-1.75,te=-.0125,z=-8.25,se=-2.25;break}for(E.ms_ener_ratio_old=.25,E.blocktype_old[0]=E.blocktype_old[1]=oe.NORM_TYPE,X=0;X<4;++X){for(var ie=0;ie<oe.CBANDS;++ie)E.nb_1[X][ie]=1e20,E.nb_2[X][ie]=1e20,E.nb_s1[X][ie]=E.nb_s2[X][ie]=1;for(var fe=0;fe<oe.SBMAX_l;fe++)E.en[X].l[fe]=1e20,E.thm[X].l[fe]=1e20;for(var ie=0;ie<3;++ie){for(var fe=0;fe<oe.SBMAX_s;fe++)E.en[X].s[fe][ie]=1e20,E.thm[X].s[fe][ie]=1e20;E.nsPsy.lastAttacks[X]=0}for(var ie=0;ie<9;ie++)E.nsPsy.last_en_subshort[X][ie]=10}for(E.loudness_sq_save[0]=E.loudness_sq_save[1]=0,E.npart_l=Ae(E.numlines_l,E.bo_l,E.bm_l,ae,le,E.mld_l,E.PSY.bo_l_weight,Ve,oe.BLKSIZE,E.scalefac_band.l,oe.BLKSIZE/(2*576),oe.SBMAX_l),Te(E.npart_l<oe.CBANDS),X=0;X<E.npart_l;X++){var Oe=W;ae[X]>=J&&(Oe=te*(ae[X]-J)/(C-J)+W*(C-ae[X])/(C-J)),me[X]=Math.pow(10,Oe/10),E.numlines_l[X]>0?E.rnumlines_l[X]=1/E.numlines_l[X]:E.rnumlines_l[X]=0}E.s3_ll=We(E.s3ind,E.npart_l,ae,le,me,U);var ie=0;for(X=0;X<E.npart_l;X++){var Me;Me=Ka.MAX_VALUE;for(var Ge=0;Ge<E.numlines_l[X];Ge++,ie++){var ve=Ve*ie/(1e3*oe.BLKSIZE),Ee;Ee=this.ATHformula(ve*1e3,R)-20,Ee=Math.pow(10,.1*Ee),Ee*=E.numlines_l[X],Me>Ee&&(Me=Ee)}E.ATH.cb_l[X]=Me,Me=-20+ae[X]*20/10,Me>6&&(Me=100),Me<-15&&(Me=-15),Me-=8,E.minval_l[X]=Math.pow(10,Me/10)*E.numlines_l[X]}for(E.npart_s=Ae(E.numlines_s,E.bo_s,E.bm_s,ae,le,E.mld_s,E.PSY.bo_s_weight,Ve,oe.BLKSIZE_s,E.scalefac_band.s,oe.BLKSIZE_s/(2*192),oe.SBMAX_s),Te(E.npart_s<oe.CBANDS),ie=0,X=0;X<E.npart_s;X++){var Me,Oe=z;ae[X]>=J&&(Oe=se*(ae[X]-J)/(C-J)+z*(C-ae[X])/(C-J)),me[X]=Math.pow(10,Oe/10),Me=Ka.MAX_VALUE;for(var Ge=0;Ge<E.numlines_s[X];Ge++,ie++){var ve=Ve*ie/(1e3*oe.BLKSIZE_s),Ee;Ee=this.ATHformula(ve*1e3,R)-20,Ee=Math.pow(10,.1*Ee),Ee*=E.numlines_s[X],Me>Ee&&(Me=Ee)}E.ATH.cb_s[X]=Me,Me=-7+ae[X]*7/12,ae[X]>12&&(Me*=1+Math.log(1+Me)*3.1),ae[X]<12&&(Me*=1+Math.log(1-Me)*2.3),Me<-15&&(Me=-15),Me-=8,E.minval_s[X]=Math.pow(10,Me/10)*E.numlines_s[X]}E.s3_ss=We(E.s3ind_s,E.npart_s,ae,le,me,U),V(),o.init_fft(E),E.decay=Math.exp(-1*t/($*Ve/192));{var ue;ue=f,R.exp_nspsytune&2&&(ue=1),Math.abs(R.msfix)>0&&(ue=R.msfix),R.msfix=ue;for(var Ne=0;Ne<E.npart_l;Ne++)E.s3ind[Ne][1]>E.npart_l-1&&(E.s3ind[Ne][1]=E.npart_l-1)}var je=576*E.mode_gr/Ve;if(E.ATH.decay=Math.pow(10,-12/10*je),E.ATH.adjust=.01,E.ATH.adjustLimit=1,Te(E.bo_l[oe.SBMAX_l-1]<=E.npart_l),Te(E.bo_s[oe.SBMAX_s-1]<=E.npart_s),R.ATHtype!=-1){var ve,ye=R.out_samplerate/oe.BLKSIZE,De=0;for(ve=0,X=0;X<oe.BLKSIZE/2;++X)ve+=ye,E.ATH.eql_w[X]=1/Math.pow(10,this.ATHformula(ve,R)/10),De+=E.ATH.eql_w[X];for(De=1/De,X=oe.BLKSIZE/2;--X>=0;)E.ATH.eql_w[X]*=De}{for(var Ne=ie=0;Ne<E.npart_s;++Ne)for(X=0;X<E.numlines_s[Ne];++X)++ie;Te(ie==129);for(var Ne=ie=0;Ne<E.npart_l;++Ne)for(X=0;X<E.numlines_l[Ne];++X)++ie;Te(ie==513)}for(ie=0,X=0;X<E.npart_l;X++){var ve=Ve*(ie+E.numlines_l[X]/2)/(1*oe.BLKSIZE);E.mld_cb_l[X]=f0(ve),ie+=E.numlines_l[X]}for(;X<oe.CBANDS;++X)E.mld_cb_l[X]=1;for(ie=0,X=0;X<E.npart_s;X++){var ve=Ve*(ie+E.numlines_s[X]/2)/(1*oe.BLKSIZE_s);E.mld_cb_s[X]=f0(ve),ie+=E.numlines_s[X]}for(;X<oe.CBANDS;++X)E.mld_cb_s[X]=1;return 0};function Ze(R,E){R<-.3&&(R=3410),R/=1e3,R=Math.max(.1,R);var X=3.64*Math.pow(R,-.8)-6.8*Math.exp(-.6*Math.pow(R-3.4,2))+6*Math.exp(-.15*Math.pow(R-8.7,2))+(.6+.04*E)*.001*Math.pow(R,4);return X}this.ATHformula=function(R,E){var X;switch(E.ATHtype){case 0:X=Ze(R,9);break;case 1:X=Ze(R,-1);break;case 2:X=Ze(R,0);break;case 3:X=Ze(R,1)+6;break;case 4:X=Ze(R,E.ATHcurve);break;default:X=Ze(R,0);break}return X}}var _r=or,ur=Ct;function fr(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=ur.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var vr=fr,cr=b0(),F1={};F1.SFBMAX=cr.SBMAX_s*3;var Jt=F1,R0=t0;R0.System;R0.VbrMode;R0.Float;R0.ShortBlock;R0.Util;R0.Arrays;R0.new_array_n;R0.new_byte;R0.new_double;var dr=R0.new_float;R0.new_float_n;var ut=R0.new_int;R0.new_int_n;R0.assert;var da=Jt;function hr(){this.xr=dr(576),this.l3_enc=ut(576),this.scalefac=ut(da.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=ut(3),this.subblock_gain=ut(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=ut(da.SFBMAX),this.window=ut(da.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=ut(4),this.max_nonzero_coeff=0;var d=this;function o(s){return new Int32Array(s)}function t(s){return new Float32Array(s)}this.assign=function(s){d.xr=t(s.xr),d.l3_enc=o(s.l3_enc),d.scalefac=o(s.scalefac),d.xrpow_max=s.xrpow_max,d.part2_3_length=s.part2_3_length,d.big_values=s.big_values,d.count1=s.count1,d.global_gain=s.global_gain,d.scalefac_compress=s.scalefac_compress,d.block_type=s.block_type,d.mixed_block_flag=s.mixed_block_flag,d.table_select=o(s.table_select),d.subblock_gain=o(s.subblock_gain),d.region0_count=s.region0_count,d.region1_count=s.region1_count,d.preflag=s.preflag,d.scalefac_scale=s.scalefac_scale,d.count1table_select=s.count1table_select,d.part2_length=s.part2_length,d.sfb_lmax=s.sfb_lmax,d.sfb_smin=s.sfb_smin,d.psy_lmax=s.psy_lmax,d.sfbmax=s.sfbmax,d.psymax=s.psymax,d.sfbdivide=s.sfbdivide,d.width=o(s.width),d.window=o(s.window),d.count1bits=s.count1bits,d.sfb_partition_table=s.sfb_partition_table.slice(0),d.slen=o(s.slen),d.max_nonzero_coeff=s.max_nonzero_coeff}}var Ia=hr,E0=t0;E0.System;E0.VbrMode;E0.Float;E0.ShortBlock;E0.Util;E0.Arrays;E0.new_array_n;E0.new_byte;E0.new_double;E0.new_float;E0.new_float_n;var Qa=E0.new_int;E0.new_int_n;E0.assert;var mr=Ia;function br(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Qa(4),Qa(4)];for(var d=0;d<2;d++)for(var o=0;o<2;o++)this.tt[d][o]=new mr}var pr=br,B0=t0,Vt=B0.System;B0.VbrMode;B0.Float;B0.ShortBlock;B0.Util;B0.Arrays;B0.new_array_n;B0.new_byte;B0.new_double;B0.new_float;B0.new_float_n;var Nt=B0.new_int;B0.new_int_n;B0.assert;var Ft=b0();function Ar(d,o,t,s){this.l=Nt(1+Ft.SBMAX_l),this.s=Nt(1+Ft.SBMAX_s),this.psfb21=Nt(1+Ft.PSFB21),this.psfb12=Nt(1+Ft.PSFB12);var h=this.l,S=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Vt.arraycopy(this.arrL,0,h,0,Math.min(this.arrL.length,this.l.length)),Vt.arraycopy(this.arrS,0,S,0,Math.min(this.arrS.length,this.s.length)),Vt.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Vt.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var X1=Ar,I0=t0;I0.System;I0.VbrMode;I0.Float;I0.ShortBlock;I0.Util;I0.Arrays;I0.new_array_n;I0.new_byte;I0.new_double;var ha=I0.new_float,yr=I0.new_float_n,Sr=I0.new_int;I0.new_int_n;I0.assert;var Wa=b0();function wr(){this.last_en_subshort=yr([4,9]),this.lastAttacks=Sr(4),this.pefirbuf=ha(19),this.longfact=ha(Wa.SBMAX_l),this.shortfact=ha(Wa.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var xr=wr;function Tr(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Mr=Tr,k0=t0;k0.System;k0.VbrMode;k0.Float;k0.ShortBlock;k0.Util;k0.Arrays;k0.new_array_n;var Rr=k0.new_byte,Er=k0.new_double,U0=k0.new_float,ft=k0.new_float_n,W0=k0.new_int,Xt=k0.new_int_n;k0.assert;var Br=pr,Ir=X1,kr=xr,Lr=Mr,ja=N1(),a0=b0(),Cr=Jt;nt.MFSIZE=3*1152+a0.ENCDELAY-a0.MDCTDELAY;nt.MAX_HEADER_BUF=256;nt.MAX_BITS_PER_CHANNEL=4095;nt.MAX_BITS_PER_GRANULE=7680;nt.BPC=320;function nt(){var d=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=ft([2,nt.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Br,this.ms_ratio=U0(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=W0(2),this.CurrentStep=W0(2),this.masking_lower=0,this.bv_scf=W0(576),this.pseudohalf=W0(Cr.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*nt.BPC+1),this.itime=Er(2),this.sideinfo_len=0,this.sb_sample=ft([2,2,18,a0.SBLIMIT]),this.amp_filter=U0(32);function o(){this.write_timing=0,this.ptr=0,this.buf=Rr(d)}this.header=new Array(nt.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Ir,this.minval_l=U0(a0.CBANDS),this.minval_s=U0(a0.CBANDS),this.nb_1=ft([4,a0.CBANDS]),this.nb_2=ft([4,a0.CBANDS]),this.nb_s1=ft([4,a0.CBANDS]),this.nb_s2=ft([4,a0.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=U0(4),this.loudness_sq=ft([2,2]),this.loudness_sq_save=U0(2),this.mld_l=U0(a0.SBMAX_l),this.mld_s=U0(a0.SBMAX_s),this.bm_l=W0(a0.SBMAX_l),this.bo_l=W0(a0.SBMAX_l),this.bm_s=W0(a0.SBMAX_s),this.bo_s=W0(a0.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Xt([a0.CBANDS,2]),this.s3ind_s=Xt([a0.CBANDS,2]),this.numlines_s=W0(a0.CBANDS),this.numlines_l=W0(a0.CBANDS),this.rnumlines_l=U0(a0.CBANDS),this.mld_cb_l=U0(a0.CBANDS),this.mld_cb_s=U0(a0.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=U0(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=W0(2),this.nsPsy=new kr,this.VBR_seek_table=new Lr,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Xt([16,4+1]),this.bitrate_blockType_Hist=Xt([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new ja;for(var t=0;t<this.thm.length;t++)this.thm[t]=new ja;for(var t=0;t<this.header.length;t++)this.header[t]=new o}var gt=nt,L0=t0;L0.System;L0.VbrMode;L0.Float;L0.ShortBlock;L0.Util;L0.Arrays;L0.new_array_n;L0.new_byte;L0.new_double;var vt=L0.new_float;L0.new_float_n;L0.new_int;L0.new_int_n;L0.assert;var ct=b0();function Or(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=vt(ct.SBMAX_l),this.s=vt(ct.SBMAX_s),this.psfb21=vt(ct.PSFB21),this.psfb12=vt(ct.PSFB12),this.cb_l=vt(ct.CBANDS),this.cb_s=vt(ct.CBANDS),this.eql_w=vt(ct.BLKSIZE/2)}var Hr=Or,C0=t0,S0=C0.System;C0.VbrMode;C0.Float;C0.ShortBlock;C0.Util;var za=C0.Arrays;C0.new_array_n;C0.new_byte;C0.new_double;C0.new_float;C0.new_float_n;C0.new_int;C0.new_int_n;C0.assert;Je.STEPS_per_dB=100;Je.MAX_dB=120;Je.GAIN_NOT_ENOUGH_SAMPLES=-24601;Je.GAIN_ANALYSIS_ERROR=0;Je.GAIN_ANALYSIS_OK=1;Je.INIT_GAIN_ANALYSIS_ERROR=0;Je.INIT_GAIN_ANALYSIS_OK=1;Je.YULE_ORDER=10;Je.MAX_ORDER=Je.YULE_ORDER;Je.MAX_SAMP_FREQ=48e3;Je.RMS_WINDOW_TIME_NUMERATOR=1;Je.RMS_WINDOW_TIME_DENOMINATOR=20;Je.MAX_SAMPLES_PER_WINDOW=Je.MAX_SAMP_FREQ*Je.RMS_WINDOW_TIME_NUMERATOR/Je.RMS_WINDOW_TIME_DENOMINATOR+1;function Je(){var d=64.82;Je.YULE_ORDER;var o=.95;Je.MAX_SAMP_FREQ;var t=Je.RMS_WINDOW_TIME_NUMERATOR,s=Je.RMS_WINDOW_TIME_DENOMINATOR;Je.MAX_SAMPLES_PER_WINDOW;var h=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],S=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function c(e,a,f,A,k,I){for(;k--!=0;)f[A]=1e-10+e[a+0]*I[0]-f[A-1]*I[1]+e[a-1]*I[2]-f[A-2]*I[3]+e[a-2]*I[4]-f[A-3]*I[5]+e[a-3]*I[6]-f[A-4]*I[7]+e[a-4]*I[8]-f[A-5]*I[9]+e[a-5]*I[10]-f[A-6]*I[11]+e[a-6]*I[12]-f[A-7]*I[13]+e[a-7]*I[14]-f[A-8]*I[15]+e[a-8]*I[16]-f[A-9]*I[17]+e[a-9]*I[18]-f[A-10]*I[19]+e[a-10]*I[20],++A,++a}function x(e,a,f,A,k,I){for(;k--!=0;)f[A]=e[a+0]*I[0]-f[A-1]*I[1]+e[a-1]*I[2]-f[A-2]*I[3]+e[a-2]*I[4],++A,++a}function H(e,a){for(var f=0;f<MAX_ORDER;f++)e.linprebuf[f]=e.lstepbuf[f]=e.loutbuf[f]=e.rinprebuf[f]=e.rstepbuf[f]=e.routbuf[f]=0;switch(0|a){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(a*t+s-1)/s,e.lsum=0,e.rsum=0,e.totsamp=0,za.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(e,a){return H(e,a)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,za.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)};function $(e){return e*e}this.AnalyzeSamples=function(e,a,f,A,k,I,u){var l,b,M,r,p,L,P;if(I==0)return GAIN_ANALYSIS_OK;switch(P=0,p=I,u){case 1:A=a,k=f;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(I<MAX_ORDER?(S0.arraycopy(a,f,e.linprebuf,MAX_ORDER,I),S0.arraycopy(A,k,e.rinprebuf,MAX_ORDER,I)):(S0.arraycopy(a,f,e.linprebuf,MAX_ORDER,MAX_ORDER),S0.arraycopy(A,k,e.rinprebuf,MAX_ORDER,MAX_ORDER));p>0;){L=p>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:p,P<MAX_ORDER?(l=e.linpre+P,b=e.linprebuf,M=e.rinpre+P,r=e.rinprebuf,L>MAX_ORDER-P&&(L=MAX_ORDER-P)):(l=f+P,b=a,M=k+P,r=A),c(b,l,e.lstepbuf,e.lstep+e.totsamp,L,h[e.reqindex]),c(r,M,e.rstepbuf,e.rstep+e.totsamp,L,h[e.reqindex]),x(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,L,S[e.reqindex]),x(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,L,S[e.reqindex]),l=e.lout+e.totsamp,b=e.loutbuf,M=e.rout+e.totsamp,r=e.routbuf;for(var N=L%8;N--!=0;)e.lsum+=$(b[l++]),e.rsum+=$(r[M++]);for(N=L/8;N--!=0;)e.lsum+=$(b[l+0])+$(b[l+1])+$(b[l+2])+$(b[l+3])+$(b[l+4])+$(b[l+5])+$(b[l+6])+$(b[l+7]),l+=8,e.rsum+=$(r[M+0])+$(r[M+1])+$(r[M+2])+$(r[M+3])+$(r[M+4])+$(r[M+5])+$(r[M+6])+$(r[M+7]),M+=8;if(p-=L,P+=L,e.totsamp+=L,e.totsamp==e.sampleWindow){var V=Je.STEPS_per_dB*10*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),Q=V<=0?0:0|V;Q>=e.A.length&&(Q=e.A.length-1),e.A[Q]++,e.lsum=e.rsum=0,S0.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),S0.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),S0.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),S0.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return I<MAX_ORDER?(S0.arraycopy(e.linprebuf,I,e.linprebuf,0,MAX_ORDER-I),S0.arraycopy(e.rinprebuf,I,e.rinprebuf,0,MAX_ORDER-I),S0.arraycopy(a,f,e.linprebuf,MAX_ORDER-I,I),S0.arraycopy(A,k,e.rinprebuf,MAX_ORDER-I,I)):(S0.arraycopy(a,f+I-MAX_ORDER,e.linprebuf,0,MAX_ORDER),S0.arraycopy(A,k+I-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function y(e,a){var f,A=0;for(f=0;f<a;f++)A+=e[f];if(A==0)return GAIN_NOT_ENOUGH_SAMPLES;var k=0|Math.ceil(A*(1-o));for(f=a;f-- >0&&!((k-=e[f])<=0););return d-f/Je.STEPS_per_dB}this.GetTitleGain=function(e){for(var a=y(e.A,e.A.length),f=0;f<e.A.length;f++)e.B[f]+=e.A[f],e.A[f]=0;for(var f=0;f<MAX_ORDER;f++)e.linprebuf[f]=e.lstepbuf[f]=e.loutbuf[f]=e.rinprebuf[f]=e.rstepbuf[f]=e.routbuf[f]=0;return e.totsamp=0,e.lsum=e.rsum=0,a}}var D1=Je,O0=t0;O0.System;O0.VbrMode;O0.Float;O0.ShortBlock;O0.Util;O0.Arrays;O0.new_array_n;O0.new_byte;O0.new_double;var pt=O0.new_float;O0.new_float_n;var Ja=O0.new_int;O0.new_int_n;O0.assert;var w0=D1;function Vr(){this.linprebuf=pt(w0.MAX_ORDER*2),this.linpre=0,this.lstepbuf=pt(w0.MAX_SAMPLES_PER_WINDOW+w0.MAX_ORDER),this.lstep=0,this.loutbuf=pt(w0.MAX_SAMPLES_PER_WINDOW+w0.MAX_ORDER),this.lout=0,this.rinprebuf=pt(w0.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=pt(w0.MAX_SAMPLES_PER_WINDOW+w0.MAX_ORDER),this.rstep=0,this.routbuf=pt(w0.MAX_SAMPLES_PER_WINDOW+w0.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=Ja(0|w0.STEPS_per_dB*w0.MAX_dB),this.B=Ja(0|w0.STEPS_per_dB*w0.MAX_dB)}var Nr=Vr;function Fr(d){this.bits=d}var P1=Fr,H0=t0;H0.System;H0.VbrMode;H0.Float;H0.ShortBlock;H0.Util;H0.Arrays;H0.new_array_n;H0.new_byte;H0.new_double;var ga=H0.new_float;H0.new_float_n;var Xr=H0.new_int;H0.new_int_n;var e1=H0.assert,Dr=P1,t1=b0(),Pr=Jt,Gr=gt;function qr(d){var o=d;this.quantize=o,this.iteration_loop=function(t,s,h,S){var c=t.internal_flags,x=ga(Pr.SFBMAX),H=ga(576),$=Xr(2),y=0,e,a=c.l3_side,f=new Dr(y);this.quantize.rv.ResvFrameBegin(t,f),y=f.bits;for(var A=0;A<c.mode_gr;A++){e=this.quantize.qupvt.on_pe(t,s,$,y,A,A),c.mode_ext==t1.MPG_MD_MS_LR&&(this.quantize.ms_convert(c.l3_side,A),this.quantize.qupvt.reduce_side($,h[A],y,e));for(var k=0;k<c.channels_out;k++){var I,u,l=a.tt[A][k];l.block_type!=t1.SHORT_TYPE?(I=0,u=c.PSY.mask_adjust-I):(I=0,u=c.PSY.mask_adjust_short-I),c.masking_lower=Math.pow(10,u*.1),this.quantize.init_outer_loop(c,l),this.quantize.init_xrpow(c,l,H)&&(this.quantize.qupvt.calc_xmin(t,S[A][k],l,x),this.quantize.outer_loop(t,l,x,H,k,$[k])),this.quantize.iteration_finish_one(c,A,k),e1(l.part2_3_length<=Gr.MAX_BITS_PER_CHANNEL),e1(l.part2_3_length<=$[k])}}this.quantize.rv.ResvFrameEnd(c,y)}}var Yr=qr;function Ke(d,o,t,s){this.xlen=d,this.linmax=o,this.table=t,this.hlen=s}var ce={};ce.t1HB=[1,1,1,0];ce.t2HB=[1,2,1,3,1,1,3,2,0];ce.t3HB=[3,2,1,1,1,1,3,2,0];ce.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];ce.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];ce.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];ce.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];ce.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];ce.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];ce.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];ce.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];ce.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];ce.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];ce.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];ce.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];ce.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];ce.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];ce.t1l=[1,4,3,5];ce.t2l=[1,4,7,4,5,7,6,7,8];ce.t3l=[2,3,7,4,4,7,6,7,8];ce.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];ce.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];ce.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];ce.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];ce.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];ce.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];ce.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];ce.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];ce.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];ce.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];ce.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];ce.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];ce.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];ce.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4];ce.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4];ce.ht=[new Ke(0,0,null,null),new Ke(2,0,ce.t1HB,ce.t1l),new Ke(3,0,ce.t2HB,ce.t2l),new Ke(3,0,ce.t3HB,ce.t3l),new Ke(0,0,null,null),new Ke(4,0,ce.t5HB,ce.t5l),new Ke(4,0,ce.t6HB,ce.t6l),new Ke(6,0,ce.t7HB,ce.t7l),new Ke(6,0,ce.t8HB,ce.t8l),new Ke(6,0,ce.t9HB,ce.t9l),new Ke(8,0,ce.t10HB,ce.t10l),new Ke(8,0,ce.t11HB,ce.t11l),new Ke(8,0,ce.t12HB,ce.t12l),new Ke(16,0,ce.t13HB,ce.t13l),new Ke(0,0,null,ce.t16_5l),new Ke(16,0,ce.t15HB,ce.t15l),new Ke(1,1,ce.t16HB,ce.t16l),new Ke(2,3,ce.t16HB,ce.t16l),new Ke(3,7,ce.t16HB,ce.t16l),new Ke(4,15,ce.t16HB,ce.t16l),new Ke(6,63,ce.t16HB,ce.t16l),new Ke(8,255,ce.t16HB,ce.t16l),new Ke(10,1023,ce.t16HB,ce.t16l),new Ke(13,8191,ce.t16HB,ce.t16l),new Ke(4,15,ce.t24HB,ce.t24l),new Ke(5,31,ce.t24HB,ce.t24l),new Ke(6,63,ce.t24HB,ce.t24l),new Ke(7,127,ce.t24HB,ce.t24l),new Ke(8,255,ce.t24HB,ce.t24l),new Ke(9,511,ce.t24HB,ce.t24l),new Ke(11,2047,ce.t24HB,ce.t24l),new Ke(13,8191,ce.t24HB,ce.t24l),new Ke(0,0,ce.t32HB,ce.t32l),new Ke(0,0,ce.t33HB,ce.t33l)];ce.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];ce.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];ce.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];ce.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];ce.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];ce.scfsi_band=[0,6,11,16,21];var ka=ce,ma,a1;function G1(){if(a1)return ma;a1=1;var d=X1,o=t0;o.System;var t=o.VbrMode,s=o.Float;o.ShortBlock;var h=o.Util;o.Arrays,o.new_array_n,o.new_byte,o.new_double;var S=o.new_float;o.new_float_n;var c=o.new_int;o.new_int_n;var x=o.assert,H=b0(),$=P1,y=gt;e.Q_MAX=256+1,e.Q_MAX2=116,e.LARGE_BITS=1e5,e.IXMAX_VAL=8206;function e(){var a=La(),f=null,A=null,k=null;this.setModules=function(O,q,Z){f=O,A=q,k=Z};function I(O){return x(0<=O+e.Q_MAX2&&O<e.Q_MAX),P[O+e.Q_MAX2]}this.IPOW20=function(O){return x(0<=O&&O<e.Q_MAX),N[O]};var u=2220446049250313e-31,l=e.IXMAX_VAL,b=l+2,M=e.Q_MAX,r=e.Q_MAX2;e.LARGE_BITS;var p=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var L=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=L,this.sfBandIndex=[new d([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new d([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var P=S(M+r+1),N=S(M),V=S(b),Q=S(b);this.adj43=Q;function j(O,q){var Z=k.ATHformula(q,O);return Z-=p,Z=Math.pow(10,Z/10+O.ATHlower),Z}function B(O){for(var q=O.internal_flags.ATH.l,Z=O.internal_flags.ATH.psfb21,G=O.internal_flags.ATH.s,ee=O.internal_flags.ATH.psfb12,D=O.internal_flags,F=O.out_samplerate,v=0;v<H.SBMAX_l;v++){var m=D.scalefac_band.l[v],i=D.scalefac_band.l[v+1];q[v]=s.MAX_VALUE;for(var T=m;T<i;T++){var K=T*F/1152,ne=j(O,K);q[v]=Math.min(q[v],ne)}}for(var v=0;v<H.PSFB21;v++){var m=D.scalefac_band.psfb21[v],i=D.scalefac_band.psfb21[v+1];Z[v]=s.MAX_VALUE;for(var T=m;T<i;T++){var K=T*F/1152,ne=j(O,K);Z[v]=Math.min(Z[v],ne)}}for(var v=0;v<H.SBMAX_s;v++){var m=D.scalefac_band.s[v],i=D.scalefac_band.s[v+1];G[v]=s.MAX_VALUE;for(var T=m;T<i;T++){var K=T*F/384,ne=j(O,K);G[v]=Math.min(G[v],ne)}G[v]*=D.scalefac_band.s[v+1]-D.scalefac_band.s[v]}for(var v=0;v<H.PSFB12;v++){var m=D.scalefac_band.psfb12[v],i=D.scalefac_band.psfb12[v+1];ee[v]=s.MAX_VALUE;for(var T=m;T<i;T++){var K=T*F/384,ne=j(O,K);ee[v]=Math.min(ee[v],ne)}ee[v]*=D.scalefac_band.s[13]-D.scalefac_band.s[12]}if(O.noATH){for(var v=0;v<H.SBMAX_l;v++)q[v]=1e-20;for(var v=0;v<H.PSFB21;v++)Z[v]=1e-20;for(var v=0;v<H.SBMAX_s;v++)G[v]=1e-20;for(var v=0;v<H.PSFB12;v++)ee[v]=1e-20}D.ATH.floor=10*Math.log10(j(O,-1))}this.iteration_init=function(O){var q=O.internal_flags,Z=q.l3_side,G;if(q.iteration_init_init==0){for(q.iteration_init_init=1,Z.main_data_begin=0,B(O),V[0]=0,G=1;G<b;G++)V[G]=Math.pow(G,4/3);for(G=0;G<b-1;G++)Q[G]=G+1-Math.pow(.5*(V[G]+V[G+1]),.75);for(Q[G]=.5,G=0;G<M;G++)N[G]=Math.pow(2,(G-210)*-.1875);for(G=0;G<=M+r;G++)P[G]=Math.pow(2,(G-210-r)*.25);f.huffman_init(q);{var ee,D,F,v;for(G=O.exp_nspsytune>>2&63,G>=32&&(G-=64),ee=Math.pow(10,G/4/10),G=O.exp_nspsytune>>8&63,G>=32&&(G-=64),D=Math.pow(10,G/4/10),G=O.exp_nspsytune>>14&63,G>=32&&(G-=64),F=Math.pow(10,G/4/10),G=O.exp_nspsytune>>20&63,G>=32&&(G-=64),v=F*Math.pow(10,G/4/10),G=0;G<H.SBMAX_l;G++){var m;G<=6?m=ee:G<=13?m=D:G<=20?m=F:m=v,q.nsPsy.longfact[G]=m}for(G=0;G<H.SBMAX_s;G++){var m;G<=5?m=ee:G<=10?m=D:G<=11?m=F:m=v,q.nsPsy.shortfact[G]=m}}}},this.on_pe=function(O,q,Z,G,ee,D){var F=O.internal_flags,v=0,m,i=c(2),T,K=new $(v),ne=A.ResvMaxBits(O,G,K,D);v=K.bits;var g=v+ne;for(g>y.MAX_BITS_PER_GRANULE&&(g=y.MAX_BITS_PER_GRANULE),m=0,T=0;T<F.channels_out;++T)Z[T]=Math.min(y.MAX_BITS_PER_CHANNEL,v/F.channels_out),i[T]=0|Z[T]*q[ee][T]/700-Z[T],i[T]>G*3/4&&(i[T]=G*3/4),i[T]<0&&(i[T]=0),i[T]+Z[T]>y.MAX_BITS_PER_CHANNEL&&(i[T]=Math.max(0,y.MAX_BITS_PER_CHANNEL-Z[T])),m+=i[T];if(m>ne)for(T=0;T<F.channels_out;++T)i[T]=ne*i[T]/m;for(T=0;T<F.channels_out;++T)Z[T]+=i[T],ne-=i[T];for(m=0,T=0;T<F.channels_out;++T)m+=Z[T];if(m>y.MAX_BITS_PER_GRANULE){var Y=0;for(T=0;T<F.channels_out;++T)Z[T]*=y.MAX_BITS_PER_GRANULE,Z[T]/=m,Y+=Z[T];x(Y<=y.MAX_BITS_PER_GRANULE)}return g},this.reduce_side=function(O,q,Z,G){x(G<=y.MAX_BITS_PER_GRANULE),x(O[0]+O[1]<=y.MAX_BITS_PER_GRANULE);var ee=.33*(.5-q)/.5;ee<0&&(ee=0),ee>.5&&(ee=.5);var D=0|ee*.5*(O[0]+O[1]);D>y.MAX_BITS_PER_CHANNEL-O[0]&&(D=y.MAX_BITS_PER_CHANNEL-O[0]),D<0&&(D=0),O[1]>=125&&(O[1]-D>125?(O[0]<Z&&(O[0]+=D),O[1]-=D):(O[0]+=O[1]-125,O[1]=125)),D=O[0]+O[1],D>G&&(O[0]=G*O[0]/D,O[1]=G*O[1]/D),x(O[0]<=y.MAX_BITS_PER_CHANNEL),x(O[1]<=y.MAX_BITS_PER_CHANNEL),x(O[0]+O[1]<=y.MAX_BITS_PER_GRANULE)},this.athAdjust=function(O,q,Z){var G=90.30873362,ee=94.82444863,D=h.FAST_LOG10_X(q,10),F=O*O,v=0;return D-=Z,F>1e-20&&(v=1+h.FAST_LOG10_X(F,10/G)),v<0&&(v=0),D*=v,D+=Z+G-ee,Math.pow(10,.1*D)},this.calc_xmin=function(O,q,Z,G){var ee=0,D=O.internal_flags,F,v=0,m=0,i=D.ATH,T=Z.xr,K=O.VBR==t.vbr_mtrh?1:0,ne=D.masking_lower;for((O.VBR==t.vbr_mtrh||O.VBR==t.vbr_mt)&&(ne=1),F=0;F<Z.psy_lmax;F++){var g,Y,re,_e,he,ke;O.VBR==t.vbr_rh||O.VBR==t.vbr_mtrh?Y=athAdjust(i.adjust,i.l[F],i.floor):Y=i.adjust*i.l[F],he=Z.width[F],re=Y/he,_e=u,ke=he>>1,g=0;do{var Se,be;Se=T[v]*T[v],g+=Se,_e+=Se<re?Se:re,v++,be=T[v]*T[v],g+=be,_e+=be<re?be:re,v++}while(--ke>0);if(g>Y&&m++,F==H.SBPSY_l){var Le=Y*D.nsPsy.longfact[F];_e<Le&&(_e=Le)}if(K!=0&&(Y=_e),!O.ATHonly){var $e=q.en.l[F];if($e>0){var Le;Le=g*q.thm.l[F]*ne/$e,K!=0&&(Le*=D.nsPsy.longfact[F]),Y<Le&&(Y=Le)}}K!=0?G[ee++]=Y:G[ee++]=Y*D.nsPsy.longfact[F]}var c0=575;if(Z.block_type!=H.SHORT_TYPE)for(var _=576;_--!=0&&a.EQ(T[_],0);)c0=_;Z.max_nonzero_coeff=c0;for(var w=Z.sfb_smin;F<Z.psymax;w++,F+=3){var he,xe,Re;for(O.VBR==t.vbr_rh||O.VBR==t.vbr_mtrh?Re=athAdjust(i.adjust,i.s[w],i.floor):Re=i.adjust*i.s[w],he=Z.width[F],xe=0;xe<3;xe++){var g=0,Y,re,_e,ke=he>>1;re=Re/he,_e=u;do{var Se,be;Se=T[v]*T[v],g+=Se,_e+=Se<re?Se:re,v++,be=T[v]*T[v],g+=be,_e+=be<re?be:re,v++}while(--ke>0);if(g>Re&&m++,w==H.SBPSY_s){var Le=Re*D.nsPsy.shortfact[w];_e<Le&&(_e=Le)}if(K!=0?Y=_e:Y=Re,!O.ATHonly&&!O.ATHshort){var $e=q.en.s[w][xe];if($e>0){var Le;Le=g*q.thm.s[w][xe]*ne/$e,K!=0&&(Le*=D.nsPsy.shortfact[w]),Y<Le&&(Y=Le)}}K!=0?G[ee++]=Y:G[ee++]=Y*D.nsPsy.shortfact[w]}O.useTemporal&&(G[ee-3]>G[ee-3+1]&&(G[ee-3+1]+=(G[ee-3]-G[ee-3+1])*D.decay),G[ee-3+1]>G[ee-3+2]&&(G[ee-3+2]+=(G[ee-3+1]-G[ee-3+2])*D.decay))}return m};function n(O){this.s=O}this.calc_noise_core=function(O,q,Z,G){var ee=0,D=q.s,F=O.l3_enc;if(D>O.count1)for(;Z--!=0;){var v;v=O.xr[D],D++,ee+=v*v,v=O.xr[D],D++,ee+=v*v}else if(D>O.big_values){var m=S(2);for(m[0]=0,m[1]=G;Z--!=0;){var v;v=Math.abs(O.xr[D])-m[F[D]],D++,ee+=v*v,v=Math.abs(O.xr[D])-m[F[D]],D++,ee+=v*v}}else for(;Z--!=0;){var v;v=Math.abs(O.xr[D])-V[F[D]]*G,D++,ee+=v*v,v=Math.abs(O.xr[D])-V[F[D]]*G,D++,ee+=v*v}return q.s=D,ee},this.calc_noise=function(O,q,Z,G,ee){var D=0,F=0,v,m,i=0,T=0,K=0,ne=-20,g=0,Y=O.scalefac,re=0;for(G.over_SSD=0,v=0;v<O.psymax;v++){var _e=O.global_gain-(Y[re++]+(O.preflag!=0?L[v]:0)<<O.scalefac_scale+1)-O.subblock_gain[O.window[v]]*8,he=0;if(ee!=null&&ee.step[v]==_e)he=ee.noise[v],g+=O.width[v],Z[D++]=he/q[F++],he=ee.noise_log[v];else{var ke=I(_e);if(m=O.width[v]>>1,g+O.width[v]>O.max_nonzero_coeff){var Se;Se=O.max_nonzero_coeff-g+1,Se>0?m=Se>>1:m=0}var be=new n(g);he=this.calc_noise_core(O,be,m,ke),g=be.s,ee!=null&&(ee.step[v]=_e,ee.noise[v]=he),he=Z[D++]=he/q[F++],he=h.FAST_LOG10(Math.max(he,1e-20)),ee!=null&&(ee.noise_log[v]=he)}if(ee!=null&&(ee.global_gain=O.global_gain),K+=he,he>0){var Le;Le=Math.max(0|he*10+.5,1),G.over_SSD+=Le*Le,i++,T+=he}ne=Math.max(ne,he)}return G.over_count=i,G.tot_noise=K,G.over_noise=T,G.max_noise=ne,i},this.set_pinfo=function(O,q,Z,G,ee){var D=O.internal_flags,F,v,m,i,T,K=q.scalefac_scale==0?.5:1,ne=q.scalefac,g=S(L3Side.SFBMAX),Y=S(L3Side.SFBMAX),re=new CalcNoiseResult;calc_xmin(O,Z,q,g),calc_noise(q,g,Y,re,null);var _e=0;for(v=q.sfb_lmax,q.block_type!=H.SHORT_TYPE&&q.mixed_block_flag==0&&(v=22),F=0;F<v;F++){var he=D.scalefac_band.l[F],ke=D.scalefac_band.l[F+1],Se=ke-he;for(i=0;_e<ke;_e++)i+=q.xr[_e]*q.xr[_e];i/=Se,T=1e15,D.pinfo.en[G][ee][F]=T*i,D.pinfo.xfsf[G][ee][F]=T*g[F]*Y[F]/Se,Z.en.l[F]>0&&!O.ATHonly?i=i/Z.en.l[F]:i=0,D.pinfo.thr[G][ee][F]=T*Math.max(i*Z.thm.l[F],D.ATH.l[F]),D.pinfo.LAMEsfb[G][ee][F]=0,q.preflag!=0&&F>=11&&(D.pinfo.LAMEsfb[G][ee][F]=-K*L[F]),F<H.SBPSY_l&&(x(ne[F]>=0),D.pinfo.LAMEsfb[G][ee][F]-=K*ne[F])}if(q.block_type==H.SHORT_TYPE)for(v=F,F=q.sfb_smin;F<H.SBMAX_s;F++)for(var he=D.scalefac_band.s[F],ke=D.scalefac_band.s[F+1],Se=ke-he,be=0;be<3;be++){for(i=0,m=he;m<ke;m++)i+=q.xr[_e]*q.xr[_e],_e++;i=Math.max(i/Se,1e-20),T=1e15,D.pinfo.en_s[G][ee][3*F+be]=T*i,D.pinfo.xfsf_s[G][ee][3*F+be]=T*g[v]*Y[v]/Se,Z.en.s[F][be]>0?i=i/Z.en.s[F][be]:i=0,(O.ATHonly||O.ATHshort)&&(i=0),D.pinfo.thr_s[G][ee][3*F+be]=T*Math.max(i*Z.thm.s[F][be],D.ATH.s[F]),D.pinfo.LAMEsfb_s[G][ee][3*F+be]=-2*q.subblock_gain[be],F<H.SBPSY_s&&(D.pinfo.LAMEsfb_s[G][ee][3*F+be]-=K*ne[v]),v++}D.pinfo.LAMEqss[G][ee]=q.global_gain,D.pinfo.LAMEmainbits[G][ee]=q.part2_3_length+q.part2_length,D.pinfo.LAMEsfbits[G][ee]=q.part2_length,D.pinfo.over[G][ee]=re.over_count,D.pinfo.max_noise[G][ee]=re.max_noise*10,D.pinfo.over_noise[G][ee]=re.over_noise*10,D.pinfo.tot_noise[G][ee]=re.tot_noise*10,D.pinfo.over_SSD[G][ee]=re.over_SSD}}return ma=e,ma}var ba,r1;function q1(){if(r1)return ba;r1=1;var d=t0,o=d.System;d.VbrMode,d.Float,d.ShortBlock,d.Util;var t=d.Arrays;d.new_array_n,d.new_byte,d.new_double,d.new_float,d.new_float_n;var s=d.new_int;d.new_int_n;var h=d.assert,S=b0(),c=ka,x=Ia,H=G1();function $(){var y=null;this.qupvt=null,this.setModules=function(D){this.qupvt=D,y=D};function e(D){this.bits=0|D}var a=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function f(D,F,v,m,i,T){var K=.5946/F;for(h(D>0),D=D>>1;D--!=0;)i[T++]=K>v[m++]?0:1,i[T++]=K>v[m++]?0:1}function A(D,F,v,m,i,T){h(D>0),D=D>>1;var K=D%2;for(D=D>>1;D--!=0;){var ne,g,Y,re,_e,he,ke,Se;ne=v[m++]*F,g=v[m++]*F,_e=0|ne,Y=v[m++]*F,he=0|g,re=v[m++]*F,ke=0|Y,ne+=y.adj43[_e],Se=0|re,g+=y.adj43[he],i[T++]=0|ne,Y+=y.adj43[ke],i[T++]=0|g,re+=y.adj43[Se],i[T++]=0|Y,i[T++]=0|re}if(K!=0){var ne,g,_e,he;ne=v[m++]*F,g=v[m++]*F,_e=0|ne,he=0|g,ne+=y.adj43[_e],g+=y.adj43[he],i[T++]=0|ne,i[T++]=0|g}}function k(D,F,v,m,i){var T,K,ne=0,g,Y=0,re=0,_e=0,he=F,ke=0,Se=he,be=0,Le=D,$e=0;for(g=i!=null&&m.global_gain==i.global_gain,m.block_type==S.SHORT_TYPE?K=38:K=21,T=0;T<=K;T++){var c0=-1;if((g||m.block_type==S.NORM_TYPE)&&(c0=m.global_gain-(m.scalefac[T]+(m.preflag!=0?y.pretab[T]:0)<<m.scalefac_scale+1)-m.subblock_gain[m.window[T]]*8),h(m.width[T]>=0),g&&i.step[T]==c0)Y!=0&&(A(Y,v,Le,$e,Se,be),Y=0),re!=0&&(f(re,v,Le,$e,Se,be),re=0);else{var _=m.width[T];if(ne+m.width[T]>m.max_nonzero_coeff){var w;w=m.max_nonzero_coeff-ne+1,t.fill(F,m.max_nonzero_coeff,576,0),_=w,_<0&&(_=0),T=K+1}if(Y==0&&re==0&&(Se=he,be=ke,Le=D,$e=_e),i!=null&&i.sfb_count1>0&&T>=i.sfb_count1&&i.step[T]>0&&c0>=i.step[T]?(Y!=0&&(A(Y,v,Le,$e,Se,be),Y=0,Se=he,be=ke,Le=D,$e=_e),re+=_):(re!=0&&(f(re,v,Le,$e,Se,be),re=0,Se=he,be=ke,Le=D,$e=_e),Y+=_),_<=0){re!=0&&(f(re,v,Le,$e,Se,be),re=0),Y!=0&&(A(Y,v,Le,$e,Se,be),Y=0);break}}T<=K&&(ke+=m.width[T],_e+=m.width[T],ne+=m.width[T])}Y!=0&&(A(Y,v,Le,$e,Se,be),Y=0),re!=0&&(f(re,v,Le,$e,Se,be),re=0)}function I(D,F,v){var m=0,i=0;do{var T=D[F++],K=D[F++];m<T&&(m=T),i<K&&(i=K)}while(F<v);return m<i&&(m=i),m}function u(D,F,v,m,i,T){var K=c.ht[m].xlen*65536+c.ht[i].xlen,ne=0,g;do{var Y=D[F++],re=D[F++];Y!=0&&(Y>14&&(Y=15,ne+=K),Y*=16),re!=0&&(re>14&&(re=15,ne+=K),Y+=re),ne+=c.largetbl[Y]}while(F<v);return g=ne&65535,ne>>=16,ne>g&&(ne=g,m=i),T.bits+=ne,m}function l(D,F,v,m){var i=0,T=c.ht[1].hlen;do{var K=D[F+0]*2+D[F+1];F+=2,i+=T[K]}while(F<v);return m.bits+=i,1}function b(D,F,v,m,i){var T=0,K,ne=c.ht[m].xlen,g;m==2?g=c.table23:g=c.table56;do{var Y=D[F+0]*ne+D[F+1];F+=2,T+=g[Y]}while(F<v);return K=T&65535,T>>=16,T>K&&(T=K,m++),i.bits+=T,m}function M(D,F,v,m,i){var T=0,K=0,ne=0,g=c.ht[m].xlen,Y=c.ht[m].hlen,re=c.ht[m+1].hlen,_e=c.ht[m+2].hlen;do{var he=D[F+0]*g+D[F+1];F+=2,T+=Y[he],K+=re[he],ne+=_e[he]}while(F<v);var ke=m;return T>K&&(T=K,ke++),T>ne&&(T=ne,ke=m+2),i.bits+=T,ke}var r=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function p(D,F,v,m){var i=I(D,F,v);switch(i){case 0:return i;case 1:return l(D,F,v,m);case 2:case 3:return b(D,F,v,r[i-1],m);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return M(D,F,v,r[i-1],m);default:if(i>H.IXMAX_VAL)return m.bits=H.LARGE_BITS,-1;i-=15;var T;for(T=24;T<32&&!(c.ht[T].linmax>=i);T++);var K;for(K=T-8;K<24&&!(c.ht[K].linmax>=i);K++);return u(D,F,v,K,T,m)}}this.noquant_count_bits=function(D,F,v){var m=F.l3_enc,i=Math.min(576,F.max_nonzero_coeff+2>>1<<1);for(v!=null&&(v.sfb_count1=0);i>1&&!(m[i-1]|m[i-2]);i-=2);F.count1=i;for(var T=0,K=0;i>3;i-=4){var ne;if(((m[i-1]|m[i-2]|m[i-3]|m[i-4])&2147483647)>1)break;ne=((m[i-4]*2+m[i-3])*2+m[i-2])*2+m[i-1],T+=c.t32l[ne],K+=c.t33l[ne]}var g=T;if(F.count1table_select=0,T>K&&(g=K,F.count1table_select=1),F.count1bits=g,F.big_values=i,i==0)return g;if(F.block_type==S.SHORT_TYPE)T=3*D.scalefac_band.s[3],T>F.big_values&&(T=F.big_values),K=F.big_values;else if(F.block_type==S.NORM_TYPE){if(h(i<=576),T=F.region0_count=D.bv_scf[i-2],K=F.region1_count=D.bv_scf[i-1],h(T+K+2<S.SBPSY_l),K=D.scalefac_band.l[T+K+2],T=D.scalefac_band.l[T+1],K<i){var Y=new e(g);F.table_select[2]=p(m,K,i,Y),g=Y.bits}}else F.region0_count=7,F.region1_count=S.SBMAX_l-1-7-1,T=D.scalefac_band.l[7+1],K=i,T>K&&(T=K);if(T=Math.min(T,i),K=Math.min(K,i),h(T>=0),h(K>=0),0<T){var Y=new e(g);F.table_select[0]=p(m,0,T,Y),g=Y.bits}if(T<K){var Y=new e(g);F.table_select[1]=p(m,T,K,Y),g=Y.bits}if(D.use_best_huffman==2&&(F.part2_3_length=g,best_huffman_divide(D,F),g=F.part2_3_length),v!=null&&F.block_type==S.NORM_TYPE){for(var re=0;D.scalefac_band.l[re]<F.big_values;)re++;v.sfb_count1=re}return g},this.count_bits=function(D,F,v,m){var i=v.l3_enc,T=H.IXMAX_VAL/y.IPOW20(v.global_gain);if(v.xrpow_max>T)return H.LARGE_BITS;if(k(F,i,y.IPOW20(v.global_gain),v,m),D.substep_shaping&2)for(var K=0,ne=v.global_gain+v.scalefac_scale,g=.634521682242439/y.IPOW20(ne),Y=0;Y<v.sfbmax;Y++){var re=v.width[Y];if(h(re>=0),D.pseudohalf[Y]==0)K+=re;else{var _e;for(_e=K,K+=re;_e<K;++_e)i[_e]=F[_e]>=g?i[_e]:0}}return this.noquant_count_bits(D,v,m)};function L(D,F,v,m,i,T,K){for(var ne=F.big_values,g=0;g<=7+15;g++)m[g]=H.LARGE_BITS;for(var g=0;g<16;g++){var Y=D.scalefac_band.l[g+1];if(Y>=ne)break;var re=0,_e=new e(re),he=p(v,0,Y,_e);re=_e.bits;for(var ke=0;ke<8;ke++){var Se=D.scalefac_band.l[g+ke+2];if(Se>=ne)break;var be=re;_e=new e(be);var Le=p(v,Y,Se,_e);be=_e.bits,m[g+ke]>be&&(m[g+ke]=be,i[g+ke]=g,T[g+ke]=he,K[g+ke]=Le)}}}function P(D,F,v,m,i,T,K,ne){for(var g=F.big_values,Y=2;Y<S.SBMAX_l+1;Y++){var re=D.scalefac_band.l[Y];if(re>=g)break;var _e=i[Y-2]+F.count1bits;if(v.part2_3_length<=_e)break;var he=new e(_e),ke=p(m,re,g,he);_e=he.bits,!(v.part2_3_length<=_e)&&(v.assign(F),v.part2_3_length=_e,v.region0_count=T[Y-2],v.region1_count=Y-2-T[Y-2],v.table_select[0]=K[Y-2],v.table_select[1]=ne[Y-2],v.table_select[2]=ke)}}this.best_huffman_divide=function(D,F){var v=new x,m=F.l3_enc,i=s(7+15+1),T=s(7+15+1),K=s(7+15+1),ne=s(7+15+1);if(!(F.block_type==S.SHORT_TYPE&&D.mode_gr==1)){v.assign(F),F.block_type==S.NORM_TYPE&&(L(D,F,m,i,T,K,ne),P(D,v,F,m,i,T,K,ne));var g=v.big_values;if(!(g==0||(m[g-2]|m[g-1])>1)&&(g=F.count1+2,!(g>576))){v.assign(F),v.count1=g;var Y=0,re=0;for(h(g<=576);g>v.big_values;g-=4){var _e=((m[g-4]*2+m[g-3])*2+m[g-2])*2+m[g-1];Y+=c.t32l[_e],re+=c.t33l[_e]}if(v.big_values=g,v.count1table_select=0,Y>re&&(Y=re,v.count1table_select=1),v.count1bits=Y,v.block_type==S.NORM_TYPE)P(D,v,F,m,i,T,K,ne);else{if(v.part2_3_length=Y,Y=D.scalefac_band.l[7+1],Y>g&&(Y=g),Y>0){var he=new e(v.part2_3_length);v.table_select[0]=p(m,0,Y,he),v.part2_3_length=he.bits}if(g>Y){var he=new e(v.part2_3_length);v.table_select[1]=p(m,Y,g,he),v.part2_3_length=he.bits}F.part2_3_length>v.part2_3_length&&F.assign(v)}}}};var N=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],V=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],Q=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],j=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];$.slen1_tab=Q,$.slen2_tab=j;function B(D,F){for(var v,m=F.tt[1][D],i=F.tt[0][D],T=0;T<c.scfsi_band.length-1;T++){for(v=c.scfsi_band[T];v<c.scfsi_band[T+1]&&!(i.scalefac[v]!=m.scalefac[v]&&m.scalefac[v]>=0);v++);if(v==c.scfsi_band[T+1]){for(v=c.scfsi_band[T];v<c.scfsi_band[T+1];v++)m.scalefac[v]=-1;F.scfsi[D][T]=1}}var K=0,ne=0;for(v=0;v<11;v++)m.scalefac[v]!=-1&&(ne++,K<m.scalefac[v]&&(K=m.scalefac[v]));for(var g=0,Y=0;v<S.SBPSY_l;v++)m.scalefac[v]!=-1&&(Y++,g<m.scalefac[v]&&(g=m.scalefac[v]));for(var T=0;T<16;T++)if(K<N[T]&&g<V[T]){var re=Q[T]*ne+j[T]*Y;m.part2_length>re&&(m.part2_length=re,m.scalefac_compress=T)}}this.best_scalefac_store=function(D,F,v,m){var i=m.tt[F][v],T,K,ne,g,Y=0;for(ne=0,T=0;T<i.sfbmax;T++){var re=i.width[T];for(h(re>=0),ne+=re,g=-re;g<0&&i.l3_enc[g+ne]==0;g++);g==0&&(i.scalefac[T]=Y=-2)}if(i.scalefac_scale==0&&i.preflag==0){var _e=0;for(T=0;T<i.sfbmax;T++)i.scalefac[T]>0&&(_e|=i.scalefac[T]);if(!(_e&1)&&_e!=0){for(T=0;T<i.sfbmax;T++)i.scalefac[T]>0&&(i.scalefac[T]>>=1);i.scalefac_scale=Y=1}}if(i.preflag==0&&i.block_type!=S.SHORT_TYPE&&D.mode_gr==2){for(T=11;T<S.SBPSY_l&&!(i.scalefac[T]<y.pretab[T]&&i.scalefac[T]!=-2);T++);if(T==S.SBPSY_l){for(T=11;T<S.SBPSY_l;T++)i.scalefac[T]>0&&(i.scalefac[T]-=y.pretab[T]);i.preflag=Y=1}}for(K=0;K<4;K++)m.scfsi[v][K]=0;for(D.mode_gr==2&&F==1&&m.tt[0][v].block_type!=S.SHORT_TYPE&&m.tt[1][v].block_type!=S.SHORT_TYPE&&(B(v,m),Y=0),T=0;T<i.sfbmax;T++)i.scalefac[T]==-2&&(i.scalefac[T]=0);Y!=0&&(D.mode_gr==2?this.scale_bitcount(i):this.scale_bitcount_lsf(D,i))};function n(D,F){for(var v=0;v<F;++v)if(D[v]<0)return!1;return!0}var O=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],q=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],Z=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(D){var F,v,m=0,i=0,T,K=D.scalefac;if(h(n(K,D.sfbmax)),D.block_type==S.SHORT_TYPE)T=O,D.mixed_block_flag!=0&&(T=q);else if(T=Z,D.preflag==0){for(v=11;v<S.SBPSY_l&&!(K[v]<y.pretab[v]);v++);if(v==S.SBPSY_l)for(D.preflag=1,v=11;v<S.SBPSY_l;v++)K[v]-=y.pretab[v]}for(v=0;v<D.sfbdivide;v++)m<K[v]&&(m=K[v]);for(;v<D.sfbmax;v++)i<K[v]&&(i=K[v]);for(D.part2_length=H.LARGE_BITS,F=0;F<16;F++)m<N[F]&&i<V[F]&&D.part2_length>T[F]&&(D.part2_length=T[F],D.scalefac_compress=F);return D.part2_length==H.LARGE_BITS};var G=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(D,F){var v,m,i,T,K,ne,g,Y,re=s(4),_e=F.scalefac;for(F.preflag!=0?v=2:v=0,g=0;g<4;g++)re[g]=0;if(F.block_type==S.SHORT_TYPE){m=1;var he=y.nr_of_sfb_block[v][m];for(Y=0,i=0;i<4;i++)for(T=he[i]/3,g=0;g<T;g++,Y++)for(K=0;K<3;K++)_e[Y*3+K]>re[i]&&(re[i]=_e[Y*3+K])}else{m=0;var he=y.nr_of_sfb_block[v][m];for(Y=0,i=0;i<4;i++)for(T=he[i],g=0;g<T;g++,Y++)_e[Y]>re[i]&&(re[i]=_e[Y])}for(ne=!1,i=0;i<4;i++)re[i]>G[v][i]&&(ne=!0);if(!ne){var ke,Se,be,Le;for(F.sfb_partition_table=y.nr_of_sfb_block[v][m],i=0;i<4;i++)F.slen[i]=ee[re[i]];switch(ke=F.slen[0],Se=F.slen[1],be=F.slen[2],Le=F.slen[3],v){case 0:F.scalefac_compress=(ke*5+Se<<4)+(be<<2)+Le;break;case 1:F.scalefac_compress=400+(ke*5+Se<<2)+be;break;case 2:F.scalefac_compress=500+ke*3+Se;break;default:o.err.printf(`intensity stereo not implemented yet
`);break}}if(!ne)for(h(F.sfb_partition_table!=null),F.part2_length=0,i=0;i<4;i++)F.part2_length+=F.slen[i]*F.sfb_partition_table[i];return ne};var ee=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(D){for(var F=2;F<=576;F+=2){for(var v=0,m;D.scalefac_band.l[++v]<F;);for(m=a[v][0];D.scalefac_band.l[m+1]>F;)m--;for(m<0&&(m=a[v][0]),D.bv_scf[F-2]=m,m=a[v][1];D.scalefac_band.l[m+D.bv_scf[F-2]+2]>F;)m--;m<0&&(m=a[v][1]),D.bv_scf[F-1]=m}}}return ba=$,ba}var pa,n1;function La(){if(n1)return pa;n1=1;var d=t0,o=d.System;d.VbrMode,d.Float,d.ShortBlock,d.Util;var t=d.Arrays;d.new_array_n;var s=d.new_byte;d.new_double,d.new_float;var h=d.new_float_n,S=d.new_int;d.new_int_n;var c=d.assert,x=q1(),H=ka,$=b0(),y=gt;e.EQ=function(a,f){return Math.abs(a)>Math.abs(f)?Math.abs(a-f)<=Math.abs(a)*1e-6:Math.abs(a-f)<=Math.abs(f)*1e-6},e.NEQ=function(a,f){return!e.EQ(a,f)};function e(){var a=Ca(),f=this,A=32773,k=32,I=null,u=null,l=null,b=null;this.setModules=function(v,m,i,T){I=v,u=m,l=i,b=T};var M=null,r=0,p=0,L=0;this.getframebits=function(v){var m=v.internal_flags,i;m.bitrate_index!=0?i=H.bitrate_table[v.version][m.bitrate_index]:i=v.brate,c(8<=i&&i<=640);var T=0|(v.version+1)*72e3*i/v.out_samplerate+m.padding;return 8*T};function P(v){o.arraycopy(v.header[v.w_ptr].buf,0,M,p,v.sideinfo_len),p+=v.sideinfo_len,r+=v.sideinfo_len*8,v.w_ptr=v.w_ptr+1&y.MAX_HEADER_BUF-1}function N(v,m,i){for(c(i<k-2);i>0;){var T;L==0&&(L=8,p++,c(p<a.LAME_MAXMP3BUFFER),c(v.header[v.w_ptr].write_timing>=r),v.header[v.w_ptr].write_timing==r&&P(v),M[p]=0),T=Math.min(i,L),i-=T,L-=T,c(i<k),c(L<k),M[p]|=m>>i<<L,r+=T}}function V(v,m,i){for(c(i<k-2);i>0;){var T;L==0&&(L=8,p++,c(p<a.LAME_MAXMP3BUFFER),M[p]=0),T=Math.min(i,L),i-=T,L-=T,c(i<k),c(L<k),M[p]|=m>>i<<L,r+=T}}function Q(v,m){var i=v.internal_flags,T;if(c(m>=0),m>=8&&(N(i,76,8),m-=8),m>=8&&(N(i,65,8),m-=8),m>=8&&(N(i,77,8),m-=8),m>=8&&(N(i,69,8),m-=8),m>=32){var K=l.getLameShortVersion();if(m>=32)for(T=0;T<K.length&&m>=8;++T)m-=8,N(i,K.charAt(T),8)}for(;m>=1;m-=1)N(i,i.ancillary_flag,1),i.ancillary_flag^=v.disable_reservoir?0:1;c(m==0)}function j(v,m,i){for(var T=v.header[v.h_ptr].ptr;i>0;){var K=Math.min(i,8-(T&7));i-=K,c(i<k),v.header[v.h_ptr].buf[T>>3]|=m>>i<<8-(T&7)-K,T+=K}v.header[v.h_ptr].ptr=T}function B(v,m){v<<=8;for(var i=0;i<8;i++)v<<=1,m<<=1,(m^v)&65536&&(m^=A);return m}this.CRC_writeheader=function(v,m){var i=65535;i=B(m[2]&255,i),i=B(m[3]&255,i);for(var T=6;T<v.sideinfo_len;T++)i=B(m[T]&255,i);m[4]=byte(i>>8),m[5]=byte(i&255)};function n(v,m){var i=v.internal_flags,T,K,ne;if(T=i.l3_side,i.header[i.h_ptr].ptr=0,t.fill(i.header[i.h_ptr].buf,0,i.sideinfo_len,0),v.out_samplerate<16e3?j(i,4094,12):j(i,4095,12),j(i,v.version,1),j(i,4-3,2),j(i,v.error_protection?0:1,1),j(i,i.bitrate_index,4),j(i,i.samplerate_index,2),j(i,i.padding,1),j(i,v.extension,1),j(i,v.mode.ordinal(),2),j(i,i.mode_ext,2),j(i,v.copyright,1),j(i,v.original,1),j(i,v.emphasis,2),v.error_protection&&j(i,0,16),v.version==1){for(c(T.main_data_begin>=0),j(i,T.main_data_begin,9),i.channels_out==2?j(i,T.private_bits,3):j(i,T.private_bits,5),ne=0;ne<i.channels_out;ne++){var g;for(g=0;g<4;g++)j(i,T.scfsi[ne][g],1)}for(K=0;K<2;K++)for(ne=0;ne<i.channels_out;ne++){var Y=T.tt[K][ne];j(i,Y.part2_3_length+Y.part2_length,12),j(i,Y.big_values/2,9),j(i,Y.global_gain,8),j(i,Y.scalefac_compress,4),Y.block_type!=$.NORM_TYPE?(j(i,1,1),j(i,Y.block_type,2),j(i,Y.mixed_block_flag,1),Y.table_select[0]==14&&(Y.table_select[0]=16),j(i,Y.table_select[0],5),Y.table_select[1]==14&&(Y.table_select[1]=16),j(i,Y.table_select[1],5),j(i,Y.subblock_gain[0],3),j(i,Y.subblock_gain[1],3),j(i,Y.subblock_gain[2],3)):(j(i,0,1),Y.table_select[0]==14&&(Y.table_select[0]=16),j(i,Y.table_select[0],5),Y.table_select[1]==14&&(Y.table_select[1]=16),j(i,Y.table_select[1],5),Y.table_select[2]==14&&(Y.table_select[2]=16),j(i,Y.table_select[2],5),c(0<=Y.region0_count&&Y.region0_count<16),c(0<=Y.region1_count&&Y.region1_count<8),j(i,Y.region0_count,4),j(i,Y.region1_count,3)),j(i,Y.preflag,1),j(i,Y.scalefac_scale,1),j(i,Y.count1table_select,1)}}else for(c(T.main_data_begin>=0),j(i,T.main_data_begin,8),j(i,T.private_bits,i.channels_out),K=0,ne=0;ne<i.channels_out;ne++){var Y=T.tt[K][ne];j(i,Y.part2_3_length+Y.part2_length,12),j(i,Y.big_values/2,9),j(i,Y.global_gain,8),j(i,Y.scalefac_compress,9),Y.block_type!=$.NORM_TYPE?(j(i,1,1),j(i,Y.block_type,2),j(i,Y.mixed_block_flag,1),Y.table_select[0]==14&&(Y.table_select[0]=16),j(i,Y.table_select[0],5),Y.table_select[1]==14&&(Y.table_select[1]=16),j(i,Y.table_select[1],5),j(i,Y.subblock_gain[0],3),j(i,Y.subblock_gain[1],3),j(i,Y.subblock_gain[2],3)):(j(i,0,1),Y.table_select[0]==14&&(Y.table_select[0]=16),j(i,Y.table_select[0],5),Y.table_select[1]==14&&(Y.table_select[1]=16),j(i,Y.table_select[1],5),Y.table_select[2]==14&&(Y.table_select[2]=16),j(i,Y.table_select[2],5),c(0<=Y.region0_count&&Y.region0_count<16),c(0<=Y.region1_count&&Y.region1_count<8),j(i,Y.region0_count,4),j(i,Y.region1_count,3)),j(i,Y.scalefac_scale,1),j(i,Y.count1table_select,1)}v.error_protection&&CRC_writeheader(i,i.header[i.h_ptr].buf);{var re=i.h_ptr;c(i.header[re].ptr==i.sideinfo_len*8),i.h_ptr=re+1&y.MAX_HEADER_BUF-1,i.header[i.h_ptr].write_timing=i.header[re].write_timing+m,i.h_ptr==i.w_ptr&&o.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function O(v,m){var i=H.ht[m.count1table_select+32],T,K=0,ne=m.big_values,g=m.big_values;for(c(m.count1table_select<2),T=(m.count1-m.big_values)/4;T>0;--T){var Y=0,re=0,_e;_e=m.l3_enc[ne+0],_e!=0&&(re+=8,m.xr[g+0]<0&&Y++,c(_e<=1)),_e=m.l3_enc[ne+1],_e!=0&&(re+=4,Y*=2,m.xr[g+1]<0&&Y++,c(_e<=1)),_e=m.l3_enc[ne+2],_e!=0&&(re+=2,Y*=2,m.xr[g+2]<0&&Y++,c(_e<=1)),_e=m.l3_enc[ne+3],_e!=0&&(re++,Y*=2,m.xr[g+3]<0&&Y++,c(_e<=1)),ne+=4,g+=4,N(v,Y+i.table[re],i.hlen[re]),K+=i.hlen[re]}return K}function q(v,m,i,T,K){var ne=H.ht[m],g=0;if(c(m<32),m==0)return g;for(var Y=i;Y<T;Y+=2){var re=0,_e=0,he=ne.xlen,ke=ne.xlen,Se=0,be=K.l3_enc[Y],Le=K.l3_enc[Y+1];if(be!=0&&(K.xr[Y]<0&&Se++,re--),m>15){if(be>14){var $e=be-15;c($e<=ne.linmax),Se|=$e<<1,_e=he,be=15}if(Le>14){var c0=Le-15;c(c0<=ne.linmax),Se<<=he,Se|=c0,_e+=he,Le=15}ke=16}Le!=0&&(Se<<=1,K.xr[Y+1]<0&&Se++,re--),c((be|Le)<16),be=be*ke+Le,_e-=re,re+=ne.hlen[be],c(re<=k),c(_e<=k),N(v,ne.table[be],re),N(v,Se,_e),g+=re+_e}return g}function Z(v,m){var i=3*v.scalefac_band.s[3];i>m.big_values&&(i=m.big_values);var T=q(v,m.table_select[0],0,i,m);return T+=q(v,m.table_select[1],i,m.big_values,m),T}function G(v,m){var i,T,K,ne;i=m.big_values,c(0<=i&&i<=576);var g=m.region0_count+1;return c(0<=g),c(g<v.scalefac_band.l.length),K=v.scalefac_band.l[g],g+=m.region1_count+1,c(0<=g),c(g<v.scalefac_band.l.length),ne=v.scalefac_band.l[g],K>i&&(K=i),ne>i&&(ne=i),T=q(v,m.table_select[0],0,K,m),T+=q(v,m.table_select[1],K,ne,m),T+=q(v,m.table_select[2],ne,i,m),T}function ee(v){var m,i,T,K,ne=0,g=v.internal_flags,Y=g.l3_side;if(v.version==1)for(m=0;m<2;m++)for(i=0;i<g.channels_out;i++){var re=Y.tt[m][i],_e=x.slen1_tab[re.scalefac_compress],he=x.slen2_tab[re.scalefac_compress];for(K=0,T=0;T<re.sfbdivide;T++)re.scalefac[T]!=-1&&(N(g,re.scalefac[T],_e),K+=_e);for(;T<re.sfbmax;T++)re.scalefac[T]!=-1&&(N(g,re.scalefac[T],he),K+=he);c(K==re.part2_length),re.block_type==$.SHORT_TYPE?K+=Z(g,re):K+=G(g,re),K+=O(g,re),c(K==re.part2_3_length+re.part2_length),ne+=K}else for(m=0,i=0;i<g.channels_out;i++){var re=Y.tt[m][i],ke,Se,be=0;if(c(re.sfb_partition_table!=null),K=0,T=0,Se=0,re.block_type==$.SHORT_TYPE){for(;Se<4;Se++){var Le=re.sfb_partition_table[Se]/3,$e=re.slen[Se];for(ke=0;ke<Le;ke++,T++)N(g,Math.max(re.scalefac[T*3+0],0),$e),N(g,Math.max(re.scalefac[T*3+1],0),$e),N(g,Math.max(re.scalefac[T*3+2],0),$e),be+=3*$e}K+=Z(g,re)}else{for(;Se<4;Se++){var Le=re.sfb_partition_table[Se],$e=re.slen[Se];for(ke=0;ke<Le;ke++,T++)N(g,Math.max(re.scalefac[T],0),$e),be+=$e}K+=G(g,re)}K+=O(g,re),c(K==re.part2_3_length),c(be==re.part2_length),ne+=be+K}return ne}function D(){this.total=0}function F(v,m){var i=v.internal_flags,T,K,ne,g,Y;return Y=i.w_ptr,g=i.h_ptr-1,g==-1&&(g=y.MAX_HEADER_BUF-1),T=i.header[g].write_timing-r,m.total=T,T>=0&&(K=1+g-Y,g<Y&&(K=1+g-Y+y.MAX_HEADER_BUF),T-=K*8*i.sideinfo_len),ne=f.getframebits(v),T+=ne,m.total+=ne,m.total%8!=0?m.total=1+m.total/8:m.total=m.total/8,m.total+=p+1,T<0&&o.err.println(`strange error flushing buffer ... 
`),T}this.flush_bitstream=function(v){var m=v.internal_flags,i,T,K=m.h_ptr-1;if(K==-1&&(K=y.MAX_HEADER_BUF-1),i=m.l3_side,!((T=F(v,new D))<0)){if(Q(v,T),c(m.header[K].write_timing+this.getframebits(v)==r),m.ResvSize=0,i.main_data_begin=0,m.findReplayGain){var ne=I.GetTitleGain(m.rgdata);c(NEQ(ne,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),m.RadioGain=Math.floor(ne*10+.5)|0}m.findPeakSample&&(m.noclipGainChange=Math.ceil(Math.log10(m.PeakSample/32767)*20*10)|0,m.noclipGainChange>0&&(EQ(v.scale,1)||EQ(v.scale,0))?m.noclipScale=Math.floor(32767/m.PeakSample*100)/100:m.noclipScale=-1)}},this.add_dummy_byte=function(v,m,i){for(var T=v.internal_flags,K;i-- >0;)for(V(T,m,8),K=0;K<y.MAX_HEADER_BUF;++K)T.header[K].write_timing+=8},this.format_bitstream=function(v){var m=v.internal_flags,i;i=m.l3_side;var T=this.getframebits(v);Q(v,i.resvDrain_pre),n(v,T);var K=8*m.sideinfo_len;if(K+=ee(v),Q(v,i.resvDrain_post),K+=i.resvDrain_post,i.main_data_begin+=(T-K)/8,F(v,new D)!=m.ResvSize&&o.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),i.main_data_begin*8!=m.ResvSize&&(o.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*i.main_data_begin,m.ResvSize,i.resvDrain_post,i.resvDrain_pre,8*m.sideinfo_len,K-i.resvDrain_post-8*m.sideinfo_len,K,K%8,T),o.err.println("This is a fatal error.  It has several possible causes:"),o.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),o.err.println(" 9%%  Your system is overclocked"),o.err.println(" 1%%  bug in LAME encoding library"),m.ResvSize=i.main_data_begin*8),c(r%8==0),r>1e9){var ne;for(ne=0;ne<y.MAX_HEADER_BUF;++ne)m.header[ne].write_timing-=r;r=0}return 0},this.copy_buffer=function(v,m,i,T,K){var ne=p+1;if(ne<=0)return 0;if(T!=0&&ne>T)return-1;if(o.arraycopy(M,0,m,i,ne),p=-1,L=0,K!=0){var g=S(1);if(g[0]=v.nMusicCRC,b.updateMusicCRC(g,m,i,ne),v.nMusicCRC=g[0],ne>0&&(v.VBR_seek_table.nBytesWritten+=ne),v.decode_on_the_fly){for(var Y=h([2,1152]),re=ne,_e=-1,he;_e!=0;)if(_e=u.hip_decode1_unclipped(v.hip,m,i,re,Y[0],Y[1]),re=0,_e==-1&&(_e=0),_e>0){if(c(_e<=1152),v.findPeakSample){for(he=0;he<_e;he++)Y[0][he]>v.PeakSample?v.PeakSample=Y[0][he]:-Y[0][he]>v.PeakSample&&(v.PeakSample=-Y[0][he]);if(v.channels_out>1)for(he=0;he<_e;he++)Y[1][he]>v.PeakSample?v.PeakSample=Y[1][he]:-Y[1][he]>v.PeakSample&&(v.PeakSample=-Y[1][he])}if(v.findReplayGain&&I.AnalyzeSamples(v.rgdata,Y[0],0,Y[1],0,_e,v.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return ne},this.init_bit_stream_w=function(v){M=s(a.LAME_MAXMP3BUFFER),v.h_ptr=v.w_ptr=0,v.header[v.h_ptr].write_timing=0,p=-1,L=0,r=0}}return pa=e,pa}var Aa,i1;function Ca(){if(i1)return Aa;i1=1;var d=t0,o=d.System,t=d.VbrMode;d.Float;var s=d.ShortBlock;d.Util,d.Arrays,d.new_array_n,d.new_byte,d.new_double;var h=d.new_float;d.new_float_n,d.new_int;var S=d.new_int_n,c=d.new_short_n,x=d.assert,H=_r,$=vr,y=gt,e=Hr,a=Nr,f=Yr,A=La(),k=ka,I=b0();function u(){var l=Ct,b=this,M=128*1024;u.V9=410,u.V8=420,u.V7=430,u.V6=440,u.V5=450,u.V4=460,u.V3=470,u.V2=480,u.V1=490,u.V0=500,u.R3MIX=1e3,u.STANDARD=1001,u.EXTREME=1002,u.INSANE=1003,u.STANDARD_FAST=1004,u.EXTREME_FAST=1005,u.MEDIUM=1006,u.MEDIUM_FAST=1007;var r=16384+M;u.LAME_MAXMP3BUFFER=r;var p,L,P,N,V,Q=new H,j,B,n;this.enc=new I,this.setModules=function(_,w,xe,Re,Xe,Fe,Ie,Be,Pe){p=_,L=w,P=xe,N=Re,V=Xe,j=Fe,B=Be,n=Pe,this.enc.setModules(L,Q,N,j)};function O(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=h(I.SBMAX_l),this.bo_s_weight=h(I.SBMAX_s)}function q(){this.lowerlimit=0}function Z(_,w){this.lowpass=w}var G=4294479419;function ee(_){var w;return _.class_id=G,w=_.internal_flags=new y,_.mode=l.NOT_SET,_.original=1,_.in_samplerate=44100,_.num_channels=2,_.num_samples=-1,_.bWriteVbrTag=!0,_.quality=-1,_.short_blocks=null,w.subblock_gain=-1,_.lowpassfreq=0,_.highpassfreq=0,_.lowpasswidth=-1,_.highpasswidth=-1,_.VBR=t.vbr_off,_.VBR_q=4,_.ATHcurve=-1,_.VBR_mean_bitrate_kbps=128,_.VBR_min_bitrate_kbps=0,_.VBR_max_bitrate_kbps=0,_.VBR_hard_min=0,w.VBR_min_bitrate=1,w.VBR_max_bitrate=13,_.quant_comp=-1,_.quant_comp_short=-1,_.msfix=-1,w.resample_ratio=1,w.OldValue[0]=180,w.OldValue[1]=180,w.CurrentStep[0]=4,w.CurrentStep[1]=4,w.masking_lower=1,w.nsPsy.attackthre=-1,w.nsPsy.attackthre_s=-1,_.scale=-1,_.athaa_type=-1,_.ATHtype=-1,_.athaa_loudapprox=-1,_.athaa_sensitivity=0,_.useTemporal=null,_.interChRatio=-1,w.mf_samples_to_encode=I.ENCDELAY+I.POSTDELAY,_.encoder_padding=0,w.mf_size=I.ENCDELAY-I.MDCTDELAY,_.findReplayGain=!1,_.decode_on_the_fly=!1,w.decode_on_the_fly=!1,w.findReplayGain=!1,w.findPeakSample=!1,w.RadioGain=0,w.AudiophileGain=0,w.noclipGainChange=0,w.noclipScale=-1,_.preset=0,_.write_id3tag_automatic=!0,0}this.lame_init=function(){var _=new $;return ee(_),_.lame_allocated_gfp=1,_};function D(_){return _>1?0:_<=0?1:Math.cos(Math.PI/2*_)}this.nearestBitrateFullIndex=function(_){var w=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],xe=0,Re=0,Xe=0,Fe=0;Fe=w[16],Xe=16,Re=w[16],xe=16;for(var Ie=0;Ie<16;Ie++)if(Math.max(_,w[Ie+1])!=_){Fe=w[Ie+1],Xe=Ie+1,Re=w[Ie],xe=Ie;break}return Fe-_>_-Re?xe:Xe};function F(_,w){var xe=44100;return w>=48e3?xe=48e3:w>=44100?xe=44100:w>=32e3?xe=32e3:w>=24e3?xe=24e3:w>=22050?xe=22050:w>=16e3?xe=16e3:w>=12e3?xe=12e3:w>=11025?xe=11025:w>=8e3&&(xe=8e3),_==-1?xe:(_<=15960&&(xe=44100),_<=15250&&(xe=32e3),_<=11220&&(xe=24e3),_<=9970&&(xe=22050),_<=7230&&(xe=16e3),_<=5420&&(xe=12e3),_<=4510&&(xe=11025),_<=3970&&(xe=8e3),w<xe?w>44100?48e3:w>32e3?44100:w>24e3?32e3:w>22050?24e3:w>16e3?22050:w>12e3?16e3:w>11025?12e3:w>8e3?11025:8e3:xe)}function v(_,w){switch(_){case 44100:return w.version=1,0;case 48e3:return w.version=1,1;case 32e3:return w.version=1,2;case 22050:return w.version=0,0;case 24e3:return w.version=0,1;case 16e3:return w.version=0,2;case 11025:return w.version=0,0;case 12e3:return w.version=0,1;case 8e3:return w.version=0,2;default:return w.version=0,-1}}function m(_,w,xe){xe<16e3&&(w=2);for(var Re=k.bitrate_table[w][1],Xe=2;Xe<=14;Xe++)k.bitrate_table[w][Xe]>0&&Math.abs(k.bitrate_table[w][Xe]-_)<Math.abs(Re-_)&&(Re=k.bitrate_table[w][Xe]);return Re}function i(_,w,xe){xe<16e3&&(w=2);for(var Re=0;Re<=14;Re++)if(k.bitrate_table[w][Re]>0&&k.bitrate_table[w][Re]==_)return Re;return-1}function T(_,w){var xe=[new Z(8,2e3),new Z(16,3700),new Z(24,3900),new Z(32,5500),new Z(40,7e3),new Z(48,7500),new Z(56,1e4),new Z(64,11e3),new Z(80,13500),new Z(96,15100),new Z(112,15600),new Z(128,17e3),new Z(160,17500),new Z(192,18600),new Z(224,19400),new Z(256,19700),new Z(320,20500)],Re=b.nearestBitrateFullIndex(w);_.lowerlimit=xe[Re].lowpass}function K(_){var w=_.internal_flags,xe=32,Re=-1;if(w.lowpass1>0){for(var Xe=999,Fe=0;Fe<=31;Fe++){var Ie=Fe/31;Ie>=w.lowpass2&&(xe=Math.min(xe,Fe)),w.lowpass1<Ie&&Ie<w.lowpass2&&(Xe=Math.min(Xe,Fe))}Xe==999?w.lowpass1=(xe-.75)/31:w.lowpass1=(Xe-.75)/31,w.lowpass2=xe/31}if(w.highpass2>0&&w.highpass2<.9*(.75/31)&&(w.highpass1=0,w.highpass2=0,o.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),w.highpass2>0){for(var Be=-1,Fe=0;Fe<=31;Fe++){var Ie=Fe/31;Ie<=w.highpass1&&(Re=Math.max(Re,Fe)),w.highpass1<Ie&&Ie<w.highpass2&&(Be=Math.max(Be,Fe))}w.highpass1=Re/31,Be==-1?w.highpass2=(Re+.75)/31:w.highpass2=(Be+.75)/31}for(var Fe=0;Fe<32;Fe++){var Pe,Ce,Ie=Fe/31;w.highpass2>w.highpass1?Pe=D((w.highpass2-Ie)/(w.highpass2-w.highpass1+1e-20)):Pe=1,w.lowpass2>w.lowpass1?Ce=D((Ie-w.lowpass1)/(w.lowpass2-w.lowpass1+1e-20)):Ce=1,w.amp_filter[Fe]=Pe*Ce}}function ne(_){var w=_.internal_flags;switch(_.quality){default:case 9:w.psymodel=0,w.noise_shaping=0,w.noise_shaping_amp=0,w.noise_shaping_stop=0,w.use_best_huffman=0,w.full_outer_loop=0;break;case 8:_.quality=7;case 7:w.psymodel=1,w.noise_shaping=0,w.noise_shaping_amp=0,w.noise_shaping_stop=0,w.use_best_huffman=0,w.full_outer_loop=0;break;case 6:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.noise_shaping_amp=0,w.noise_shaping_stop=0,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=0,w.full_outer_loop=0;break;case 5:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.noise_shaping_amp=0,w.noise_shaping_stop=0,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=0,w.full_outer_loop=0;break;case 4:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.noise_shaping_amp=0,w.noise_shaping_stop=0,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=1,w.full_outer_loop=0;break;case 3:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.noise_shaping_amp=1,w.noise_shaping_stop=1,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=1,w.full_outer_loop=0;break;case 2:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.substep_shaping==0&&(w.substep_shaping=2),w.noise_shaping_amp=1,w.noise_shaping_stop=1,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=1,w.full_outer_loop=0;break;case 1:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.substep_shaping==0&&(w.substep_shaping=2),w.noise_shaping_amp=2,w.noise_shaping_stop=1,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=1,w.full_outer_loop=0;break;case 0:w.psymodel=1,w.noise_shaping==0&&(w.noise_shaping=1),w.substep_shaping==0&&(w.substep_shaping=2),w.noise_shaping_amp=2,w.noise_shaping_stop=1,w.subblock_gain==-1&&(w.subblock_gain=1),w.use_best_huffman=1,w.full_outer_loop=0;break}}function g(_){var w=_.internal_flags;_.frameNum=0,_.write_id3tag_automatic&&B.id3tag_write_v2(_),w.bitrate_stereoMode_Hist=S([16,4+1]),w.bitrate_blockType_Hist=S([16,4+1+1]),w.PeakSample=0,_.bWriteVbrTag&&j.InitVbrTag(_)}this.lame_init_params=function(_){var w=_.internal_flags;if(w.Class_ID=0,w.ATH==null&&(w.ATH=new e),w.PSY==null&&(w.PSY=new O),w.rgdata==null&&(w.rgdata=new a),w.channels_in=_.num_channels,w.channels_in==1&&(_.mode=l.MONO),w.channels_out=_.mode==l.MONO?1:2,w.mode_ext=I.MPG_MD_MS_LR,_.mode==l.MONO&&(_.force_ms=!1),_.VBR==t.vbr_off&&_.VBR_mean_bitrate_kbps!=128&&_.brate==0&&(_.brate=_.VBR_mean_bitrate_kbps),_.VBR==t.vbr_off||_.VBR==t.vbr_mtrh||_.VBR==t.vbr_mt||(_.free_format=!1),_.VBR==t.vbr_off&&_.brate==0&&A.EQ(_.compression_ratio,0)&&(_.compression_ratio=11.025),_.VBR==t.vbr_off&&_.compression_ratio>0&&(_.out_samplerate==0&&(_.out_samplerate=map2MP3Frequency(int(.97*_.in_samplerate))),_.brate=0|_.out_samplerate*16*w.channels_out/(1e3*_.compression_ratio),w.samplerate_index=v(_.out_samplerate,_),_.free_format||(_.brate=m(_.brate,_.version,_.out_samplerate))),_.out_samplerate!=0&&(_.out_samplerate<16e3?(_.VBR_mean_bitrate_kbps=Math.max(_.VBR_mean_bitrate_kbps,8),_.VBR_mean_bitrate_kbps=Math.min(_.VBR_mean_bitrate_kbps,64)):_.out_samplerate<32e3?(_.VBR_mean_bitrate_kbps=Math.max(_.VBR_mean_bitrate_kbps,8),_.VBR_mean_bitrate_kbps=Math.min(_.VBR_mean_bitrate_kbps,160)):(_.VBR_mean_bitrate_kbps=Math.max(_.VBR_mean_bitrate_kbps,32),_.VBR_mean_bitrate_kbps=Math.min(_.VBR_mean_bitrate_kbps,320))),_.lowpassfreq==0){var xe=16e3;switch(_.VBR){case t.vbr_off:{var Re=new q;T(Re,_.brate),xe=Re.lowerlimit;break}case t.vbr_abr:{var Re=new q;T(Re,_.VBR_mean_bitrate_kbps),xe=Re.lowerlimit;break}case t.vbr_rh:{var Xe=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=_.VBR_q&&_.VBR_q<=9){var Fe=Xe[_.VBR_q],Ie=Xe[_.VBR_q+1],Be=_.VBR_q_frac;xe=linear_int(Fe,Ie,Be)}else xe=19500;break}default:{var Xe=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=_.VBR_q&&_.VBR_q<=9){var Fe=Xe[_.VBR_q],Ie=Xe[_.VBR_q+1],Be=_.VBR_q_frac;xe=linear_int(Fe,Ie,Be)}else xe=19500}}_.mode==l.MONO&&(_.VBR==t.vbr_off||_.VBR==t.vbr_abr)&&(xe*=1.5),_.lowpassfreq=xe|0}if(_.out_samplerate==0&&(2*_.lowpassfreq>_.in_samplerate&&(_.lowpassfreq=_.in_samplerate/2),_.out_samplerate=F(_.lowpassfreq|0,_.in_samplerate)),_.lowpassfreq=Math.min(20500,_.lowpassfreq),_.lowpassfreq=Math.min(_.out_samplerate/2,_.lowpassfreq),_.VBR==t.vbr_off&&(_.compression_ratio=_.out_samplerate*16*w.channels_out/(1e3*_.brate)),_.VBR==t.vbr_abr&&(_.compression_ratio=_.out_samplerate*16*w.channels_out/(1e3*_.VBR_mean_bitrate_kbps)),_.bWriteVbrTag||(_.findReplayGain=!1,_.decode_on_the_fly=!1,w.findPeakSample=!1),w.findReplayGain=_.findReplayGain,w.decode_on_the_fly=_.decode_on_the_fly,w.decode_on_the_fly&&(w.findPeakSample=!0),w.findReplayGain&&p.InitGainAnalysis(w.rgdata,_.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return _.internal_flags=null,-6;switch(w.decode_on_the_fly&&!_.decode_only&&(w.hip!=null&&n.hip_decode_exit(w.hip),w.hip=n.hip_decode_init()),w.mode_gr=_.out_samplerate<=24e3?1:2,_.framesize=576*w.mode_gr,_.encoder_delay=I.ENCDELAY,w.resample_ratio=_.in_samplerate/_.out_samplerate,_.VBR){case t.vbr_mt:case t.vbr_rh:case t.vbr_mtrh:{var Pe=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];_.compression_ratio=Pe[_.VBR_q]}break;case t.vbr_abr:_.compression_ratio=_.out_samplerate*16*w.channels_out/(1e3*_.VBR_mean_bitrate_kbps);break;default:_.compression_ratio=_.out_samplerate*16*w.channels_out/(1e3*_.brate);break}if(_.mode==l.NOT_SET&&(_.mode=l.JOINT_STEREO),_.highpassfreq>0?(w.highpass1=2*_.highpassfreq,_.highpasswidth>=0?w.highpass2=2*(_.highpassfreq+_.highpasswidth):w.highpass2=(1+0)*2*_.highpassfreq,w.highpass1/=_.out_samplerate,w.highpass2/=_.out_samplerate):(w.highpass1=0,w.highpass2=0),_.lowpassfreq>0?(w.lowpass2=2*_.lowpassfreq,_.lowpasswidth>=0?(w.lowpass1=2*(_.lowpassfreq-_.lowpasswidth),w.lowpass1<0&&(w.lowpass1=0)):w.lowpass1=(1-0)*2*_.lowpassfreq,w.lowpass1/=_.out_samplerate,w.lowpass2/=_.out_samplerate):(w.lowpass1=0,w.lowpass2=0),K(_),w.samplerate_index=v(_.out_samplerate,_),w.samplerate_index<0)return _.internal_flags=null,-1;if(_.VBR==t.vbr_off){if(_.free_format)w.bitrate_index=0;else if(_.brate=m(_.brate,_.version,_.out_samplerate),w.bitrate_index=i(_.brate,_.version,_.out_samplerate),w.bitrate_index<=0)return _.internal_flags=null,-1}else w.bitrate_index=1;_.analysis&&(_.bWriteVbrTag=!1),w.pinfo!=null&&(_.bWriteVbrTag=!1),L.init_bit_stream_w(w);for(var Ce=w.samplerate_index+3*_.version+6*(_.out_samplerate<16e3?1:0),Ae=0;Ae<I.SBMAX_l+1;Ae++)w.scalefac_band.l[Ae]=N.sfBandIndex[Ce].l[Ae];for(var Ae=0;Ae<I.PSFB21+1;Ae++){var We=(w.scalefac_band.l[22]-w.scalefac_band.l[21])/I.PSFB21,f0=w.scalefac_band.l[21]+Ae*We;w.scalefac_band.psfb21[Ae]=f0}w.scalefac_band.psfb21[I.PSFB21]=576;for(var Ae=0;Ae<I.SBMAX_s+1;Ae++)w.scalefac_band.s[Ae]=N.sfBandIndex[Ce].s[Ae];for(var Ae=0;Ae<I.PSFB12+1;Ae++){var We=(w.scalefac_band.s[13]-w.scalefac_band.s[12])/I.PSFB12,f0=w.scalefac_band.s[12]+Ae*We;w.scalefac_band.psfb12[Ae]=f0}w.scalefac_band.psfb12[I.PSFB12]=192,_.version==1?w.sideinfo_len=w.channels_out==1?4+17:4+32:w.sideinfo_len=w.channels_out==1?4+9:4+17,_.error_protection&&(w.sideinfo_len+=2),g(_),w.Class_ID=G;{var Ze;for(Ze=0;Ze<19;Ze++)w.nsPsy.pefirbuf[Ze]=700*w.mode_gr*w.channels_out;_.ATHtype==-1&&(_.ATHtype=4)}switch(x(_.VBR_q<=9),x(_.VBR_q>=0),_.VBR){case t.vbr_mt:_.VBR=t.vbr_mtrh;case t.vbr_mtrh:{_.useTemporal==null&&(_.useTemporal=!1),P.apply_preset(_,500-_.VBR_q*10,0),_.quality<0&&(_.quality=LAME_DEFAULT_QUALITY),_.quality<5&&(_.quality=0),_.quality>5&&(_.quality=5),w.PSY.mask_adjust=_.maskingadjust,w.PSY.mask_adjust_short=_.maskingadjust_short,_.experimentalY?w.sfb21_extra=!1:w.sfb21_extra=_.out_samplerate>44e3,w.iteration_loop=new VBRNewIterationLoop(V);break}case t.vbr_rh:{P.apply_preset(_,500-_.VBR_q*10,0),w.PSY.mask_adjust=_.maskingadjust,w.PSY.mask_adjust_short=_.maskingadjust_short,_.experimentalY?w.sfb21_extra=!1:w.sfb21_extra=_.out_samplerate>44e3,_.quality>6&&(_.quality=6),_.quality<0&&(_.quality=LAME_DEFAULT_QUALITY),w.iteration_loop=new VBROldIterationLoop(V);break}default:{var R;w.sfb21_extra=!1,_.quality<0&&(_.quality=LAME_DEFAULT_QUALITY),R=_.VBR,R==t.vbr_off&&(_.VBR_mean_bitrate_kbps=_.brate),P.apply_preset(_,_.VBR_mean_bitrate_kbps,0),_.VBR=R,w.PSY.mask_adjust=_.maskingadjust,w.PSY.mask_adjust_short=_.maskingadjust_short,R==t.vbr_off?w.iteration_loop=new f(V):w.iteration_loop=new ABRIterationLoop(V);break}}if(x(_.scale>=0),_.VBR!=t.vbr_off){if(w.VBR_min_bitrate=1,w.VBR_max_bitrate=14,_.out_samplerate<16e3&&(w.VBR_max_bitrate=8),_.VBR_min_bitrate_kbps!=0&&(_.VBR_min_bitrate_kbps=m(_.VBR_min_bitrate_kbps,_.version,_.out_samplerate),w.VBR_min_bitrate=i(_.VBR_min_bitrate_kbps,_.version,_.out_samplerate),w.VBR_min_bitrate<0)||_.VBR_max_bitrate_kbps!=0&&(_.VBR_max_bitrate_kbps=m(_.VBR_max_bitrate_kbps,_.version,_.out_samplerate),w.VBR_max_bitrate=i(_.VBR_max_bitrate_kbps,_.version,_.out_samplerate),w.VBR_max_bitrate<0))return-1;_.VBR_min_bitrate_kbps=k.bitrate_table[_.version][w.VBR_min_bitrate],_.VBR_max_bitrate_kbps=k.bitrate_table[_.version][w.VBR_max_bitrate],_.VBR_mean_bitrate_kbps=Math.min(k.bitrate_table[_.version][w.VBR_max_bitrate],_.VBR_mean_bitrate_kbps),_.VBR_mean_bitrate_kbps=Math.max(k.bitrate_table[_.version][w.VBR_min_bitrate],_.VBR_mean_bitrate_kbps)}return _.tune&&(w.PSY.mask_adjust+=_.tune_value_a,w.PSY.mask_adjust_short+=_.tune_value_a),ne(_),x(_.scale>=0),_.athaa_type<0?w.ATH.useAdjust=3:w.ATH.useAdjust=_.athaa_type,w.ATH.aaSensitivityP=Math.pow(10,_.athaa_sensitivity/-10),_.short_blocks==null&&(_.short_blocks=s.short_block_allowed),_.short_blocks==s.short_block_allowed&&(_.mode==l.JOINT_STEREO||_.mode==l.STEREO)&&(_.short_blocks=s.short_block_coupled),_.quant_comp<0&&(_.quant_comp=1),_.quant_comp_short<0&&(_.quant_comp_short=0),_.msfix<0&&(_.msfix=0),_.exp_nspsytune=_.exp_nspsytune|1,_.internal_flags.nsPsy.attackthre<0&&(_.internal_flags.nsPsy.attackthre=H.NSATTACKTHRE),_.internal_flags.nsPsy.attackthre_s<0&&(_.internal_flags.nsPsy.attackthre_s=H.NSATTACKTHRE_S),x(_.scale>=0),_.scale<0&&(_.scale=1),_.ATHtype<0&&(_.ATHtype=4),_.ATHcurve<0&&(_.ATHcurve=4),_.athaa_loudapprox<0&&(_.athaa_loudapprox=2),_.interChRatio<0&&(_.interChRatio=0),_.useTemporal==null&&(_.useTemporal=!0),w.slot_lag=w.frac_SpF=0,_.VBR==t.vbr_off&&(w.slot_lag=w.frac_SpF=(_.version+1)*72e3*_.brate%_.out_samplerate|0),N.iteration_init(_),Q.psymodel_init(_),x(_.scale>=0),0};function Y(_,w){(_.in_buffer_0==null||_.in_buffer_nsamples<w)&&(_.in_buffer_0=h(w),_.in_buffer_1=h(w),_.in_buffer_nsamples=w)}this.lame_encode_flush=function(_,w,xe,Re){var Xe=_.internal_flags,Fe=c([2,1152]),Ie=0,Be,Pe,Ce,Ae,We=Xe.mf_samples_to_encode-I.POSTDELAY,f0=re(_);if(Xe.mf_samples_to_encode<1)return 0;for(Be=0,_.in_samplerate!=_.out_samplerate&&(We+=16*_.out_samplerate/_.in_samplerate),Ce=_.framesize-We%_.framesize,Ce<576&&(Ce+=_.framesize),_.encoder_padding=Ce,Ae=(We+Ce)/_.framesize;Ae>0&&Ie>=0;){var Ze=f0-Xe.mf_size,R=_.frameNum;Ze*=_.in_samplerate,Ze/=_.out_samplerate,Ze>1152&&(Ze=1152),Ze<1&&(Ze=1),Pe=Re-Be,Re==0&&(Pe=0),Ie=this.lame_encode_buffer(_,Fe[0],Fe[1],Ze,w,xe,Pe),xe+=Ie,Be+=Ie,Ae-=R!=_.frameNum?1:0}if(Xe.mf_samples_to_encode=0,Ie<0||(Pe=Re-Be,Re==0&&(Pe=0),L.flush_bitstream(_),Ie=L.copy_buffer(Xe,w,xe,Pe,1),Ie<0))return Ie;if(xe+=Ie,Be+=Ie,Pe=Re-Be,Re==0&&(Pe=0),_.write_id3tag_automatic){if(B.id3tag_write_v1(_),Ie=L.copy_buffer(Xe,w,xe,Pe,0),Ie<0)return Ie;Be+=Ie}return Be},this.lame_encode_buffer=function(_,w,xe,Re,Xe,Fe,Ie){var Be=_.internal_flags,Pe=[null,null];if(Be.Class_ID!=G)return-3;if(Re==0)return 0;Y(Be,Re),Pe[0]=Be.in_buffer_0,Pe[1]=Be.in_buffer_1;for(var Ce=0;Ce<Re;Ce++)Pe[0][Ce]=w[Ce],Be.channels_in>1&&(Pe[1][Ce]=xe[Ce]);return _e(_,Pe[0],Pe[1],Re,Xe,Fe,Ie)};function re(_){var w=I.BLKSIZE+_.framesize-I.FFTOFFSET;return w=Math.max(w,512+_.framesize-32),x(y.MFSIZE>=w),w}function _e(_,w,xe,Re,Xe,Fe,Ie){var Be=_.internal_flags,Pe=0,Ce,Ae,We,f0,Ze,R=[null,null],E=[null,null];if(Be.Class_ID!=G)return-3;if(Re==0)return 0;if(Ze=L.copy_buffer(Be,Xe,Fe,Ie,0),Ze<0)return Ze;if(Fe+=Ze,Pe+=Ze,E[0]=w,E[1]=xe,A.NEQ(_.scale,0)&&A.NEQ(_.scale,1))for(Ae=0;Ae<Re;++Ae)E[0][Ae]*=_.scale,Be.channels_out==2&&(E[1][Ae]*=_.scale);if(A.NEQ(_.scale_left,0)&&A.NEQ(_.scale_left,1))for(Ae=0;Ae<Re;++Ae)E[0][Ae]*=_.scale_left;if(A.NEQ(_.scale_right,0)&&A.NEQ(_.scale_right,1))for(Ae=0;Ae<Re;++Ae)E[1][Ae]*=_.scale_right;if(_.num_channels==2&&Be.channels_out==1)for(Ae=0;Ae<Re;++Ae)E[0][Ae]=.5*(E[0][Ae]+E[1][Ae]),E[1][Ae]=0;f0=re(_),R[0]=Be.mfbuf[0],R[1]=Be.mfbuf[1];for(var X=0;Re>0;){var U=[null,null],J=0,C=0;U[0]=E[0],U[1]=E[1];var W=new ke;if(c0(_,R,U,X,Re,W),J=W.n_in,C=W.n_out,Be.findReplayGain&&!Be.decode_on_the_fly&&p.AnalyzeSamples(Be.rgdata,R[0],Be.mf_size,R[1],Be.mf_size,C,Be.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(Re-=J,X+=J,Be.channels_out==2,Be.mf_size+=C,x(Be.mf_size<=y.MFSIZE),Be.mf_samples_to_encode<1&&(Be.mf_samples_to_encode=I.ENCDELAY+I.POSTDELAY),Be.mf_samples_to_encode+=C,Be.mf_size>=f0){var te=Ie-Pe;if(Ie==0&&(te=0),Ce=he(_,R[0],R[1],Xe,Fe,te),Ce<0)return Ce;for(Fe+=Ce,Pe+=Ce,Be.mf_size-=_.framesize,Be.mf_samples_to_encode-=_.framesize,We=0;We<Be.channels_out;We++)for(Ae=0;Ae<Be.mf_size;Ae++)R[We][Ae]=R[We][Ae+_.framesize]}}return x(Re==0),Pe}function he(_,w,xe,Re,Xe,Fe){var Ie=b.enc.lame_encode_mp3_frame(_,w,xe,Re,Xe,Fe);return _.frameNum++,Ie}function ke(){this.n_in=0,this.n_out=0}function Se(){this.num_used=0}function be(_,w){return w!=0?be(w,_%w):_}function Le(_,w,xe){var Re=Math.PI*w;_/=xe,_<0&&(_=0),_>1&&(_=1);var Xe=_-.5,Fe=.42-.5*Math.cos(2*_*Math.PI)+.08*Math.cos(4*_*Math.PI);return Math.abs(Xe)<1e-9?Re/Math.PI:Fe*Math.sin(xe*Re*Xe)/(Math.PI*xe*Xe)}function $e(_,w,xe,Re,Xe,Fe,Ie,Be,Pe){var Ce=_.internal_flags,Ae,We=0,f0,Ze=_.out_samplerate/be(_.out_samplerate,_.in_samplerate);Ze>y.BPC&&(Ze=y.BPC);var R=Math.abs(Ce.resample_ratio-Math.floor(.5+Ce.resample_ratio))<1e-4?1:0,E=1/Ce.resample_ratio;E>1&&(E=1);var X=31;X%2==0&&--X,X+=R;var U=X+1;if(Ce.fill_buffer_resample_init==0){for(Ce.inbuf_old[0]=h(U),Ce.inbuf_old[1]=h(U),Ae=0;Ae<=2*Ze;++Ae)Ce.blackfilt[Ae]=h(U);for(Ce.itime[0]=0,Ce.itime[1]=0,We=0;We<=2*Ze;We++){var J=0,C=(We-Ze)/(2*Ze);for(Ae=0;Ae<=X;Ae++)J+=Ce.blackfilt[We][Ae]=Le(Ae-C,E,X);for(Ae=0;Ae<=X;Ae++)Ce.blackfilt[We][Ae]/=J}Ce.fill_buffer_resample_init=1}var W=Ce.inbuf_old[Pe];for(f0=0;f0<Re;f0++){var te,z;if(te=f0*Ce.resample_ratio,We=0|Math.floor(te-Ce.itime[Pe]),X+We-X/2>=Ie)break;var C=te-Ce.itime[Pe]-(We+.5*(X%2));x(Math.abs(C)<=.501),z=0|Math.floor(C*2*Ze+Ze+.5);var se=0;for(Ae=0;Ae<=X;++Ae){var ae=0|Ae+We-X/2,le;x(ae<Ie),x(ae+U>=0),le=ae<0?W[U+ae]:Xe[Fe+ae],se+=le*Ce.blackfilt[z][Ae]}w[xe+f0]=se}if(Be.num_used=Math.min(Ie,X+We-X/2),Ce.itime[Pe]+=Be.num_used-f0*Ce.resample_ratio,Be.num_used>=U)for(Ae=0;Ae<U;Ae++)W[Ae]=Xe[Fe+Be.num_used+Ae-U];else{var me=U-Be.num_used;for(Ae=0;Ae<me;++Ae)W[Ae]=W[Ae+Be.num_used];for(We=0;Ae<U;++Ae,++We)W[Ae]=Xe[Fe+We];x(We==Be.num_used)}return f0}function c0(_,w,xe,Re,Xe,Fe){var Ie=_.internal_flags;if(Ie.resample_ratio<.9999||Ie.resample_ratio>1.0001)for(var Be=0;Be<Ie.channels_out;Be++){var Pe=new Se;Fe.n_out=$e(_,w[Be],Ie.mf_size,_.framesize,xe[Be],Re,Xe,Pe,Be),Fe.n_in=Pe.num_used}else{Fe.n_out=Math.min(_.framesize,Xe),Fe.n_in=Fe.n_out;for(var Ce=0;Ce<Fe.n_out;++Ce)w[0][Ie.mf_size+Ce]=xe[0][Re+Ce],Ie.channels_out==2&&(w[1][Ie.mf_size+Ce]=xe[1][Re+Ce])}}}return Aa=u,Aa}var V0=t0;V0.System;var et=V0.VbrMode;V0.Float;V0.ShortBlock;V0.Util;V0.Arrays;V0.new_array_n;V0.new_byte;V0.new_double;V0.new_float;V0.new_float_n;V0.new_int;V0.new_int_n;V0.assert;function Ur(){var d=Ca();function o(y,e,a,f,A,k,I,u,l,b,M,r,p,L,P){this.vbr_q=y,this.quant_comp=e,this.quant_comp_s=a,this.expY=f,this.st_lrm=A,this.st_s=k,this.masking_adj=I,this.masking_adj_short=u,this.ath_lower=l,this.ath_curve=b,this.ath_sensitivity=M,this.interch=r,this.safejoint=p,this.sfb21mod=L,this.msfix=P}function t(y,e,a,f,A,k,I,u,l,b,M,r,p,L){this.quant_comp=e,this.quant_comp_s=a,this.safejoint=f,this.nsmsfix=A,this.st_lrm=k,this.st_s=I,this.nsbass=u,this.scale=l,this.masking_adj=b,this.ath_lower=M,this.ath_curve=r,this.interch=p,this.sfscale=L}var s;this.setModules=function(y){s=y};var h=[new o(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new o(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new o(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new o(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new o(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new o(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new o(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new o(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new o(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new o(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new o(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],S=[new o(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new o(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new o(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new o(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new o(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new o(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new o(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new o(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new o(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new o(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new o(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function c(y,e,a){var f=y.VBR==et.vbr_rh?h:S,A=y.VBR_q_frac,k=f[e],I=f[e+1],u=k;k.st_lrm=k.st_lrm+A*(I.st_lrm-k.st_lrm),k.st_s=k.st_s+A*(I.st_s-k.st_s),k.masking_adj=k.masking_adj+A*(I.masking_adj-k.masking_adj),k.masking_adj_short=k.masking_adj_short+A*(I.masking_adj_short-k.masking_adj_short),k.ath_lower=k.ath_lower+A*(I.ath_lower-k.ath_lower),k.ath_curve=k.ath_curve+A*(I.ath_curve-k.ath_curve),k.ath_sensitivity=k.ath_sensitivity+A*(I.ath_sensitivity-k.ath_sensitivity),k.interch=k.interch+A*(I.interch-k.interch),k.msfix=k.msfix+A*(I.msfix-k.msfix),$(y,u.vbr_q),a!=0?y.quant_comp=u.quant_comp:Math.abs(y.quant_comp- -1)>0||(y.quant_comp=u.quant_comp),a!=0?y.quant_comp_short=u.quant_comp_s:Math.abs(y.quant_comp_short- -1)>0||(y.quant_comp_short=u.quant_comp_s),u.expY!=0&&(y.experimentalY=u.expY!=0),a!=0?y.internal_flags.nsPsy.attackthre=u.st_lrm:Math.abs(y.internal_flags.nsPsy.attackthre- -1)>0||(y.internal_flags.nsPsy.attackthre=u.st_lrm),a!=0?y.internal_flags.nsPsy.attackthre_s=u.st_s:Math.abs(y.internal_flags.nsPsy.attackthre_s- -1)>0||(y.internal_flags.nsPsy.attackthre_s=u.st_s),a!=0?y.maskingadjust=u.masking_adj:Math.abs(y.maskingadjust-0)>0||(y.maskingadjust=u.masking_adj),a!=0?y.maskingadjust_short=u.masking_adj_short:Math.abs(y.maskingadjust_short-0)>0||(y.maskingadjust_short=u.masking_adj_short),a!=0?y.ATHlower=-u.ath_lower/10:Math.abs(-y.ATHlower*10-0)>0||(y.ATHlower=-u.ath_lower/10),a!=0?y.ATHcurve=u.ath_curve:Math.abs(y.ATHcurve- -1)>0||(y.ATHcurve=u.ath_curve),a!=0?y.athaa_sensitivity=u.ath_sensitivity:Math.abs(y.athaa_sensitivity- -1)>0||(y.athaa_sensitivity=u.ath_sensitivity),u.interch>0&&(a!=0?y.interChRatio=u.interch:Math.abs(y.interChRatio- -1)>0||(y.interChRatio=u.interch)),u.safejoint>0&&(y.exp_nspsytune=y.exp_nspsytune|u.safejoint),u.sfb21mod>0&&(y.exp_nspsytune=y.exp_nspsytune|u.sfb21mod<<20),a!=0?y.msfix=u.msfix:Math.abs(y.msfix- -1)>0||(y.msfix=u.msfix),a==0&&(y.VBR_q=e,y.VBR_q_frac=A)}var x=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function H(y,e,a){var f=e,A=s.nearestBitrateFullIndex(e);if(y.VBR=et.vbr_abr,y.VBR_mean_bitrate_kbps=f,y.VBR_mean_bitrate_kbps=Math.min(y.VBR_mean_bitrate_kbps,320),y.VBR_mean_bitrate_kbps=Math.max(y.VBR_mean_bitrate_kbps,8),y.brate=y.VBR_mean_bitrate_kbps,y.VBR_mean_bitrate_kbps>320&&(y.disable_reservoir=!0),x[A].safejoint>0&&(y.exp_nspsytune=y.exp_nspsytune|2),x[A].sfscale>0&&(y.internal_flags.noise_shaping=2),Math.abs(x[A].nsbass)>0){var k=int(x[A].nsbass*4);k<0&&(k+=64),y.exp_nspsytune=y.exp_nspsytune|k<<2}return a!=0?y.quant_comp=x[A].quant_comp:Math.abs(y.quant_comp- -1)>0||(y.quant_comp=x[A].quant_comp),a!=0?y.quant_comp_short=x[A].quant_comp_s:Math.abs(y.quant_comp_short- -1)>0||(y.quant_comp_short=x[A].quant_comp_s),a!=0?y.msfix=x[A].nsmsfix:Math.abs(y.msfix- -1)>0||(y.msfix=x[A].nsmsfix),a!=0?y.internal_flags.nsPsy.attackthre=x[A].st_lrm:Math.abs(y.internal_flags.nsPsy.attackthre- -1)>0||(y.internal_flags.nsPsy.attackthre=x[A].st_lrm),a!=0?y.internal_flags.nsPsy.attackthre_s=x[A].st_s:Math.abs(y.internal_flags.nsPsy.attackthre_s- -1)>0||(y.internal_flags.nsPsy.attackthre_s=x[A].st_s),a!=0?y.scale=x[A].scale:Math.abs(y.scale- -1)>0||(y.scale=x[A].scale),a!=0?y.maskingadjust=x[A].masking_adj:Math.abs(y.maskingadjust-0)>0||(y.maskingadjust=x[A].masking_adj),x[A].masking_adj>0?a!=0?y.maskingadjust_short=x[A].masking_adj*.9:Math.abs(y.maskingadjust_short-0)>0||(y.maskingadjust_short=x[A].masking_adj*.9):a!=0?y.maskingadjust_short=x[A].masking_adj*1.1:Math.abs(y.maskingadjust_short-0)>0||(y.maskingadjust_short=x[A].masking_adj*1.1),a!=0?y.ATHlower=-x[A].ath_lower/10:Math.abs(-y.ATHlower*10-0)>0||(y.ATHlower=-x[A].ath_lower/10),a!=0?y.ATHcurve=x[A].ath_curve:Math.abs(y.ATHcurve- -1)>0||(y.ATHcurve=x[A].ath_curve),a!=0?y.interChRatio=x[A].interch:Math.abs(y.interChRatio- -1)>0||(y.interChRatio=x[A].interch),e}this.apply_preset=function(y,e,a){switch(e){case d.R3MIX:{e=d.V3,y.VBR=et.vbr_mtrh;break}case d.MEDIUM:{e=d.V4,y.VBR=et.vbr_rh;break}case d.MEDIUM_FAST:{e=d.V4,y.VBR=et.vbr_mtrh;break}case d.STANDARD:{e=d.V2,y.VBR=et.vbr_rh;break}case d.STANDARD_FAST:{e=d.V2,y.VBR=et.vbr_mtrh;break}case d.EXTREME:{e=d.V0,y.VBR=et.vbr_rh;break}case d.EXTREME_FAST:{e=d.V0,y.VBR=et.vbr_mtrh;break}case d.INSANE:return e=320,y.preset=e,H(y,e,a),y.VBR=et.vbr_off,e}switch(y.preset=e,e){case d.V9:return c(y,9,a),e;case d.V8:return c(y,8,a),e;case d.V7:return c(y,7,a),e;case d.V6:return c(y,6,a),e;case d.V5:return c(y,5,a),e;case d.V4:return c(y,4,a),e;case d.V3:return c(y,3,a),e;case d.V2:return c(y,2,a),e;case d.V1:return c(y,1,a),e;case d.V0:return c(y,0,a),e}return 8<=e&&e<=320?H(y,e,a):(y.preset=0,e)};function $(y,e){var a=0;return 0>e&&(a=-1,e=0),9<e&&(a=-1,e=9),y.VBR_q=e,y.VBR_q_frac=0,a}}var $r=Ur;function Zr(){this.setModules=function(d,o){}}var Kr=Zr;function Qr(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Wr=Qr,Oa=t0,s1=Oa.new_float,jr=Oa.new_int;Oa.assert;function zr(){this.global_gain=0,this.sfb_count1=0,this.step=jr(39),this.noise=s1(39),this.noise_log=s1(39)}var Jr=zr,N0=t0,st=N0.System,l1=N0.VbrMode;N0.Float;N0.ShortBlock;var ya=N0.Util,At=N0.Arrays;N0.new_array_n;N0.new_byte;N0.new_double;var Rt=N0.new_float;N0.new_float_n;N0.new_int;N0.new_int_n;var $0=N0.assert,gr=Kr,Sa=Wr,en=Jr,Qe=b0(),o1=Ia,_1=Jt;function tn(){var d;this.rv=null;var o;this.qupvt=null;var t,s=new gr,h;this.setModules=function(u,l,b,M){d=u,o=l,this.rv=l,t=b,this.qupvt=b,h=M,s.setModules(t,h)},this.ms_convert=function(u,l){for(var b=0;b<576;++b){var M=u.tt[l][0].xr[b],r=u.tt[l][1].xr[b];u.tt[l][0].xr[b]=(M+r)*(ya.SQRT2*.5),u.tt[l][1].xr[b]=(M-r)*(ya.SQRT2*.5)}};function S(u,l,b,M){M=0;for(var r=0;r<=b;++r){var p=Math.abs(u.xr[r]);M+=p,l[r]=Math.sqrt(p*Math.sqrt(p)),l[r]>u.xrpow_max&&(u.xrpow_max=l[r])}return M}this.init_xrpow=function(u,l,b){var M=0,r=0|l.max_nonzero_coeff;if($0(b!=null),l.xrpow_max=0,$0(0<=r&&r<=575),At.fill(b,r,576,0),M=S(l,b,r,M),M>1e-20){var p=0;u.substep_shaping&2&&(p=1);for(var L=0;L<l.psymax;L++)u.pseudohalf[L]=p;return!0}return At.fill(l.l3_enc,0,576,0),!1};function c(u,l){var b=u.ATH,M=l.xr;if(l.block_type!=Qe.SHORT_TYPE)for(var r=!1,p=Qe.PSFB21-1;p>=0&&!r;p--){var L=u.scalefac_band.psfb21[p],P=u.scalefac_band.psfb21[p+1],N=t.athAdjust(b.adjust,b.psfb21[p],b.floor);u.nsPsy.longfact[21]>1e-12&&(N*=u.nsPsy.longfact[21]);for(var V=P-1;V>=L;V--)if(Math.abs(M[V])<N)M[V]=0;else{r=!0;break}}else for(var Q=0;Q<3;Q++)for(var r=!1,p=Qe.PSFB12-1;p>=0&&!r;p--){var L=u.scalefac_band.s[12]*3+(u.scalefac_band.s[13]-u.scalefac_band.s[12])*Q+(u.scalefac_band.psfb12[p]-u.scalefac_band.psfb12[0]),P=L+(u.scalefac_band.psfb12[p+1]-u.scalefac_band.psfb12[p]),j=t.athAdjust(b.adjust,b.psfb12[p],b.floor);u.nsPsy.shortfact[12]>1e-12&&(j*=u.nsPsy.shortfact[12]);for(var V=P-1;V>=L;V--)if(Math.abs(M[V])<j)M[V]=0;else{r=!0;break}}}this.init_outer_loop=function(u,l){l.part2_3_length=0,l.big_values=0,l.count1=0,l.global_gain=210,l.scalefac_compress=0,l.table_select[0]=0,l.table_select[1]=0,l.table_select[2]=0,l.subblock_gain[0]=0,l.subblock_gain[1]=0,l.subblock_gain[2]=0,l.subblock_gain[3]=0,l.region0_count=0,l.region1_count=0,l.preflag=0,l.scalefac_scale=0,l.count1table_select=0,l.part2_length=0,l.sfb_lmax=Qe.SBPSY_l,l.sfb_smin=Qe.SBPSY_s,l.psy_lmax=u.sfb21_extra?Qe.SBMAX_l:Qe.SBPSY_l,l.psymax=l.psy_lmax,l.sfbmax=l.sfb_lmax,l.sfbdivide=11;for(var b=0;b<Qe.SBMAX_l;b++)l.width[b]=u.scalefac_band.l[b+1]-u.scalefac_band.l[b],l.window[b]=3;if(l.block_type==Qe.SHORT_TYPE){var M=Rt(576);l.sfb_smin=0,l.sfb_lmax=0,l.mixed_block_flag!=0&&(l.sfb_smin=3,l.sfb_lmax=u.mode_gr*2+4),l.psymax=l.sfb_lmax+3*((u.sfb21_extra?Qe.SBMAX_s:Qe.SBPSY_s)-l.sfb_smin),l.sfbmax=l.sfb_lmax+3*(Qe.SBPSY_s-l.sfb_smin),l.sfbdivide=l.sfbmax-18,l.psy_lmax=l.sfb_lmax;var r=u.scalefac_band.l[l.sfb_lmax];st.arraycopy(l.xr,0,M,0,576);for(var b=l.sfb_smin;b<Qe.SBMAX_s;b++)for(var p=u.scalefac_band.s[b],L=u.scalefac_band.s[b+1],P=0;P<3;P++)for(var N=p;N<L;N++)l.xr[r++]=M[3*N+P];for(var V=l.sfb_lmax,b=l.sfb_smin;b<Qe.SBMAX_s;b++)l.width[V]=l.width[V+1]=l.width[V+2]=u.scalefac_band.s[b+1]-u.scalefac_band.s[b],l.window[V]=0,l.window[V+1]=1,l.window[V+2]=2,V+=3}l.count1bits=0,l.sfb_partition_table=t.nr_of_sfb_block[0][0],l.slen[0]=0,l.slen[1]=0,l.slen[2]=0,l.slen[3]=0,l.max_nonzero_coeff=575,At.fill(l.scalefac,0),c(u,l)};function x(u){this.ordinal=u}x.BINSEARCH_NONE=new x(0),x.BINSEARCH_UP=new x(1),x.BINSEARCH_DOWN=new x(2);function H(u,l,b,M,r){var p,L=u.CurrentStep[M],P=!1,N=u.OldValue[M],V=x.BINSEARCH_NONE;for(l.global_gain=N,b-=l.part2_length,$0(L!=0);;){var Q;if(p=h.count_bits(u,r,l,null),L==1||p==b)break;p>b?(V==x.BINSEARCH_DOWN&&(P=!0),P&&(L/=2),V=x.BINSEARCH_UP,Q=L):(V==x.BINSEARCH_UP&&(P=!0),P&&(L/=2),V=x.BINSEARCH_DOWN,Q=-L),l.global_gain+=Q,l.global_gain<0&&(l.global_gain=0,P=!0),l.global_gain>255&&(l.global_gain=255,P=!0)}for($0(l.global_gain>=0),$0(l.global_gain<256);p>b&&l.global_gain<255;)l.global_gain++,p=h.count_bits(u,r,l,null);return u.CurrentStep[M]=N-l.global_gain>=4?4:2,u.OldValue[M]=l.global_gain,l.part2_3_length=p,p}this.trancate_smallspectrums=function(u,l,b,M){var r=Rt(_1.SFBMAX);if(!(!(u.substep_shaping&4)&&l.block_type==Qe.SHORT_TYPE||u.substep_shaping&128)){t.calc_noise(l,b,r,new Sa,null);for(var L=0;L<576;L++){var p=0;l.l3_enc[L]!=0&&(p=Math.abs(l.xr[L])),M[L]=p}var L=0,P=8;l.block_type==Qe.SHORT_TYPE&&(P=6);do{var N,V,Q,j,B=l.width[P];if(L+=B,!(r[P]>=1)&&(At.sort(M,L-B,B),!BitStream.EQ(M[L-1],0))){N=(1-r[P])*b[P],V=0,j=0;do{var n;for(Q=1;j+Q<B&&!BitStream.NEQ(M[j+L-B],M[j+L+Q-B]);Q++);if(n=M[j+L-B]*M[j+L-B]*Q,N<n){j!=0&&(V=M[j+L-B-1]);break}N-=n,j+=Q}while(j<B);if(!BitStream.EQ(V,0))do Math.abs(l.xr[L-B])<=V&&(l.l3_enc[L-B]=0);while(--B>0)}}while(++P<l.psymax);l.part2_3_length=h.noquant_count_bits(u,l,null)}};function $(u){for(var l=0;l<u.sfbmax;l++)if(u.scalefac[l]+u.subblock_gain[u.window[l]]==0)return!1;return!0}function y(u){return ya.FAST_LOG10(.368+.632*u*u*u)}function e(u,l){for(var b=1e-37,M=0;M<l.psymax;M++)b+=y(u[M]);return Math.max(1e-20,b)}function a(u,l,b,M,r){var p;switch(u){default:case 9:{l.over_count>0?(p=b.over_SSD<=l.over_SSD,b.over_SSD==l.over_SSD&&(p=b.bits<l.bits)):p=b.max_noise<0&&b.max_noise*10+b.bits<=l.max_noise*10+l.bits;break}case 0:p=b.over_count<l.over_count||b.over_count==l.over_count&&b.over_noise<l.over_noise||b.over_count==l.over_count&&BitStream.EQ(b.over_noise,l.over_noise)&&b.tot_noise<l.tot_noise;break;case 8:b.max_noise=e(r,M);case 1:p=b.max_noise<l.max_noise;break;case 2:p=b.tot_noise<l.tot_noise;break;case 3:p=b.tot_noise<l.tot_noise&&b.max_noise<l.max_noise;break;case 4:p=b.max_noise<=0&&l.max_noise>.2||b.max_noise<=0&&l.max_noise<0&&l.max_noise>b.max_noise-.2&&b.tot_noise<l.tot_noise||b.max_noise<=0&&l.max_noise>0&&l.max_noise>b.max_noise-.2&&b.tot_noise<l.tot_noise+l.over_noise||b.max_noise>0&&l.max_noise>-.05&&l.max_noise>b.max_noise-.1&&b.tot_noise+b.over_noise<l.tot_noise+l.over_noise||b.max_noise>0&&l.max_noise>-.1&&l.max_noise>b.max_noise-.15&&b.tot_noise+b.over_noise+b.over_noise<l.tot_noise+l.over_noise+l.over_noise;break;case 5:p=b.over_noise<l.over_noise||BitStream.EQ(b.over_noise,l.over_noise)&&b.tot_noise<l.tot_noise;break;case 6:p=b.over_noise<l.over_noise||BitStream.EQ(b.over_noise,l.over_noise)&&(b.max_noise<l.max_noise||BitStream.EQ(b.max_noise,l.max_noise)&&b.tot_noise<=l.tot_noise);break;case 7:p=b.over_count<l.over_count||b.over_noise<l.over_noise;break}return l.over_count==0&&(p=p&&b.bits<l.bits),p}function f(u,l,b,M,r){var p=u.internal_flags,L;l.scalefac_scale==0?L=1.2968395546510096:L=1.6817928305074292;for(var P=0,N=0;N<l.sfbmax;N++)P<b[N]&&(P=b[N]);var V=p.noise_shaping_amp;switch(V==3&&(r?V=2:V=1),V){case 2:break;case 1:P>1?P=Math.pow(P,.5):P*=.95;break;case 0:default:P>1?P=1:P*=.95;break}for(var Q=0,N=0;N<l.sfbmax;N++){var j=l.width[N],B;if(Q+=j,!(b[N]<P)){if(p.substep_shaping&2&&(p.pseudohalf[N]=p.pseudohalf[N]==0?1:0,p.pseudohalf[N]==0&&p.noise_shaping_amp==2))return;for(l.scalefac[N]++,B=-j;B<0;B++)M[Q+B]*=L,M[Q+B]>l.xrpow_max&&(l.xrpow_max=M[Q+B]);if(p.noise_shaping_amp==2)return}}}function A(u,l){for(var b=1.2968395546510096,M=0,r=0;r<u.sfbmax;r++){var p=u.width[r],L=u.scalefac[r];if(u.preflag!=0&&(L+=t.pretab[r]),M+=p,L&1){L++;for(var P=-p;P<0;P++)l[M+P]*=b,l[M+P]>u.xrpow_max&&(u.xrpow_max=l[M+P])}u.scalefac[r]=L>>1}u.preflag=0,u.scalefac_scale=1}function k(u,l,b){var M,r=l.scalefac;for(M=0;M<l.sfb_lmax;M++)if(r[M]>=16)return!0;for(var p=0;p<3;p++){var L=0,P=0;for(M=l.sfb_lmax+p;M<l.sfbdivide;M+=3)L<r[M]&&(L=r[M]);for(;M<l.sfbmax;M+=3)P<r[M]&&(P=r[M]);if(!(L<16&&P<8)){if(l.subblock_gain[p]>=7)return!0;l.subblock_gain[p]++;var N=u.scalefac_band.l[l.sfb_lmax];for(M=l.sfb_lmax+p;M<l.sfbmax;M+=3){var V,Q=l.width[M],j=r[M];if($0(j>=0),j=j-(4>>l.scalefac_scale),j>=0){r[M]=j,N+=Q*3;continue}r[M]=0;{var B=210+(j<<l.scalefac_scale+1);V=t.IPOW20(B)}N+=Q*(p+1);for(var n=-Q;n<0;n++)b[N+n]*=V,b[N+n]>l.xrpow_max&&(l.xrpow_max=b[N+n]);N+=Q*(3-p-1)}{var V=t.IPOW20(202);N+=l.width[M]*(p+1);for(var n=-l.width[M];n<0;n++)b[N+n]*=V,b[N+n]>l.xrpow_max&&(l.xrpow_max=b[N+n])}}}return!1}function I(u,l,b,M,r){var p=u.internal_flags;f(u,l,b,M,r);var L=$(l);return L?!1:(p.mode_gr==2?L=h.scale_bitcount(l):L=h.scale_bitcount_lsf(p,l),L?(p.noise_shaping>1&&(At.fill(p.pseudohalf,0),l.scalefac_scale==0?(A(l,M),L=!1):l.block_type==Qe.SHORT_TYPE&&p.subblock_gain>0&&(L=k(p,l,M)||$(l))),L||(p.mode_gr==2?L=h.scale_bitcount(l):L=h.scale_bitcount_lsf(p,l)),!L):!0)}this.outer_loop=function(u,l,b,M,r,p){var L=u.internal_flags,P=new o1,N=Rt(576),V=Rt(_1.SFBMAX),Q=new Sa,j,B=new en,n=9999999,O=!1,q=!1,Z=0;if(H(L,l,p,r,M),L.noise_shaping==0)return 100;t.calc_noise(l,b,V,Q,B),Q.bits=l.part2_3_length,P.assign(l);var G=0;for(st.arraycopy(M,0,N,0,576);!O;){do{var ee=new Sa,D,F=255;if(L.substep_shaping&2?D=20:D=3,L.sfb21_extra&&(V[P.sfbmax]>1||P.block_type==Qe.SHORT_TYPE&&(V[P.sfbmax+1]>1||V[P.sfbmax+2]>1))||!I(u,P,V,M,q))break;P.scalefac_scale!=0&&(F=254);var v=p-P.part2_length;if(v<=0)break;for(;(P.part2_3_length=h.count_bits(L,M,P,B))>v&&P.global_gain<=F;)P.global_gain++;if(P.global_gain>F)break;if(Q.over_count==0){for(;(P.part2_3_length=h.count_bits(L,M,P,B))>n&&P.global_gain<=F;)P.global_gain++;if(P.global_gain>F)break}if(t.calc_noise(P,b,V,ee,B),ee.bits=P.part2_3_length,l.block_type!=Qe.SHORT_TYPE?j=u.quant_comp:j=u.quant_comp_short,j=a(j,Q,ee,P,V)?1:0,j!=0)n=l.part2_3_length,Q=ee,l.assign(P),G=0,st.arraycopy(M,0,N,0,576);else if(L.full_outer_loop==0&&(++G>D&&Q.over_count==0||L.noise_shaping_amp==3&&q&&G>30||L.noise_shaping_amp==3&&q&&P.global_gain-Z>15))break}while(P.global_gain+P.scalefac_scale<255);L.noise_shaping_amp==3?q?O=!0:(P.assign(l),st.arraycopy(N,0,M,0,576),G=0,Z=P.global_gain,q=!0):O=!0}return $0(l.global_gain+l.scalefac_scale<=255),u.VBR==l1.vbr_rh||u.VBR==l1.vbr_mtrh?st.arraycopy(N,0,M,0,576):L.substep_shaping&1&&trancate_smallspectrums(L,l,b,M),Q.over_count},this.iteration_finish_one=function(u,l,b){var M=u.l3_side,r=M.tt[l][b];h.best_scalefac_store(u,l,b,M),u.use_best_huffman==1&&h.best_huffman_divide(u,r),o.ResvAdjust(u,r)},this.VBR_encode_granule=function(u,l,b,M,r,p,L){var P=u.internal_flags,N=new o1,V=Rt(576),Q=L,j=L+1,B=(L+p)/2,n,O,q=0,Z=P.sfb21_extra;$0(Q<=LameInternalFlags.MAX_BITS_PER_CHANNEL),At.fill(N.l3_enc,0);do $0(B>=p),$0(B<=L),$0(p<=L),B>Q-42?P.sfb21_extra=!1:P.sfb21_extra=Z,O=outer_loop(u,l,b,M,r,B),O<=0?(q=1,j=l.part2_3_length,N.assign(l),st.arraycopy(M,0,V,0,576),L=j-32,n=L-p,B=(L+p)/2):(p=B+32,n=L-p,B=(L+p)/2,q!=0&&(q=2,l.assign(N),st.arraycopy(V,0,M,0,576)));while(n>12);P.sfb21_extra=Z,q==2&&st.arraycopy(N.l3_enc,0,l.l3_enc,0,576),$0(l.part2_3_length<=Q)},this.get_framebits=function(u,l){var b=u.internal_flags;b.bitrate_index=b.VBR_min_bitrate;var M=d.getframebits(u);b.bitrate_index=1,M=d.getframebits(u);for(var r=1;r<=b.VBR_max_bitrate;r++){b.bitrate_index=r;var p=new MeanBits(M);l[r]=o.ResvFrameBegin(u,p),M=p.bits}},this.VBR_old_prepare=function(u,l,b,M,r,p,L,P,N){var V=u.internal_flags,Q,j=0,B=1,n=0;V.bitrate_index=V.VBR_max_bitrate;var O=o.ResvFrameBegin(u,new MeanBits(0))/V.mode_gr;get_framebits(u,p);for(var q=0;q<V.mode_gr;q++){var Z=t.on_pe(u,l,P[q],O,q,0);V.mode_ext==Qe.MPG_MD_MS_LR&&(ms_convert(V.l3_side,q),t.reduce_side(P[q],b[q],O,Z));for(var G=0;G<V.channels_out;++G){var ee=V.l3_side.tt[q][G];ee.block_type!=Qe.SHORT_TYPE?(j=1.28/(1+Math.exp(3.5-l[q][G]/300))-.05,Q=V.PSY.mask_adjust-j):(j=2.56/(1+Math.exp(3.5-l[q][G]/300))-.14,Q=V.PSY.mask_adjust_short-j),V.masking_lower=Math.pow(10,Q*.1),init_outer_loop(V,ee),N[q][G]=t.calc_xmin(u,M[q][G],ee,r[q][G]),N[q][G]!=0&&(B=0),L[q][G]=126,n+=P[q][G]}}for(var q=0;q<V.mode_gr;q++)for(var G=0;G<V.channels_out;G++)n>p[V.VBR_max_bitrate]&&(P[q][G]*=p[V.VBR_max_bitrate],P[q][G]/=n),L[q][G]>P[q][G]&&(L[q][G]=P[q][G]);return B},this.bitpressure_strategy=function(u,l,b,M){for(var r=0;r<u.mode_gr;r++)for(var p=0;p<u.channels_out;p++){for(var L=u.l3_side.tt[r][p],P=l[r][p],N=0,V=0;V<L.psy_lmax;V++)P[N++]*=1+.029*V*V/Qe.SBMAX_l/Qe.SBMAX_l;if(L.block_type==Qe.SHORT_TYPE)for(var V=L.sfb_smin;V<Qe.SBMAX_s;V++)P[N++]*=1+.029*V*V/Qe.SBMAX_s/Qe.SBMAX_s,P[N++]*=1+.029*V*V/Qe.SBMAX_s/Qe.SBMAX_s,P[N++]*=1+.029*V*V/Qe.SBMAX_s/Qe.SBMAX_s;M[r][p]=0|Math.max(b[r][p],.9*M[r][p])}},this.VBR_new_prepare=function(u,l,b,M,r,p){var L=u.internal_flags,P=1,N=0,V=0,Q;if(u.free_format){L.bitrate_index=0;var j=new MeanBits(N);Q=o.ResvFrameBegin(u,j),N=j.bits,r[0]=Q}else{L.bitrate_index=L.VBR_max_bitrate;var j=new MeanBits(N);o.ResvFrameBegin(u,j),N=j.bits,get_framebits(u,r),Q=r[L.VBR_max_bitrate]}for(var B=0;B<L.mode_gr;B++){t.on_pe(u,l,p[B],N,B,0),L.mode_ext==Qe.MPG_MD_MS_LR&&ms_convert(L.l3_side,B);for(var n=0;n<L.channels_out;++n){var O=L.l3_side.tt[B][n];L.masking_lower=Math.pow(10,L.PSY.mask_adjust*.1),init_outer_loop(L,O),t.calc_xmin(u,b[B][n],O,M[B][n])!=0&&(P=0),V+=p[B][n]}}for(var B=0;B<L.mode_gr;B++)for(var n=0;n<L.channels_out;n++)V>Q&&(p[B][n]*=Q,p[B][n]/=V);return P},this.calc_target_bits=function(u,l,b,M,r,p){var L=u.internal_flags,P=L.l3_side,N,V,Q,j,B=0;L.bitrate_index=L.VBR_max_bitrate;var n=new MeanBits(B);for(p[0]=o.ResvFrameBegin(u,n),B=n.bits,L.bitrate_index=1,B=d.getframebits(u)-L.sideinfo_len*8,r[0]=B/(L.mode_gr*L.channels_out),B=u.VBR_mean_bitrate_kbps*u.framesize*1e3,L.substep_shaping&1&&(B*=1.09),B/=u.out_samplerate,B-=L.sideinfo_len*8,B/=L.mode_gr*L.channels_out,N=.93+.07*(11-u.compression_ratio)/(11-5.5),N<.9&&(N=.9),N>1&&(N=1),V=0;V<L.mode_gr;V++){var O=0;for(Q=0;Q<L.channels_out;Q++){if(M[V][Q]=int(N*B),l[V][Q]>700){var q=int((l[V][Q]-700)/1.4),Z=P.tt[V][Q];M[V][Q]=int(N*B),Z.block_type==Qe.SHORT_TYPE&&q<B/2&&(q=B/2),q>B*3/2?q=B*3/2:q<0&&(q=0),M[V][Q]+=q}M[V][Q]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(M[V][Q]=LameInternalFlags.MAX_BITS_PER_CHANNEL),O+=M[V][Q]}if(O>LameInternalFlags.MAX_BITS_PER_GRANULE)for(Q=0;Q<L.channels_out;++Q)M[V][Q]*=LameInternalFlags.MAX_BITS_PER_GRANULE,M[V][Q]/=O}if(L.mode_ext==Qe.MPG_MD_MS_LR)for(V=0;V<L.mode_gr;V++)t.reduce_side(M[V],b[V],B*L.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(j=0,V=0;V<L.mode_gr;V++)for(Q=0;Q<L.channels_out;Q++)M[V][Q]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(M[V][Q]=LameInternalFlags.MAX_BITS_PER_CHANNEL),j+=M[V][Q];if(j>p[0])for(V=0;V<L.mode_gr;V++)for(Q=0;Q<L.channels_out;Q++)M[V][Q]*=p[0],M[V][Q]/=j}}var an=tn,rn=t0,Dt=rn.assert;function nn(){var d;this.setModules=function(o){d=o},this.ResvFrameBegin=function(o,t){var s=o.internal_flags,h,S=s.l3_side,c=d.getframebits(o);t.bits=(c-s.sideinfo_len*8)/s.mode_gr;var x=8*256*s.mode_gr-8;o.brate>320?h=8*int(o.brate*1e3/(o.out_samplerate/1152)/8+.5):(h=8*1440,o.strict_ISO&&(h=8*int(32e4/(o.out_samplerate/1152)/8+.5))),s.ResvMax=h-c,s.ResvMax>x&&(s.ResvMax=x),(s.ResvMax<0||o.disable_reservoir)&&(s.ResvMax=0);var H=t.bits*s.mode_gr+Math.min(s.ResvSize,s.ResvMax);return H>h&&(H=h),Dt(s.ResvMax%8==0),Dt(s.ResvMax>=0),S.resvDrain_pre=0,s.pinfo!=null&&(s.pinfo.mean_bits=t.bits/2,s.pinfo.resvsize=s.ResvSize),H},this.ResvMaxBits=function(o,t,s,h){var S=o.internal_flags,c,x=S.ResvSize,H=S.ResvMax;h!=0&&(x+=t),S.substep_shaping&1&&(H*=.9),s.bits=t,x*10>H*9?(c=x-H*9/10,s.bits+=c,S.substep_shaping|=128):(c=0,S.substep_shaping&=127,!o.disable_reservoir&&!(S.substep_shaping&1)&&(s.bits-=.1*t));var $=x<S.ResvMax*6/10?x:S.ResvMax*6/10;return $-=c,$<0&&($=0),$},this.ResvAdjust=function(o,t){o.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(o,t){var s,h=o.l3_side;o.ResvSize+=t*o.mode_gr;var S=0;h.resvDrain_post=0,h.resvDrain_pre=0,(s=o.ResvSize%8)!=0&&(S+=s),s=o.ResvSize-S-o.ResvMax,s>0&&(Dt(s%8==0),Dt(s>=0),S+=s);{var c=Math.min(h.main_data_begin*8,S)/8;h.resvDrain_pre+=8*c,S-=8*c,o.ResvSize-=8*c,h.main_data_begin-=c}h.resvDrain_post+=S,o.ResvSize-=S}}var sn=nn;function ln(){var d="http://www.mp3dev.org/",o=3,t=98,s=4,h=0,S=93;this.getLameVersion=function(){return o+"."+t+"."+s},this.getLameShortVersion=function(){return o+"."+t+"."+s},this.getLameVeryShortVersion=function(){return"LAME"+o+"."+t+"r"},this.getPsyVersion=function(){return h+"."+S},this.getLameUrl=function(){return d},this.getLameOsBitness=function(){return"32bits"}}var on=ln,F0=t0,_n=F0.System,wa=F0.VbrMode;F0.Float;var u1=F0.ShortBlock;F0.Util;var un=F0.Arrays;F0.new_array_n;var Pt=F0.new_byte;F0.new_double;F0.new_float;F0.new_float_n;F0.new_int;F0.new_int_n;var fn=F0.assert;Et.NUMTOCENTRIES=100;Et.MAXFRAMESIZE=2880;function Et(){var d,o,t;this.setModules=function(B,n,O){d=B,o=n,t=O};var s=1,h=2,S=4,c=8,x=Et.NUMTOCENTRIES,H=Et.MAXFRAMESIZE,$=x+4+4+4+4+4,y=$+9+1+1+8+1+1+3+1+1+2+4+2+2,e=128,a=64,f=32,A=null,k="Xing",I="Info",u=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function l(B,n){if(B.nVbrNumFrames++,B.sum+=n,B.seen++,!(B.seen<B.want)&&(B.pos<B.size&&(B.bag[B.pos]=B.sum,B.pos++,B.seen=0),B.pos==B.size)){for(var O=1;O<B.size;O+=2)B.bag[O/2]=B.bag[O];B.want*=2,B.pos/=2}}function b(B,n){if(!(B.pos<=0))for(var O=1;O<x;++O){var q=O/x,Z,G,ee=0|Math.floor(q*B.pos);ee>B.pos-1&&(ee=B.pos-1),Z=B.bag[ee],G=B.sum;var D=0|256*Z/G;D>255&&(D=255),n[O]=255&D}}this.addVbrFrame=function(B){var n=B.internal_flags,O=Tables.bitrate_table[B.version][n.bitrate_index];fn(n.VBR_seek_table.bag!=null),l(n.VBR_seek_table,O)};function M(B,n){var O=B[n+0]&255;return O<<=8,O|=B[n+1]&255,O<<=8,O|=B[n+2]&255,O<<=8,O|=B[n+3]&255,O}function r(B,n,O){B[n+0]=255&(O>>24&255),B[n+1]=255&(O>>16&255),B[n+2]=255&(O>>8&255),B[n+3]=255&(O&255)}function p(B,n,O){B[n+0]=255&(O>>8&255),B[n+1]=255&(O&255)}function L(B,n){return new String(B,n,k.length(),A).equals(k)||new String(B,n,I.length(),A).equals(I)}function P(B,n,O){return 255&(B<<n|O&~(-1<<n))}function N(B,n){var O=B.internal_flags;n[0]=P(n[0],8,255),n[1]=P(n[1],3,7),n[1]=P(n[1],1,B.out_samplerate<16e3?0:1),n[1]=P(n[1],1,B.version),n[1]=P(n[1],2,4-3),n[1]=P(n[1],1,B.error_protection?0:1),n[2]=P(n[2],4,O.bitrate_index),n[2]=P(n[2],2,O.samplerate_index),n[2]=P(n[2],1,0),n[2]=P(n[2],1,B.extension),n[3]=P(n[3],2,B.mode.ordinal()),n[3]=P(n[3],2,O.mode_ext),n[3]=P(n[3],1,B.copyright),n[3]=P(n[3],1,B.original),n[3]=P(n[3],2,B.emphasis),n[0]=255;var q=255&(n[1]&241),Z;B.version==1?Z=e:B.out_samplerate<16e3?Z=f:Z=a,B.VBR==wa.vbr_off&&(Z=B.brate);var G;B.free_format?G=0:G=255&16*d.BitrateIndex(Z,B.version,B.out_samplerate),B.version==1?(n[1]=255&(q|10),q=255&(n[2]&13),n[2]=255&(G|q)):(n[1]=255&(q|2),q=255&(n[2]&13),n[2]=255&(G|q))}this.getVbrTag=function(B){var n=new VBRTagData,O=0;n.flags=0;var q=B[O+1]>>3&1,Z=B[O+2]>>2&3,G=B[O+3]>>6&3,ee=B[O+2]>>4&15;if(ee=Tables.bitrate_table[q][ee],B[O+1]>>4==14?n.samprate=Tables.samplerate_table[2][Z]:n.samprate=Tables.samplerate_table[q][Z],q!=0?G!=3?O+=32+4:O+=17+4:G!=3?O+=17+4:O+=9+4,!L(B,O))return null;O+=4,n.hId=q;var D=n.flags=M(B,O);if(O+=4,D&s&&(n.frames=M(B,O),O+=4),D&h&&(n.bytes=M(B,O),O+=4),D&S){if(n.toc!=null)for(var F=0;F<x;F++)n.toc[F]=B[O+F];O+=x}n.vbrScale=-1,D&c&&(n.vbrScale=M(B,O),O+=4),n.headersize=(q+1)*72e3*ee/n.samprate,O+=21;var v=B[O+0]<<4;v+=B[O+1]>>4;var m=(B[O+1]&15)<<8;return m+=B[O+2]&255,(v<0||v>3e3)&&(v=-1),(m<0||m>3e3)&&(m=-1),n.encDelay=v,n.encPadding=m,n},this.InitVbrTag=function(B){var n=B.internal_flags,O;B.version==1?O=e:B.out_samplerate<16e3?O=f:O=a,B.VBR==wa.vbr_off&&(O=B.brate);var q=(B.version+1)*72e3*O/B.out_samplerate,Z=n.sideinfo_len+y;if(n.VBR_seek_table.TotalFrameSize=q,q<Z||q>H){B.bWriteVbrTag=!1;return}n.VBR_seek_table.nVbrNumFrames=0,n.VBR_seek_table.nBytesWritten=0,n.VBR_seek_table.sum=0,n.VBR_seek_table.seen=0,n.VBR_seek_table.want=1,n.VBR_seek_table.pos=0,n.VBR_seek_table.bag==null&&(n.VBR_seek_table.bag=new int[400],n.VBR_seek_table.size=400);var G=Pt(H);N(B,G);for(var ee=n.VBR_seek_table.TotalFrameSize,D=0;D<ee;++D)o.add_dummy_byte(B,G[D]&255,1)};function V(B,n){var O=n^B;return n=n>>8^u[O&255],n}this.updateMusicCRC=function(B,n,O,q){for(var Z=0;Z<q;++Z)B[0]=V(n[O+Z],B[0])};function Q(B,n,O,q,Z){var G=B.internal_flags,ee=0,D=B.encoder_delay,F=B.encoder_padding,v=100-10*B.VBR_q-B.quality,m=t.getLameVeryShortVersion(),i,T=0,K,ne=[1,5,3,2,4,0,3],g=0|(B.lowpassfreq/100+.5>255?255:B.lowpassfreq/100+.5),Y=0,re=0,_e=0,he=B.internal_flags.noise_shaping,ke=0,Se=0,be=0,Le=0,$e=0,c0=(B.exp_nspsytune&1)!=0,_=(B.exp_nspsytune&2)!=0,w=!1,xe=!1,Re=B.internal_flags.nogap_total,Xe=B.internal_flags.nogap_current,Fe=B.ATHtype,Ie=0,Be;switch(B.VBR){case vbr_abr:Be=B.VBR_mean_bitrate_kbps;break;case vbr_off:Be=B.brate;break;default:Be=B.VBR_min_bitrate_kbps}switch(B.VBR.ordinal()<ne.length?i=ne[B.VBR.ordinal()]:i=0,K=16*T+i,G.findReplayGain&&(G.RadioGain>510&&(G.RadioGain=510),G.RadioGain<-510&&(G.RadioGain=-510),re=8192,re|=3072,G.RadioGain>=0?re|=G.RadioGain:(re|=512,re|=-G.RadioGain)),G.findPeakSample&&(Y=Math.abs(0|G.PeakSample/32767*Math.pow(2,23)+.5)),Re!=-1&&(Xe>0&&(xe=!0),Xe<Re-1&&(w=!0)),Ie=Fe+((c0?1:0)<<4)+((_?1:0)<<5)+((w?1:0)<<6)+((xe?1:0)<<7),v<0&&(v=0),B.mode){case MONO:ke=0;break;case STEREO:ke=1;break;case DUAL_CHANNEL:ke=2;break;case JOINT_STEREO:B.force_ms?ke=4:ke=3;break;case NOT_SET:default:ke=7;break}B.in_samplerate<=32e3?be=0:B.in_samplerate==48e3?be=2:B.in_samplerate>48e3?be=3:be=1,(B.short_blocks==u1.short_block_forced||B.short_blocks==u1.short_block_dispensed||B.lowpassfreq==-1&&B.highpassfreq==-1||B.scale_left<B.scale_right||B.scale_left>B.scale_right||B.disable_reservoir&&B.brate<320||B.noATH||B.ATHonly||Fe==0||B.in_samplerate<=32e3)&&(Se=1),Le=he+(ke<<2)+(Se<<5)+(be<<6),$e=G.nMusicCRC,r(O,q+ee,v),ee+=4;for(var Pe=0;Pe<9;Pe++)O[q+ee+Pe]=255&m.charAt(Pe);ee+=9,O[q+ee]=255&K,ee++,O[q+ee]=255&g,ee++,r(O,q+ee,Y),ee+=4,p(O,q+ee,re),ee+=2,p(O,q+ee,_e),ee+=2,O[q+ee]=255&Ie,ee++,Be>=255?O[q+ee]=255:O[q+ee]=255&Be,ee++,O[q+ee]=255&D>>4,O[q+ee+1]=255&(D<<4)+(F>>8),O[q+ee+2]=255&F,ee+=3,O[q+ee]=255&Le,ee++,O[q+ee++]=0,p(O,q+ee,B.preset),ee+=2,r(O,q+ee,n),ee+=4,p(O,q+ee,$e),ee+=2;for(var Ce=0;Ce<ee;Ce++)Z=V(O[q+Ce],Z);return p(O,q+ee,Z),ee+=2,ee}function j(B){B.seek(0);var n=Pt(10);B.readFully(n);var O;return new String(n,"ISO-8859-1").startsWith("ID3")?O=0:O=((n[6]&127)<<21|(n[7]&127)<<14|(n[8]&127)<<7|n[9]&127)+n.length,O}this.getLameTagFrame=function(B,n){var O=B.internal_flags;if(!B.bWriteVbrTag||O.Class_ID!=Lame.LAME_ID||O.VBR_seek_table.pos<=0)return 0;if(n.length<O.VBR_seek_table.TotalFrameSize)return O.VBR_seek_table.TotalFrameSize;un.fill(n,0,O.VBR_seek_table.TotalFrameSize,0),N(B,n);var q=Pt(x);if(B.free_format)for(var Z=1;Z<x;++Z)q[Z]=255&255*Z/100;else b(O.VBR_seek_table,q);var G=O.sideinfo_len;B.error_protection&&(G-=2),B.VBR==wa.vbr_off?(n[G++]=255&I.charAt(0),n[G++]=255&I.charAt(1),n[G++]=255&I.charAt(2),n[G++]=255&I.charAt(3)):(n[G++]=255&k.charAt(0),n[G++]=255&k.charAt(1),n[G++]=255&k.charAt(2),n[G++]=255&k.charAt(3)),r(n,G,s+h+S+c),G+=4,r(n,G,O.VBR_seek_table.nVbrNumFrames),G+=4;var ee=O.VBR_seek_table.nBytesWritten+O.VBR_seek_table.TotalFrameSize;r(n,G,0|ee),G+=4,_n.arraycopy(q,0,n,G,q.length),G+=q.length,B.error_protection&&o.CRC_writeheader(O,n);for(var D=0,Z=0;Z<G;Z++)D=V(n[Z],D);return G+=Q(B,ee,n,G,D),O.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(B,n){var O=B.internal_flags;if(O.VBR_seek_table.pos<=0||(n.seek(n.length()),n.length()==0))return-1;var q=j(n);n.seek(q);var Z=Pt(H),G=getLameTagFrame(B,Z);return G>Z.length?-1:(G<1||n.write(Z,0,G),0)}}var vn=Et,X0=t0;X0.System;X0.VbrMode;X0.Float;X0.ShortBlock;X0.Util;X0.Arrays;X0.new_array_n;var f1=X0.new_byte;X0.new_double;X0.new_float;X0.new_float_n;X0.new_int;X0.new_int_n;var v1=X0.assert,cn=Ca(),dn=$r,hn=D1,mn=G1(),bn=an,pn=q1(),An=sn,yn=Ct,Sn=La();b0();var wn=on,xn=vn;function Tn(){this.setModules=function(d,o){}}function Mn(){this.setModules=function(d,o,t){}}function Rn(){}function En(){this.setModules=function(d,o){}}function Bn(d,o,t){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),d=1,o=44100,t=128);var s=new cn,h=new Tn,S=new hn,c=new Sn,x=new dn,H=new mn,$=new bn,y=new xn,e=new wn,a=new En,f=new An,A=new pn,k=new Mn,I=new Rn;s.setModules(S,c,x,H,$,y,e,a,I),c.setModules(S,I,e,y),a.setModules(c,e),x.setModules(s),$.setModules(c,f,H,A),H.setModules(A,f,s.enc.psy),f.setModules(c),A.setModules(H),y.setModules(s,c,e),h.setModules(k,I),k.setModules(e,a,x);var u=s.lame_init();u.num_channels=d,u.in_samplerate=o,u.brate=t,u.mode=yn.STEREO,u.quality=3,u.bWriteVbrTag=!1,u.disable_reservoir=!0,u.write_id3tag_automatic=!1;var l=s.lame_init_params(u);v1(l==0);var b=1152,M=0|1.25*b+7200,r=f1(M);this.encodeBuffer=function(p,L){d==1&&(L=p),v1(p.length==L.length),p.length>b&&(b=p.length,M=0|1.25*b+7200,r=f1(M));var P=s.lame_encode_buffer(u,p,L,p.length,r,0,M);return new Int8Array(r.subarray(0,P))},this.flush=function(){var p=s.lame_encode_flush(u,r,0,M);return new Int8Array(r.subarray(0,p))}}function tt(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function ea(d){return d.charCodeAt(0)<<24|d.charCodeAt(1)<<16|d.charCodeAt(2)<<8|d.charCodeAt(3)}tt.RIFF=ea("RIFF");tt.WAVE=ea("WAVE");tt.fmt_=ea("fmt ");tt.data=ea("data");tt.readHeader=function(d){var o=new tt,t=d.getUint32(0,!1);if(tt.RIFF==t&&(d.getUint32(4,!0),tt.WAVE==d.getUint32(8,!1)&&tt.fmt_==d.getUint32(12,!1))){var s=d.getUint32(16,!0),h=16+4;switch(s){case 16:case 18:o.channels=d.getUint16(h+2,!0),o.sampleRate=d.getUint32(h+4,!0);break;default:throw"extended fmt chunk not implemented"}h+=s;for(var S=tt.data,c=0;S!=t&&(t=d.getUint32(h,!1),c=d.getUint32(h+4,!0),S!=t);)h+=c+8;return o.dataLen=c,o.dataOffset=h+8,o}};var In=Bn;const Y1=R1(!0),Ma=dt(""),Ra=dt(""),Ea=dt(!1),kn=dt(!0),Kt=dt(!1),ta=[{name:"English",code:"en",voice:"en-US-Neural2-J",voiceCode:"en-US",emoji:""},{name:"German",code:"de",voice:"de-DE-Neural2-B",voiceCode:"de-DE",emoji:""},{name:"French",code:"fr",voice:"fr-FR-Neural2-D",voiceCode:"fr-FR",emoji:""},{name:"Italian",code:"it",voice:"it-IT-Neural2-C",voiceCode:"it-IT",emoji:""},{name:"Spanish",code:"es",voice:"es-ES-Neural2-F",voiceCode:"es-ES",emoji:""},{name:"Portuguese",code:"pt",voice:"pt-BR-Neural2-A",voiceCode:"pt-BR",emoji:""},{name:"Russian",code:"ru",voice:"ru-RU-Wavenet-D",voiceCode:"ru-RU",emoji:""}],Qt=dt(ta[0]),Ln=dt(ta[0].name),Cn=R1(ta);Ln.subscribe(d=>{let o=ta.find(t=>t.name===d);o!=null&&Qt.set(o)});var On=Wt;function Wt(){}Wt.mixin=function(d){var o=d.prototype||d;o.isWildEmitter=!0,o.on=function(t,s,h){this.callbacks=this.callbacks||{};var S=arguments.length===3,c=S?arguments[1]:void 0,x=S?arguments[2]:arguments[1];return x._groupName=c,(this.callbacks[t]=this.callbacks[t]||[]).push(x),this},o.once=function(t,s,h){var S=this,c=arguments.length===3,x=c?arguments[1]:void 0,H=c?arguments[2]:arguments[1];function $(){S.off(t,$),H.apply(this,arguments)}return this.on(t,x,$),this},o.releaseGroup=function(t){this.callbacks=this.callbacks||{};var s,h,S,c;for(s in this.callbacks)for(c=this.callbacks[s],h=0,S=c.length;h<S;h++)c[h]._groupName===t&&(c.splice(h,1),h--,S--);return this},o.off=function(t,s){this.callbacks=this.callbacks||{};var h=this.callbacks[t],S;return h?arguments.length===1?(delete this.callbacks[t],this):(S=h.indexOf(s),S!==-1&&(h.splice(S,1),h.length===0&&delete this.callbacks[t]),this):this},o.emit=function(t){this.callbacks=this.callbacks||{};var s=[].slice.call(arguments,1),h=this.callbacks[t],S=this.getWildcardCallbacks(t),c,x,H;if(h)for(H=h.slice(),c=0,x=H.length;c<x&&H[c];++c)H[c].apply(this,s);if(S)for(x=S.length,H=S.slice(),c=0,x=H.length;c<x&&H[c];++c)H[c].apply(this,[t].concat(s));return this},o.getWildcardCallbacks=function(t){this.callbacks=this.callbacks||{};var s,h,S=[];for(s in this.callbacks)h=s.split("*"),(s==="*"||h.length===2&&t.slice(0,h[0].length)===h[0])&&(S=S.concat(this.callbacks[s]));return S}};Wt.mixin(Wt);var Hn=On;function Vn(d,o){var t=-1/0;d.getFloatFrequencyData(o);for(var s=4,h=o.length;s<h;s++)o[s]>t&&o[s]<0&&(t=o[s]);return t}var Ba;typeof window<"u"&&(Ba=window.AudioContext||window.webkitAudioContext);var j0=null,Nn=function(d,s){var t=new Hn;if(!Ba)return t;var s=s||{},h=s.smoothing||.1,S=s.interval||50,c=s.threshold,x=s.play,H=s.history||10,$=!0;j0=s.audioContext||j0||new Ba;var y,e,a;a=j0.createAnalyser(),a.fftSize=512,a.smoothingTimeConstant=h,e=new Float32Array(a.frequencyBinCount),d.jquery&&(d=d[0]),d instanceof HTMLAudioElement||d instanceof HTMLVideoElement?(y=j0.createMediaElementSource(d),typeof x>"u"&&(x=!0),c=c||-50):(y=j0.createMediaStreamSource(d),c=c||-50),y.connect(a),x&&a.connect(j0.destination),t.speaking=!1,t.suspend=function(){return j0.suspend()},t.resume=function(){return j0.resume()},Object.defineProperty(t,"state",{get:function(){return j0.state}}),j0.onstatechange=function(){t.emit("state_change",j0.state)},t.setThreshold=function(k){c=k},t.setInterval=function(k){S=k},t.stop=function(){$=!1,t.emit("volume_change",-100,c),t.speaking&&(t.speaking=!1,t.emit("stopped_speaking")),a.disconnect(),y.disconnect()},t.speakingHistory=[];for(var f=0;f<H;f++)t.speakingHistory.push(0);var A=function(){setTimeout(function(){if($){var k=Vn(a,e);t.emit("volume_change",k,c);var I=0;if(k>c&&!t.speaking){for(var u=t.speakingHistory.length-3;u<t.speakingHistory.length;u++)I+=t.speakingHistory[u];I>=2&&(t.speaking=!0,t.emit("speaking"))}else if(k<c&&t.speaking){for(var u=0;u<t.speakingHistory.length;u++)I+=t.speakingHistory[u];I==0&&(t.speaking=!1,t.emit("stopped_speaking"))}t.speakingHistory.shift(),t.speakingHistory.push(0+(k>c)),A()}},S)};return A(),t};const Fn=J1(Nn);function Xn(d){let o,t,s,h,S,c,x;return{c(){o=qe("button"),t=l0("svg"),s=l0("path"),h=l0("path"),this.h()},l(H){o=Ye(H,"BUTTON",{class:!0});var $=He(o);t=o0($,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var y=He(t);s=o0(y,"path",{d:!0}),He(s).forEach(we),h=o0(y,"path",{d:!0}),He(h).forEach(we),y.forEach(we),$.forEach(we),this.h()},h(){de(s,"d","M8.25 4.5a3.75 3.75 0 117.5 0v8.25a3.75 3.75 0 11-7.5 0V4.5z"),de(h,"d","M6 10.5a.75.75 0 01.75.75v1.5a5.25 5.25 0 1010.5 0v-1.5a.75.75 0 011.5 0v1.5a6.751 6.751 0 01-6 6.709v2.291h3a.75.75 0 010 1.5h-7.5a.75.75 0 010-1.5h3v-2.291a6.751 6.751 0 01-6-6.709v-1.5A.75.75 0 016 10.5z"),de(t,"xmlns","http://www.w3.org/2000/svg"),de(t,"viewBox","0 0 24 24"),de(t,"fill","currentColor"),de(t,"class","w-6 h-6"),de(o,"class",S=`btn ${d[1]?"btn-error":d[0]?"btn-success":""}`)},m(H,$){u0(H,o,$),pe(o,t),pe(t,s),pe(t,h),c||(x=[Z0(o,"mousedown",d[2]),Z0(o,"touchstart",d[2],{passive:!0})],c=!0)},p(H,[$]){$&3&&S!==(S=`btn ${H[1]?"btn-error":H[0]?"btn-success":""}`)&&de(o,"class",S)},i:rt,o:rt,d(H){H&&we(o),c=!1,jt(x)}}}let Dn=500;function Pn(d,o,t){let s=!1,h=!1,S=!1,c=[],x=0,H=null;w1(()=>{H=new In(1,44100,96),document.addEventListener("keydown",M=>{M.target instanceof Element&&M.target.classList.contains("input")||M.key==" "&&f()}),document.addEventListener("keyup",M=>{M.key==" "&&h&&(S=!0)}),Kt.subscribe(M=>{console.log("listenToSpeech",M),M&&f(!0)})});let $,y;const e=async()=>{if($!=null)return;const{default:{RecordRTCPromisesHandler:M,StereoAudioRecorder:r}}=await z1(()=>import("./RecordRTC.495c71c1.js").then(L=>L.R),[],import.meta.url);y=await navigator.mediaDevices.getUserMedia({audio:!0});const p={type:"audio",mimeType:"audio/wav",numberOfAudioChannels:1,bitsPerSecond:96e3,recorderType:r,timeSlice:500,ondataavailable:A};$=new M(y,p)};let a;const f=async(M=!1)=>{if(!(h||s)){console.log("startRecording",{listenOnly:M}),b(),$==null&&await e();try{a&&a.stop(),M?(t(0,s=!0),a=Fn(y,{}),a.on("speaking",()=>{s&&!h&&(t(1,h=!0),x=Date.now())}),a.on("stopped_speaking",()=>{if(s&&h){if(Date.now()-x<Dn){console.log("speech too short"),t(1,h=!1);return}S=!0}})):t(1,h=!0);const r=await $.getState();(r==="inactive"||r==="stopped")&&await $.startRecording(),r==="paused"&&await $.resumeRecording()}catch(r){console.error(r)}}},A=async M=>{const r=await M.arrayBuffer(),p=H.encodeBuffer(new Int16Array(r)),L=new Blob([p],{type:"audio/mpeg"});s&&!h?c=[L]:h&&c.push(L),S&&(S=!1,k()),console.log(c)},k=async()=>{if(!h)return;t(1,h=!1),t(0,s=!1);const M=await $.getState();(M==="recording"||M==="paused")&&await $.stopRecording();let r=new Blob(c,{type:"audio/mpeg"});c=[],await $.destroy(),$=null,l(r)},I=()=>{document.addEventListener("mouseup",u),document.addEventListener("touchend",u),f()},u=()=>{S=!0,document.removeEventListener("mouseup",u),document.removeEventListener("touchend",u)};let{finishedRecording:l}=o,{startedRecording:b}=o;return d.$$set=M=>{"finishedRecording"in M&&t(4,l=M.finishedRecording),"startedRecording"in M&&t(5,b=M.startedRecording)},[s,h,I,f,l,b]}class Gn extends Bt{constructor(o){super(),It(this,o,Pn,Xn,kt,{startRecording:3,finishedRecording:4,startedRecording:5})}get startRecording(){return this.$$.ctx[3]}}function qn(d){let o,t,s,h,S,c,x;return H(),{feed:$,reset:H};function H(){o=!0,t="",s=0,h=-1,S=void 0,c=void 0,x=""}function $(e){t=t?t+e:e,o&&Yn(t)&&(t=t.slice(U1.length)),o=!1;const a=t.length;let f=0,A=!1;for(;f<a;){A&&(t[f]===`
`&&++f,A=!1);let k=-1,I=h,u;for(let l=s;k<0&&l<a;++l)u=t[l],u===":"&&I<0?I=l-f:u==="\r"?(A=!0,k=l-f):u===`
`&&(k=l-f);if(k<0){s=a-f,h=I;break}else s=0,h=-1;y(t,f,I,k),f+=k+1}f===a?t="":f>0&&(t=t.slice(f))}function y(e,a,f,A){if(A===0){x.length>0&&(d({type:"event",id:S,event:c||void 0,data:x.slice(0,-1)}),x="",S=void 0),c=void 0;return}const k=f<0,I=e.slice(a,a+(k?A:f));let u=0;k?u=A:e[a+f+1]===" "?u=f+2:u=f+1;const l=a+u,b=A-u,M=e.slice(l,l+b).toString();if(I==="data")x+=M?"".concat(M,`
`):`
`;else if(I==="event")c=M;else if(I==="id"&&!M.includes("\0"))S=M;else if(I==="retry"){const r=parseInt(M,10);Number.isNaN(r)||d({type:"reconnect-interval",value:r})}}}const U1=[239,187,191];function Yn(d){return U1.every((o,t)=>d.charCodeAt(t)===o)}async function Un(d,o){const t=new TextEncoder,s=new TextDecoder;let h=0;const S={"Content-Type":"application/json",Authorization:`Bearer ${o??""}`},c=await fetch("https://api.openai.com/v1/chat/completions",{headers:S,method:"POST",body:JSON.stringify(d)});return new ReadableStream({async start(H){function $(a){var f;if(a.type==="event"){const A=a.data;if(A==="[DONE]"){H.close();return}try{const I=((f=JSON.parse(A).choices[0].delta)==null?void 0:f.content)||"";if(h<2&&(I.match(/\n/)||[]).length)return;const u=t.encode(I);H.enqueue(u),h++}catch(k){H.error(k)}}}const y=qn($),e=c.body.getReader();for(;;){const{done:a,value:f}=await e.read();if(a)break;y.feed(s.decode(f))}}})}const $n=async(d,o,t=.7,s=100)=>{const S=await Un({model:"gpt-3.5-turbo",messages:d,temperature:t,max_tokens:s,top_p:1,frequency_penalty:0,presence_penalty:0,stream:!0,n:1},o);return new Response(S)},Zn=async(d,o,t="en-US",s="en-US-Neural2-J")=>{const h=`https://texttospeech.googleapis.com/v1/text:synthesize?key=${o}`;try{const c=await(await fetch(h,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({input:{text:d},voice:{languageCode:t??"en-US",name:s??"en-US-Neural2-J"},audioConfig:{audioEncoding:"MP3"}})})).json();return new Response(JSON.stringify(c))}catch(S){console.error(`Error synthesizing text: ${S}`)}return new Response(JSON.stringify({}))},Kn=async(d,o,t="en")=>{const s=new FormData;s.append("file",d,"test.wav"),s.append("model","whisper-1"),s.append("language",t);const S=await(await fetch("https://api.openai.com/v1/audio/transcriptions",{method:"POST",headers:{Authorization:`Bearer ${o}`,Accept:"application/json"},body:s})).json(),c=(S==null?void 0:S.text)||"";return new Response(JSON.stringify({transcribedText:c}))};var $1={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(d){(function(){var o=function(){this.init()};o.prototype={init:function(){var e=this||t;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var a=this||t;if(e=parseFloat(e),a.ctx||y(),typeof e<"u"&&e>=0&&e<=1){if(a._volume=e,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(var f=0;f<a._howls.length;f++)if(!a._howls[f]._webAudio)for(var A=a._howls[f]._getSoundIds(),k=0;k<A.length;k++){var I=a._howls[f]._soundById(A[k]);I&&I._node&&(I._node.volume=I._volume*e)}return a}return a._volume},mute:function(e){var a=this||t;a.ctx||y(),a._muted=e,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(e?0:a._volume,t.ctx.currentTime);for(var f=0;f<a._howls.length;f++)if(!a._howls[f]._webAudio)for(var A=a._howls[f]._getSoundIds(),k=0;k<A.length;k++){var I=a._howls[f]._soundById(A[k]);I&&I._node&&(I._node.muted=e?!0:I._muted)}return a},stop:function(){for(var e=this||t,a=0;a<e._howls.length;a++)e._howls[a].stop();return e},unload:function(){for(var e=this||t,a=e._howls.length-1;a>=0;a--)e._howls[a].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,y()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var a=new Audio;a.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return e}if(!a||typeof a.canPlayType!="function")return e;var f=a.canPlayType("audio/mpeg;").replace(/^no$/,""),A=e._navigator?e._navigator.userAgent:"",k=A.match(/OPR\/([0-6].)/g),I=k&&parseInt(k[0].split("/")[1],10)<33,u=A.indexOf("Safari")!==-1&&A.indexOf("Chrome")===-1,l=A.match(/Version\/(.*?) /),b=u&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!!(!I&&(f||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||t;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var a=function(f){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var A=new Audio;A._unlocked=!0,e._releaseHtml5Audio(A)}catch{e.noAudio=!0;break}for(var k=0;k<e._howls.length;k++)if(!e._howls[k]._webAudio)for(var I=e._howls[k]._getSoundIds(),u=0;u<I.length;u++){var l=e._howls[k]._soundById(I[u]);l&&l._node&&!l._node._unlocked&&(l._node._unlocked=!0,l._node.load())}e._autoResume();var b=e.ctx.createBufferSource();b.buffer=e._scratchBuffer,b.connect(e.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),b.onended=function(){b.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var M=0;M<e._howls.length;M++)e._howls[M]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),e}},_obtainHtml5Audio:function(){var e=this||t;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var a=this||t;return e._unlocked&&a._html5AudioPool.push(e),a},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!t.usingWebAudio)){for(var a=0;a<e._howls.length;a++)if(e._howls[a]._webAudio){for(var f=0;f<e._howls[a]._sounds.length;f++)if(!e._howls[a]._sounds[f]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var A=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(A,A)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!t.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var a=0;a<e._howls.length;a++)e._howls[a]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var t=new o,s=function(e){var a=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(e)};s.prototype={init:function(e){var a=this;return t.ctx||y(),a._autoplay=e.autoplay||!1,a._format=typeof e.format!="string"?e.format:[e.format],a._html5=e.html5||!1,a._muted=e.mute||!1,a._loop=e.loop||!1,a._pool=e.pool||5,a._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,a._rate=e.rate||1,a._sprite=e.sprite||{},a._src=typeof e.src!="string"?e.src:[e.src],a._volume=e.volume!==void 0?e.volume:1,a._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=e.onend?[{fn:e.onend}]:[],a._onfade=e.onfade?[{fn:e.onfade}]:[],a._onload=e.onload?[{fn:e.onload}]:[],a._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],a._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],a._onpause=e.onpause?[{fn:e.onpause}]:[],a._onplay=e.onplay?[{fn:e.onplay}]:[],a._onstop=e.onstop?[{fn:e.onstop}]:[],a._onmute=e.onmute?[{fn:e.onmute}]:[],a._onvolume=e.onvolume?[{fn:e.onvolume}]:[],a._onrate=e.onrate?[{fn:e.onrate}]:[],a._onseek=e.onseek?[{fn:e.onseek}]:[],a._onunlock=e.onunlock?[{fn:e.onunlock}]:[],a._onresume=[],a._webAudio=t.usingWebAudio&&!a._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var e=this,a=null;if(t.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var f=0;f<e._src.length;f++){var A,k;if(e._format&&e._format[f])A=e._format[f];else{if(k=e._src[f],typeof k!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}A=/^data:audio\/([^;,]+);/i.exec(k),A||(A=/\.([^.]+)$/.exec(k.split("?",1)[0])),A&&(A=A[1].toLowerCase())}if(A||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),A&&t.codecs(A)){a=e._src[f];break}}if(!a){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=a,e._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new h(e),e._webAudio&&c(e),e},play:function(e,a){var f=this,A=null;if(typeof e=="number")A=e,e=null;else{if(typeof e=="string"&&f._state==="loaded"&&!f._sprite[e])return null;if(typeof e>"u"&&(e="__default",!f._playLock)){for(var k=0,I=0;I<f._sounds.length;I++)f._sounds[I]._paused&&!f._sounds[I]._ended&&(k++,A=f._sounds[I]._id);k===1?e=null:A=null}}var u=A?f._soundById(A):f._inactiveSound();if(!u)return null;if(A&&!e&&(e=u._sprite||"__default"),f._state!=="loaded"){u._sprite=e,u._ended=!1;var l=u._id;return f._queue.push({event:"play",action:function(){f.play(l)}}),l}if(A&&!u._paused)return a||f._loadQueue("play"),u._id;f._webAudio&&t._autoResume();var b=Math.max(0,u._seek>0?u._seek:f._sprite[e][0]/1e3),M=Math.max(0,(f._sprite[e][0]+f._sprite[e][1])/1e3-b),r=M*1e3/Math.abs(u._rate),p=f._sprite[e][0]/1e3,L=(f._sprite[e][0]+f._sprite[e][1])/1e3;u._sprite=e,u._ended=!1;var P=function(){u._paused=!1,u._seek=b,u._start=p,u._stop=L,u._loop=!!(u._loop||f._sprite[e][2])};if(b>=L){f._ended(u);return}var N=u._node;if(f._webAudio){var V=function(){f._playLock=!1,P(),f._refreshBuffer(u);var n=u._muted||f._muted?0:u._volume;N.gain.setValueAtTime(n,t.ctx.currentTime),u._playStart=t.ctx.currentTime,typeof N.bufferSource.start>"u"?u._loop?N.bufferSource.noteGrainOn(0,b,86400):N.bufferSource.noteGrainOn(0,b,M):u._loop?N.bufferSource.start(0,b,86400):N.bufferSource.start(0,b,M),r!==1/0&&(f._endTimers[u._id]=setTimeout(f._ended.bind(f,u),r)),a||setTimeout(function(){f._emit("play",u._id),f._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?V():(f._playLock=!0,f.once("resume",V),f._clearTimer(u._id))}else{var Q=function(){N.currentTime=b,N.muted=u._muted||f._muted||t._muted||N.muted,N.volume=u._volume*t.volume(),N.playbackRate=u._rate;try{var n=N.play();if(n&&typeof Promise<"u"&&(n instanceof Promise||typeof n.then=="function")?(f._playLock=!0,P(),n.then(function(){f._playLock=!1,N._unlocked=!0,a?f._loadQueue():f._emit("play",u._id)}).catch(function(){f._playLock=!1,f._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),u._ended=!0,u._paused=!0})):a||(f._playLock=!1,P(),f._emit("play",u._id)),N.playbackRate=u._rate,N.paused){f._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||u._loop?f._endTimers[u._id]=setTimeout(f._ended.bind(f,u),r):(f._endTimers[u._id]=function(){f._ended(u),N.removeEventListener("ended",f._endTimers[u._id],!1)},N.addEventListener("ended",f._endTimers[u._id],!1))}catch(O){f._emit("playerror",u._id,O)}};N.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(N.src=f._src,N.load());var j=window&&window.ejecta||!N.readyState&&t._navigator.isCocoonJS;if(N.readyState>=3||j)Q();else{f._playLock=!0,f._state="loading";var B=function(){f._state="loaded",Q(),N.removeEventListener(t._canPlayEvent,B,!1)};N.addEventListener(t._canPlayEvent,B,!1),f._clearTimer(u._id)}}return u._id},pause:function(e){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(e)}}),a;for(var f=a._getSoundIds(e),A=0;A<f.length;A++){a._clearTimer(f[A]);var k=a._soundById(f[A]);if(k&&!k._paused&&(k._seek=a.seek(f[A]),k._rateSeek=0,k._paused=!0,a._stopFade(f[A]),k._node))if(a._webAudio){if(!k._node.bufferSource)continue;typeof k._node.bufferSource.stop>"u"?k._node.bufferSource.noteOff(0):k._node.bufferSource.stop(0),a._cleanBuffer(k._node)}else(!isNaN(k._node.duration)||k._node.duration===1/0)&&k._node.pause();arguments[1]||a._emit("pause",k?k._id:null)}return a},stop:function(e,a){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(e)}}),f;for(var A=f._getSoundIds(e),k=0;k<A.length;k++){f._clearTimer(A[k]);var I=f._soundById(A[k]);I&&(I._seek=I._start||0,I._rateSeek=0,I._paused=!0,I._ended=!0,f._stopFade(A[k]),I._node&&(f._webAudio?I._node.bufferSource&&(typeof I._node.bufferSource.stop>"u"?I._node.bufferSource.noteOff(0):I._node.bufferSource.stop(0),f._cleanBuffer(I._node)):(!isNaN(I._node.duration)||I._node.duration===1/0)&&(I._node.currentTime=I._start||0,I._node.pause(),I._node.duration===1/0&&f._clearSound(I._node))),a||f._emit("stop",I._id))}return f},mute:function(e,a){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(e,a)}}),f;if(typeof a>"u")if(typeof e=="boolean")f._muted=e;else return f._muted;for(var A=f._getSoundIds(a),k=0;k<A.length;k++){var I=f._soundById(A[k]);I&&(I._muted=e,I._interval&&f._stopFade(I._id),f._webAudio&&I._node?I._node.gain.setValueAtTime(e?0:I._volume,t.ctx.currentTime):I._node&&(I._node.muted=t._muted?!0:e),f._emit("mute",I._id))}return f},volume:function(){var e=this,a=arguments,f,A;if(a.length===0)return e._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var k=e._getSoundIds(),I=k.indexOf(a[0]);I>=0?A=parseInt(a[0],10):f=parseFloat(a[0])}else a.length>=2&&(f=parseFloat(a[0]),A=parseInt(a[1],10));var u;if(typeof f<"u"&&f>=0&&f<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,a)}}),e;typeof A>"u"&&(e._volume=f),A=e._getSoundIds(A);for(var l=0;l<A.length;l++)u=e._soundById(A[l]),u&&(u._volume=f,a[2]||e._stopFade(A[l]),e._webAudio&&u._node&&!u._muted?u._node.gain.setValueAtTime(f,t.ctx.currentTime):u._node&&!u._muted&&(u._node.volume=f*t.volume()),e._emit("volume",u._id))}else return u=A?e._soundById(A):e._sounds[0],u?u._volume:0;return e},fade:function(e,a,f,A){var k=this;if(k._state!=="loaded"||k._playLock)return k._queue.push({event:"fade",action:function(){k.fade(e,a,f,A)}}),k;e=Math.min(Math.max(0,parseFloat(e)),1),a=Math.min(Math.max(0,parseFloat(a)),1),f=parseFloat(f),k.volume(e,A);for(var I=k._getSoundIds(A),u=0;u<I.length;u++){var l=k._soundById(I[u]);if(l){if(A||k._stopFade(I[u]),k._webAudio&&!l._muted){var b=t.ctx.currentTime,M=b+f/1e3;l._volume=e,l._node.gain.setValueAtTime(e,b),l._node.gain.linearRampToValueAtTime(a,M)}k._startFadeInterval(l,e,a,f,I[u],typeof A>"u")}}return k},_startFadeInterval:function(e,a,f,A,k,I){var u=this,l=a,b=f-a,M=Math.abs(b/.01),r=Math.max(4,M>0?A/M:A),p=Date.now();e._fadeTo=f,e._interval=setInterval(function(){var L=(Date.now()-p)/A;p=Date.now(),l+=b*L,l=Math.round(l*100)/100,b<0?l=Math.max(f,l):l=Math.min(f,l),u._webAudio?e._volume=l:u.volume(l,e._id,!0),I&&(u._volume=l),(f<a&&l<=f||f>a&&l>=f)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,u.volume(f,e._id),u._emit("fade",e._id))},r)},_stopFade:function(e){var a=this,f=a._soundById(e);return f&&f._interval&&(a._webAudio&&f._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(f._interval),f._interval=null,a.volume(f._fadeTo,e),f._fadeTo=null,a._emit("fade",e)),a},loop:function(){var e=this,a=arguments,f,A,k;if(a.length===0)return e._loop;if(a.length===1)if(typeof a[0]=="boolean")f=a[0],e._loop=f;else return k=e._soundById(parseInt(a[0],10)),k?k._loop:!1;else a.length===2&&(f=a[0],A=parseInt(a[1],10));for(var I=e._getSoundIds(A),u=0;u<I.length;u++)k=e._soundById(I[u]),k&&(k._loop=f,e._webAudio&&k._node&&k._node.bufferSource&&(k._node.bufferSource.loop=f,f&&(k._node.bufferSource.loopStart=k._start||0,k._node.bufferSource.loopEnd=k._stop,e.playing(I[u])&&(e.pause(I[u],!0),e.play(I[u],!0)))));return e},rate:function(){var e=this,a=arguments,f,A;if(a.length===0)A=e._sounds[0]._id;else if(a.length===1){var k=e._getSoundIds(),I=k.indexOf(a[0]);I>=0?A=parseInt(a[0],10):f=parseFloat(a[0])}else a.length===2&&(f=parseFloat(a[0]),A=parseInt(a[1],10));var u;if(typeof f=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,a)}}),e;typeof A>"u"&&(e._rate=f),A=e._getSoundIds(A);for(var l=0;l<A.length;l++)if(u=e._soundById(A[l]),u){e.playing(A[l])&&(u._rateSeek=e.seek(A[l]),u._playStart=e._webAudio?t.ctx.currentTime:u._playStart),u._rate=f,e._webAudio&&u._node&&u._node.bufferSource?u._node.bufferSource.playbackRate.setValueAtTime(f,t.ctx.currentTime):u._node&&(u._node.playbackRate=f);var b=e.seek(A[l]),M=(e._sprite[u._sprite][0]+e._sprite[u._sprite][1])/1e3-b,r=M*1e3/Math.abs(u._rate);(e._endTimers[A[l]]||!u._paused)&&(e._clearTimer(A[l]),e._endTimers[A[l]]=setTimeout(e._ended.bind(e,u),r)),e._emit("rate",u._id)}}else return u=e._soundById(A),u?u._rate:e._rate;return e},seek:function(){var e=this,a=arguments,f,A;if(a.length===0)e._sounds.length&&(A=e._sounds[0]._id);else if(a.length===1){var k=e._getSoundIds(),I=k.indexOf(a[0]);I>=0?A=parseInt(a[0],10):e._sounds.length&&(A=e._sounds[0]._id,f=parseFloat(a[0]))}else a.length===2&&(f=parseFloat(a[0]),A=parseInt(a[1],10));if(typeof A>"u")return 0;if(typeof f=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,a)}}),e;var u=e._soundById(A);if(u)if(typeof f=="number"&&f>=0){var l=e.playing(A);l&&e.pause(A,!0),u._seek=f,u._ended=!1,e._clearTimer(A),!e._webAudio&&u._node&&!isNaN(u._node.duration)&&(u._node.currentTime=f);var b=function(){l&&e.play(A,!0),e._emit("seek",A)};if(l&&!e._webAudio){var M=function(){e._playLock?setTimeout(M,0):b()};setTimeout(M,0)}else b()}else if(e._webAudio){var r=e.playing(A)?t.ctx.currentTime-u._playStart:0,p=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(p+r*Math.abs(u._rate))}else return u._node.currentTime;return e},playing:function(e){var a=this;if(typeof e=="number"){var f=a._soundById(e);return f?!f._paused:!1}for(var A=0;A<a._sounds.length;A++)if(!a._sounds[A]._paused)return!0;return!1},duration:function(e){var a=this,f=a._duration,A=a._soundById(e);return A&&(f=a._sprite[A._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var e=this,a=e._sounds,f=0;f<a.length;f++)a[f]._paused||e.stop(a[f]._id),e._webAudio||(e._clearSound(a[f]._node),a[f]._node.removeEventListener("error",a[f]._errorFn,!1),a[f]._node.removeEventListener(t._canPlayEvent,a[f]._loadFn,!1),a[f]._node.removeEventListener("ended",a[f]._endFn,!1),t._releaseHtml5Audio(a[f]._node)),delete a[f]._node,e._clearTimer(a[f]._id);var A=t._howls.indexOf(e);A>=0&&t._howls.splice(A,1);var k=!0;for(f=0;f<t._howls.length;f++)if(t._howls[f]._src===e._src||e._src.indexOf(t._howls[f]._src)>=0){k=!1;break}return S&&k&&delete S[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,a,f,A){var k=this,I=k["_on"+e];return typeof a=="function"&&I.push(A?{id:f,fn:a,once:A}:{id:f,fn:a}),k},off:function(e,a,f){var A=this,k=A["_on"+e],I=0;if(typeof a=="number"&&(f=a,a=null),a||f)for(I=0;I<k.length;I++){var u=f===k[I].id;if(a===k[I].fn&&u||!a&&u){k.splice(I,1);break}}else if(e)A["_on"+e]=[];else{var l=Object.keys(A);for(I=0;I<l.length;I++)l[I].indexOf("_on")===0&&Array.isArray(A[l[I]])&&(A[l[I]]=[])}return A},once:function(e,a,f){var A=this;return A.on(e,a,f,1),A},_emit:function(e,a,f){for(var A=this,k=A["_on"+e],I=k.length-1;I>=0;I--)(!k[I].id||k[I].id===a||e==="load")&&(setTimeout(function(u){u.call(this,a,f)}.bind(A,k[I].fn),0),k[I].once&&A.off(e,k[I].fn,k[I].id));return A._loadQueue(e),A},_loadQueue:function(e){var a=this;if(a._queue.length>0){var f=a._queue[0];f.event===e&&(a._queue.shift(),a._loadQueue()),e||f.action()}return a},_ended:function(e){var a=this,f=e._sprite;if(!a._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(a._ended.bind(a,e),100),a;var A=!!(e._loop||a._sprite[f][2]);if(a._emit("end",e._id),!a._webAudio&&A&&a.stop(e._id,!0).play(e._id),a._webAudio&&A){a._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var k=(e._stop-e._start)*1e3/Math.abs(e._rate);a._endTimers[e._id]=setTimeout(a._ended.bind(a,e),k)}return a._webAudio&&!A&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,a._clearTimer(e._id),a._cleanBuffer(e._node),t._autoSuspend()),!a._webAudio&&!A&&a.stop(e._id,!0),a},_clearTimer:function(e){var a=this;if(a._endTimers[e]){if(typeof a._endTimers[e]!="function")clearTimeout(a._endTimers[e]);else{var f=a._soundById(e);f&&f._node&&f._node.removeEventListener("ended",a._endTimers[e],!1)}delete a._endTimers[e]}return a},_soundById:function(e){for(var a=this,f=0;f<a._sounds.length;f++)if(e===a._sounds[f]._id)return a._sounds[f];return null},_inactiveSound:function(){var e=this;e._drain();for(var a=0;a<e._sounds.length;a++)if(e._sounds[a]._ended)return e._sounds[a].reset();return new h(e)},_drain:function(){var e=this,a=e._pool,f=0,A=0;if(!(e._sounds.length<a)){for(A=0;A<e._sounds.length;A++)e._sounds[A]._ended&&f++;for(A=e._sounds.length-1;A>=0;A--){if(f<=a)return;e._sounds[A]._ended&&(e._webAudio&&e._sounds[A]._node&&e._sounds[A]._node.disconnect(0),e._sounds.splice(A,1),f--)}}},_getSoundIds:function(e){var a=this;if(typeof e>"u"){for(var f=[],A=0;A<a._sounds.length;A++)f.push(a._sounds[A]._id);return f}else return[e]},_refreshBuffer:function(e){var a=this;return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=S[a._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),a},_cleanBuffer:function(e){var a=this,f=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),f))try{e.bufferSource.buffer=t._scratchBuffer}catch{}return e.bufferSource=null,a},_clearSound:function(e){var a=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);a||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var h=function(e){this._parent=e,this.init()};h.prototype={init:function(){var e=this,a=e._parent;return e._muted=a._muted,e._loop=a._loop,e._volume=a._volume,e._rate=a._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,a._sounds.push(e),e.create(),e},create:function(){var e=this,a=e._parent,f=t._muted||e._muted||e._parent._muted?0:e._volume;return a._webAudio?(e._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(f,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):t.noAudio||(e._node=t._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=a._src,e._node.preload=a._preload===!0?"auto":a._preload,e._node.volume=f*t.volume(),e._node.load()),e},reset:function(){var e=this,a=e._parent;return e._muted=a._muted,e._loop=a._loop,e._volume=a._volume,e._rate=a._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,a=e._parent;a._duration=Math.ceil(e._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,a=e._parent;a._duration===1/0&&(a._duration=Math.ceil(e._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var S={},c=function(e){var a=e._src;if(S[a]){e._duration=S[a].duration,$(e);return}if(/^data:[^;]+;base64,/.test(a)){for(var f=atob(a.split(",")[1]),A=new Uint8Array(f.length),k=0;k<f.length;++k)A[k]=f.charCodeAt(k);H(A.buffer,e)}else{var I=new XMLHttpRequest;I.open(e._xhr.method,a,!0),I.withCredentials=e._xhr.withCredentials,I.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(u){I.setRequestHeader(u,e._xhr.headers[u])}),I.onload=function(){var u=(I.status+"")[0];if(u!=="0"&&u!=="2"&&u!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+I.status+".");return}H(I.response,e)},I.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete S[a],e.load())},x(I)}},x=function(e){try{e.send()}catch{e.onerror()}},H=function(e,a){var f=function(){a._emit("loaderror",null,"Decoding audio data failed.")},A=function(k){k&&a._sounds.length>0?(S[a._src]=k,$(a,k)):f()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(e).then(A).catch(f):t.ctx.decodeAudioData(e,A,f)},$=function(e,a){a&&!e._duration&&(e._duration=a.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},y=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),a=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=a?parseInt(a[1],10):null;if(e&&f&&f<9){var A=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!A&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};d.Howler=t,d.Howl=s,typeof Mt<"u"?(Mt.HowlerGlobal=o,Mt.Howler=t,Mt.Howl=s,Mt.Sound=h):typeof window<"u"&&(window.HowlerGlobal=o,window.Howler=t,window.Howl=s,window.Sound=h)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var s=this;if(!s.ctx||!s.ctx.listener)return s;for(var h=s._howls.length-1;h>=0;h--)s._howls[h].stereo(t);return s},HowlerGlobal.prototype.pos=function(t,s,h){var S=this;if(!S.ctx||!S.ctx.listener)return S;if(s=typeof s!="number"?S._pos[1]:s,h=typeof h!="number"?S._pos[2]:h,typeof t=="number")S._pos=[t,s,h],typeof S.ctx.listener.positionX<"u"?(S.ctx.listener.positionX.setTargetAtTime(S._pos[0],Howler.ctx.currentTime,.1),S.ctx.listener.positionY.setTargetAtTime(S._pos[1],Howler.ctx.currentTime,.1),S.ctx.listener.positionZ.setTargetAtTime(S._pos[2],Howler.ctx.currentTime,.1)):S.ctx.listener.setPosition(S._pos[0],S._pos[1],S._pos[2]);else return S._pos;return S},HowlerGlobal.prototype.orientation=function(t,s,h,S,c,x){var H=this;if(!H.ctx||!H.ctx.listener)return H;var $=H._orientation;if(s=typeof s!="number"?$[1]:s,h=typeof h!="number"?$[2]:h,S=typeof S!="number"?$[3]:S,c=typeof c!="number"?$[4]:c,x=typeof x!="number"?$[5]:x,typeof t=="number")H._orientation=[t,s,h,S,c,x],typeof H.ctx.listener.forwardX<"u"?(H.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),H.ctx.listener.forwardY.setTargetAtTime(s,Howler.ctx.currentTime,.1),H.ctx.listener.forwardZ.setTargetAtTime(h,Howler.ctx.currentTime,.1),H.ctx.listener.upX.setTargetAtTime(S,Howler.ctx.currentTime,.1),H.ctx.listener.upY.setTargetAtTime(c,Howler.ctx.currentTime,.1),H.ctx.listener.upZ.setTargetAtTime(x,Howler.ctx.currentTime,.1)):H.ctx.listener.setOrientation(t,s,h,S,c,x);else return $;return H},Howl.prototype.init=function(t){return function(s){var h=this;return h._orientation=s.orientation||[1,0,0],h._stereo=s.stereo||null,h._pos=s.pos||null,h._pannerAttr={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:360,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:360,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:0,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:"inverse",maxDistance:typeof s.maxDistance<"u"?s.maxDistance:1e4,panningModel:typeof s.panningModel<"u"?s.panningModel:"HRTF",refDistance:typeof s.refDistance<"u"?s.refDistance:1,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:1},h._onstereo=s.onstereo?[{fn:s.onstereo}]:[],h._onpos=s.onpos?[{fn:s.onpos}]:[],h._onorientation=s.onorientation?[{fn:s.onorientation}]:[],t.call(this,s)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,s){var h=this;if(!h._webAudio)return h;if(h._state!=="loaded")return h._queue.push({event:"stereo",action:function(){h.stereo(t,s)}}),h;var S=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof s>"u")if(typeof t=="number")h._stereo=t,h._pos=[t,0,0];else return h._stereo;for(var c=h._getSoundIds(s),x=0;x<c.length;x++){var H=h._soundById(c[x]);if(H)if(typeof t=="number")H._stereo=t,H._pos=[t,0,0],H._node&&(H._pannerAttr.panningModel="equalpower",(!H._panner||!H._panner.pan)&&o(H,S),S==="spatial"?typeof H._panner.positionX<"u"?(H._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),H._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),H._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):H._panner.setPosition(t,0,0):H._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),h._emit("stereo",H._id);else return H._stereo}return h},Howl.prototype.pos=function(t,s,h,S){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"pos",action:function(){c.pos(t,s,h,S)}}),c;if(s=typeof s!="number"?0:s,h=typeof h!="number"?-.5:h,typeof S>"u")if(typeof t=="number")c._pos=[t,s,h];else return c._pos;for(var x=c._getSoundIds(S),H=0;H<x.length;H++){var $=c._soundById(x[H]);if($)if(typeof t=="number")$._pos=[t,s,h],$._node&&((!$._panner||$._panner.pan)&&o($,"spatial"),typeof $._panner.positionX<"u"?($._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),$._panner.positionY.setValueAtTime(s,Howler.ctx.currentTime),$._panner.positionZ.setValueAtTime(h,Howler.ctx.currentTime)):$._panner.setPosition(t,s,h)),c._emit("pos",$._id);else return $._pos}return c},Howl.prototype.orientation=function(t,s,h,S){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"orientation",action:function(){c.orientation(t,s,h,S)}}),c;if(s=typeof s!="number"?c._orientation[1]:s,h=typeof h!="number"?c._orientation[2]:h,typeof S>"u")if(typeof t=="number")c._orientation=[t,s,h];else return c._orientation;for(var x=c._getSoundIds(S),H=0;H<x.length;H++){var $=c._soundById(x[H]);if($)if(typeof t=="number")$._orientation=[t,s,h],$._node&&($._panner||($._pos||($._pos=c._pos||[0,0,-.5]),o($,"spatial")),typeof $._panner.orientationX<"u"?($._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),$._panner.orientationY.setValueAtTime(s,Howler.ctx.currentTime),$._panner.orientationZ.setValueAtTime(h,Howler.ctx.currentTime)):$._panner.setOrientation(t,s,h)),c._emit("orientation",$._id);else return $._orientation}return c},Howl.prototype.pannerAttr=function(){var t=this,s=arguments,h,S,c;if(!t._webAudio)return t;if(s.length===0)return t._pannerAttr;if(s.length===1)if(typeof s[0]=="object")h=s[0],typeof S>"u"&&(h.pannerAttr||(h.pannerAttr={coneInnerAngle:h.coneInnerAngle,coneOuterAngle:h.coneOuterAngle,coneOuterGain:h.coneOuterGain,distanceModel:h.distanceModel,maxDistance:h.maxDistance,refDistance:h.refDistance,rolloffFactor:h.rolloffFactor,panningModel:h.panningModel}),t._pannerAttr={coneInnerAngle:typeof h.pannerAttr.coneInnerAngle<"u"?h.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof h.pannerAttr.coneOuterAngle<"u"?h.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof h.pannerAttr.coneOuterGain<"u"?h.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof h.pannerAttr.distanceModel<"u"?h.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof h.pannerAttr.maxDistance<"u"?h.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof h.pannerAttr.refDistance<"u"?h.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof h.pannerAttr.rolloffFactor<"u"?h.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof h.pannerAttr.panningModel<"u"?h.pannerAttr.panningModel:t._panningModel});else return c=t._soundById(parseInt(s[0],10)),c?c._pannerAttr:t._pannerAttr;else s.length===2&&(h=s[0],S=parseInt(s[1],10));for(var x=t._getSoundIds(S),H=0;H<x.length;H++)if(c=t._soundById(x[H]),c){var $=c._pannerAttr;$={coneInnerAngle:typeof h.coneInnerAngle<"u"?h.coneInnerAngle:$.coneInnerAngle,coneOuterAngle:typeof h.coneOuterAngle<"u"?h.coneOuterAngle:$.coneOuterAngle,coneOuterGain:typeof h.coneOuterGain<"u"?h.coneOuterGain:$.coneOuterGain,distanceModel:typeof h.distanceModel<"u"?h.distanceModel:$.distanceModel,maxDistance:typeof h.maxDistance<"u"?h.maxDistance:$.maxDistance,refDistance:typeof h.refDistance<"u"?h.refDistance:$.refDistance,rolloffFactor:typeof h.rolloffFactor<"u"?h.rolloffFactor:$.rolloffFactor,panningModel:typeof h.panningModel<"u"?h.panningModel:$.panningModel};var y=c._panner;y?(y.coneInnerAngle=$.coneInnerAngle,y.coneOuterAngle=$.coneOuterAngle,y.coneOuterGain=$.coneOuterGain,y.distanceModel=$.distanceModel,y.maxDistance=$.maxDistance,y.refDistance=$.refDistance,y.rolloffFactor=$.rolloffFactor,y.panningModel=$.panningModel):(c._pos||(c._pos=t._pos||[0,0,-.5]),o(c,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var s=this,h=s._parent;s._orientation=h._orientation,s._stereo=h._stereo,s._pos=h._pos,s._pannerAttr=h._pannerAttr,t.call(this),s._stereo?h.stereo(s._stereo):s._pos&&h.pos(s._pos[0],s._pos[1],s._pos[2],s._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var s=this,h=s._parent;return s._orientation=h._orientation,s._stereo=h._stereo,s._pos=h._pos,s._pannerAttr=h._pannerAttr,s._stereo?h.stereo(s._stereo):s._pos?h.pos(s._pos[0],s._pos[1],s._pos[2],s._id):s._panner&&(s._panner.disconnect(0),s._panner=void 0,h._refreshBuffer(s)),t.call(this)}}(Sound.prototype.reset);var o=function(t,s){s=s||"spatial",s==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})($1);function c1(d,o,t){const s=d.slice();return s[21]=o[t],s[23]=t,s}function d1(d){let o,t;return{c(){o=qe("div"),t=d0("Start chatting!"),this.h()},l(s){o=Ye(s,"DIV",{class:!0});var h=He(o);t=h0(h,"Start chatting!"),h.forEach(we),this.h()},h(){de(o,"class","m-3")},m(s,h){u0(s,o,h),pe(o,t)},p:rt,d(s){s&&we(o)}}}function Qn(d){let o,t,s=d[21].content+"",h,S;return{c(){o=qe("div"),t=qe("div"),this.h()},l(c){o=Ye(c,"DIV",{class:!0});var x=He(o);t=Ye(x,"DIV",{class:!0});var H=He(t);H.forEach(we),x.forEach(we),this.h()},h(){de(t,"class","chat-bubble"),de(o,"class","chat chat-start m-2")},m(c,x){u0(c,o,x),pe(o,t),t.innerHTML=s,S=!0},p(c,x){(!S||x&1)&&s!==(s=c[21].content+"")&&(t.innerHTML=s)},i(c){S||(T1(()=>{S&&(h||(h=$t(o,Zt,{},!0)),h.run(1))}),S=!0)},o(c){h||(h=$t(o,Zt,{},!1)),h.run(0),S=!1},d(c){c&&we(o),c&&h&&h.end()}}}function Wn(d){let o,t,s=d[21].content+"",h,S;return{c(){o=qe("div"),t=qe("div"),this.h()},l(c){o=Ye(c,"DIV",{class:!0});var x=He(o);t=Ye(x,"DIV",{class:!0});var H=He(t);H.forEach(we),x.forEach(we),this.h()},h(){de(t,"class","chat-bubble"),de(o,"class","chat chat-end m-2")},m(c,x){u0(c,o,x),pe(o,t),t.innerHTML=s,S=!0},p(c,x){(!S||x&1)&&s!==(s=c[21].content+"")&&(t.innerHTML=s)},i(c){S||(T1(()=>{S&&(h||(h=$t(o,Zt,{},!0)),h.run(1))}),S=!0)},o(c){h||(h=$t(o,Zt,{},!1)),h.run(0),S=!1},d(c){c&&we(o),c&&h&&h.end()}}}function h1(d){let o;return{c(){o=qe("div"),this.h()},l(t){o=Ye(t,"DIV",{class:!0,id:!0}),He(o).forEach(we),this.h()},h(){de(o,"class","h-16"),de(o,"id","after-last-message")},m(t,s){u0(t,o,s)},d(t){t&&we(o)}}}function m1(d){let o,t,s,h,S;const c=[Wn,Qn],x=[];function H(y,e){return y[21].role==="user"?0:1}o=H(d),t=x[o]=c[o](d);let $=d[23]===d[0].length-1&&h1();return{c(){t.c(),s=i0(),$&&$.c(),h=Pa()},l(y){t.l(y),s=s0(y),$&&$.l(y),h=Pa()},m(y,e){x[o].m(y,e),u0(y,s,e),$&&$.m(y,e),u0(y,h,e),S=!0},p(y,e){let a=o;o=H(y),o===a?x[o].p(y,e):(xa(),at(x[a],1,1,()=>{x[a]=null}),Ta(),t=x[o],t?t.p(y,e):(t=x[o]=c[o](y),t.c()),z0(t,1),t.m(s.parentNode,s)),y[23]===y[0].length-1?$||($=h1(),$.c(),$.m(h.parentNode,h)):$&&($.d(1),$=null)},i(y){S||(z0(t),S=!0)},o(y){at(t),S=!1},d(y){x[o].d(y),y&&we(s),$&&$.d(y),y&&we(h)}}}function jn(d){let o,t,s;function h(c){d[10](c)}let S={finishedRecording:d[6],startedRecording:d[7]};return d[3]!==void 0&&(S.startRecording=d[3]),o=new Gn({props:S}),Q1.push(()=>W1(o,"startRecording",h)),{c(){Gt(o.$$.fragment)},l(c){qt(o.$$.fragment,c)},m(c,x){Yt(o,c,x),s=!0},p(c,x){const H={};!t&&x&8&&(t=!0,H.startRecording=c[3],j1(()=>t=!1)),o.$set(H)},i(c){s||(z0(o.$$.fragment,c),s=!0)},o(c){at(o.$$.fragment,c),s=!1},d(c){Ut(o,c)}}}function zn(d){let o,t,s,h,S,c,x,H;return{c(){o=qe("button"),t=l0("svg"),s=l0("title"),h=d0("send"),S=l0("path"),this.h()},l($){o=Ye($,"BUTTON",{class:!0});var y=He(o);t=o0(y,"svg",{xmlns:!0,viewBox:!0,class:!0,fill:!0});var e=He(t);s=o0(e,"title",{});var a=He(s);h=h0(a,"send"),a.forEach(we),S=o0(e,"path",{d:!0}),He(S).forEach(we),e.forEach(we),y.forEach(we),this.h()},h(){de(S,"d","M2,21L23,12L2,3V10L17,12L2,14V21Z"),de(t,"xmlns","http://www.w3.org/2000/svg"),de(t,"viewBox","0 0 24 24"),de(t,"class","h-6 w-6"),de(t,"fill","currentColor"),de(o,"class",c=`btn ${d[2]?"opacity-50":""}`)},m($,y){u0($,o,y),pe(o,t),pe(t,s),pe(s,h),pe(t,S),x||(H=Z0(o,"click",d[5]),x=!0)},p($,y){y&4&&c!==(c=`btn ${$[2]?"opacity-50":""}`)&&de(o,"class",c)},i:rt,o:rt,d($){$&&we(o),x=!1,H()}}}function Jn(d){let o,t,s,h,S,c,x,H,$,y,e=d[0],a=[];for(let l=0;l<e.length;l+=1)a[l]=m1(c1(d,e,l));const f=l=>at(a[l],1,1,()=>{a[l]=null});let A=null;e.length||(A=d1());const k=[zn,jn],I=[];function u(l,b){return l[1].length>0?0:l[4]?1:-1}return~(c=u(d))&&(x=I[c]=k[c](d)),{c(){o=qe("main");for(let l=0;l<a.length;l+=1)a[l].c();A&&A.c(),t=i0(),s=qe("div"),h=qe("input"),S=i0(),x&&x.c(),this.h()},l(l){o=Ye(l,"MAIN",{class:!0});var b=He(o);for(let r=0;r<a.length;r+=1)a[r].l(b);A&&A.l(b),t=s0(b),s=Ye(b,"DIV",{class:!0});var M=He(s);h=Ye(M,"INPUT",{type:!0,placeholder:!0,class:!0}),S=s0(M),x&&x.l(M),M.forEach(we),b.forEach(we),this.h()},h(){de(h,"type","text"),de(h,"placeholder","Type here"),de(h,"class","input input-bordered w-full mr-2"),de(s,"class","join w-full fixed bottom-0 left-0 right-0 p-3"),de(o,"class","relative mt-16")},m(l,b){u0(l,o,b);for(let M=0;M<a.length;M+=1)a[M]&&a[M].m(o,null);A&&A.m(o,null),pe(o,t),pe(o,s),pe(s,h),yt(h,d[1]),pe(s,S),~c&&I[c].m(s,null),H=!0,$||(y=[Z0(h,"input",d[8]),Z0(h,"keypress",d[9])],$=!0)},p(l,[b]){if(b&1){e=l[0];let r;for(r=0;r<e.length;r+=1){const p=c1(l,e,r);a[r]?(a[r].p(p,b),z0(a[r],1)):(a[r]=m1(p),a[r].c(),z0(a[r],1),a[r].m(o,t))}for(xa(),r=e.length;r<a.length;r+=1)f(r);Ta(),!e.length&&A?A.p(l,b):e.length?A&&(A.d(1),A=null):(A=d1(),A.c(),A.m(o,t))}b&2&&h.value!==l[1]&&yt(h,l[1]);let M=c;c=u(l),c===M?~c&&I[c].p(l,b):(x&&(xa(),at(I[M],1,1,()=>{I[M]=null}),Ta()),~c?(x=I[c],x?x.p(l,b):(x=I[c]=k[c](l),x.c()),z0(x,1),x.m(s,null)):x=null)},i(l){if(!H){for(let b=0;b<e.length;b+=1)z0(a[b]);z0(x),H=!0}},o(l){a=a.filter(Boolean);for(let b=0;b<a.length;b+=1)at(a[b]);at(x),H=!1},d(l){l&&we(o),x1(a,l),A&&A.d(),~c&&I[c].d(),$=!1,jt(y)}}}function b1(){const d=document.querySelector("#after-last-message");d&&d.scrollIntoView({behavior:"smooth"})}function gn(d,o,t){let s,h,S,c,x,H,$;x0(d,Ra,P=>t(12,s=P)),x0(d,Y1,P=>t(13,h=P)),x0(d,Qt,P=>t(14,S=P)),x0(d,Kt,P=>t(15,c=P)),x0(d,Ma,P=>t(16,x=P)),x0(d,Ea,P=>t(17,H=P)),x0(d,kn,P=>t(4,$=P));const y=P=>P.replaceAll(`
`,"<br />");let e=[],a="",f=!1;const A=async()=>{if(f)return;t(2,f=!0);const P=[...e,{role:"user",content:a}];t(1,a=""),t(0,e=P),b1();const N=P.slice(-2);let V;if(h?V=await $n(N,x):V=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:N})}),!V.ok)throw new Error(V.statusText);const Q=V.body;if(!Q)return;const j=Q.getReader(),B=new TextDecoder;let n=!1,O="";for(;!n;){const{value:q,done:Z}=await j.read();n=Z;const G=B.decode(q);O=O+G,t(0,e=[...P,{role:"assistant",content:y(O)}]),b1()}H?b(O):l(),t(2,f=!1)},k=async P=>{console.log("transcribing");const N=new FormData;N.append("file",P),S.code!=""&&N.append("language",S.code);let V;h?V=await Kn(P,x,S.code):V=await fetch("/api/transcription",{method:"POST",body:N});const Q=await V.json();if(t(1,a=Q.transcribedText),a.trim()==""){console.log("empty text"),l();return}return console.log("transcribed",a),A(),V};let I=null;const u=()=>{I==null||I.stop()},l=()=>{c&&M(!0)},b=async P=>{const N=S.voiceCode!=""?S.voiceCode:"en-US",V=S.voice!=""?S.voice:"en-US-Wavenet-D";let Q;h?Q=await Zn(P,s,N,V):Q=await fetch("/api/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:P,languageCode:N,voice:V})});const j=await Q.json(),B=atob(j.audioContent),n=new Array(B.length);for(let ee=0;ee<B.length;ee++)n[ee]=B.charCodeAt(ee);const O=new Uint8Array(n),q=new Blob([O],{type:"audio/mp3"}),Z=URL.createObjectURL(q);var G=new $1.Howl({src:[Z],format:["mp3"]});I=G,G.play(),G.on("end",()=>{l()})};let M;function r(){a=this.value,t(1,a)}const p=P=>{P.key==="Enter"&&a.length>0&&A()};function L(P){M=P,t(3,M)}return[e,a,f,M,$,A,k,u,r,p,L]}class ei extends Bt{constructor(o){super(),It(this,o,gn,Jn,kt,{})}}function p1(d,o,t){const s=d.slice();return s[10]=o[t],s}function A1(d){let o,t=d[3],s=[];for(let h=0;h<t.length;h+=1)s[h]=y1(p1(d,t,h));return{c(){o=qe("ul");for(let h=0;h<s.length;h+=1)s[h].c();this.h()},l(h){o=Ye(h,"UL",{class:!0});var S=He(o);for(let c=0;c<s.length;c+=1)s[c].l(S);S.forEach(we),this.h()},h(){de(o,"class","menu menu-sm bg-base-200 w-56 rounded-box fixed top-14 z-20")},m(h,S){u0(h,o,S);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(o,null)},p(h,S){if(S&13){t=h[3];let c;for(c=0;c<t.length;c+=1){const x=p1(h,t,c);s[c]?s[c].p(x,S):(s[c]=y1(x),s[c].c(),s[c].m(o,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=t.length}},d(h){h&&we(o),x1(s,h)}}}function y1(d){let o,t,s=d[10].name+"",h,S,c,x,H;function $(){return d[7](d[10])}return{c(){o=qe("li"),t=qe("button"),h=d0(s),c=i0(),this.h()},l(y){o=Ye(y,"LI",{});var e=He(o);t=Ye(e,"BUTTON",{class:!0});var a=He(t);h=h0(a,s),a.forEach(we),c=s0(e),e.forEach(we),this.h()},h(){de(t,"class",S="hover:bg-gray-200"+(d[2].name===d[10].name?" text-blue-500":""))},m(y,e){u0(y,o,e),pe(o,t),pe(t,h),pe(o,c),x||(H=Z0(t,"click",$),x=!0)},p(y,e){d=y,e&8&&s!==(s=d[10].name+"")&&M1(h,s),e&12&&S!==(S="hover:bg-gray-200"+(d[2].name===d[10].name?" text-blue-500":""))&&de(t,"class",S)},d(y){y&&we(o),x=!1,H()}}}function ti(d){let o,t,s,h;return{c(){o=l0("svg"),t=l0("title"),s=d0("volume-off"),h=l0("path"),this.h()},l(S){o=o0(S,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var c=He(o);t=o0(c,"title",{});var x=He(t);s=h0(x,"volume-off"),x.forEach(we),h=o0(c,"path",{d:!0}),He(h).forEach(we),c.forEach(we),this.h()},h(){de(h,"d","M12,4L9.91,6.09L12,8.18M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.53C15.58,18.04 14.83,18.46 14,18.7V20.77C15.38,20.45 16.63,19.82 17.68,18.96L19.73,21L21,19.73L12,10.73M19,12C19,12.94 18.8,13.82 18.46,14.64L19.97,16.15C20.62,14.91 21,13.5 21,12C21,7.72 18,4.14 14,3.23V5.29C16.89,6.15 19,8.83 19,12M16.5,12C16.5,10.23 15.5,8.71 14,7.97V10.18L16.45,12.63C16.5,12.43 16.5,12.21 16.5,12Z"),de(o,"xmlns","http://www.w3.org/2000/svg"),de(o,"viewBox","0 0 24 24"),de(o,"fill","currentColor"),de(o,"class","w-6 h-6")},m(S,c){u0(S,o,c),pe(o,t),pe(t,s),pe(o,h)},d(S){S&&we(o)}}}function ai(d){let o,t,s,h;return{c(){o=l0("svg"),t=l0("title"),s=d0("volume-high"),h=l0("path"),this.h()},l(S){o=o0(S,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var c=He(o);t=o0(c,"title",{});var x=He(t);s=h0(x,"volume-high"),x.forEach(we),h=o0(c,"path",{d:!0}),He(h).forEach(we),c.forEach(we),this.h()},h(){de(h,"d","M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"),de(o,"xmlns","http://www.w3.org/2000/svg"),de(o,"viewBox","0 0 24 24"),de(o,"fill","currentColor"),de(o,"class","w-6 h-6")},m(S,c){u0(S,o,c),pe(o,t),pe(t,s),pe(o,h)},d(S){S&&we(o)}}}function ri(d){let o,t,s,h;return{c(){o=l0("svg"),t=l0("title"),s=d0("ear-hearing-off"),h=l0("path"),this.h()},l(S){o=o0(S,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var c=He(o);t=o0(c,"title",{});var x=He(t);s=h0(x,"ear-hearing-off"),x.forEach(we),h=o0(c,"path",{d:!0}),He(h).forEach(we),c.forEach(we),this.h()},h(){de(h,"d","M1,4.27L2.28,3L20,20.72L18.73,22L12.91,16.18C12.19,16.74 11.67,17.19 11.37,18.1C10.77,19.92 10,20.94 8.64,21.65C8.13,21.88 7.57,22 7,22A4,4 0 0,1 3,18H5A2,2 0 0,0 7,20C7.29,20 7.56,19.94 7.76,19.85C8.47,19.5 8.97,18.97 9.47,17.47C9.91,16.12 10.69,15.39 11.5,14.76L5.04,8.31C5,8.54 5,8.77 5,9H3C3,8.17 3.14,7.39 3.39,6.66L1,4.27M14.18,11.94C14.71,11 15,9.93 15,9C15,6.2 12.8,4 10,4C8.81,4 7.74,4.39 6.89,5.06L5.46,3.63C6.67,2.61 8.25,2 10,2C13.93,2 17,5.07 17,9C17,10.26 16.62,11.65 15.93,12.9L15.47,13.65L14.03,12.2L14.18,11.94M16.36,2.64L17.78,1.22C19.77,3.21 21,5.96 21,9C21,11.83 19.93,14.41 18.18,16.36L16.77,14.94C18.15,13.36 19,11.28 19,9C19,6.5 18,4.26 16.36,2.64M12.5,9C12.5,9.5 12.36,9.93 12.13,10.31L8.69,6.87C9.07,6.64 9.5,6.5 10,6.5A2.5,2.5 0 0,1 12.5,9Z"),de(o,"xmlns","http://www.w3.org/2000/svg"),de(o,"viewBox","0 0 24 24"),de(o,"fill","currentColor"),de(o,"class","w-6 h-6")},m(S,c){u0(S,o,c),pe(o,t),pe(t,s),pe(o,h)},d(S){S&&we(o)}}}function ni(d){let o,t,s,h;return{c(){o=l0("svg"),t=l0("title"),s=d0("ear-hearing"),h=l0("path"),this.h()},l(S){o=o0(S,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var c=He(o);t=o0(c,"title",{});var x=He(t);s=h0(x,"ear-hearing"),x.forEach(we),h=o0(c,"path",{transform:!0,d:!0}),He(h).forEach(we),c.forEach(we),this.h()},h(){de(h,"transform","scale(-1, 1) translate(-24, 0)"),de(h,"d","M17,20C16.71,20 16.44,19.94 16.24,19.85C15.53,19.5 15.03,18.97 14.53,17.47C14,15.91 13.06,15.18 12.14,14.47C11.35,13.86 10.53,13.23 9.82,11.94C9.29,11 9,9.93 9,9C9,6.2 11.2,4 14,4C16.8,4 19,6.2 19,9H21C21,5.07 17.93,2 14,2C10.07,2 7,5.07 7,9C7,10.26 7.38,11.65 8.07,12.9C9,14.55 10.05,15.38 10.92,16.05C11.73,16.67 12.31,17.12 12.63,18.1C13.23,19.92 14,20.94 15.36,21.65C15.87,21.88 16.43,22 17,22A4,4 0 0,0 21,18H19A2,2 0 0,1 17,20M7.64,2.64L6.22,1.22C4.23,3.21 3,5.96 3,9C3,12.04 4.23,14.79 6.22,16.78L7.63,15.37C6,13.74 5,11.5 5,9C5,6.5 6,4.26 7.64,2.64M11.5,9A2.5,2.5 0 0,0 14,11.5A2.5,2.5 0 0,0 16.5,9A2.5,2.5 0 0,0 14,6.5A2.5,2.5 0 0,0 11.5,9Z"),de(o,"xmlns","http://www.w3.org/2000/svg"),de(o,"viewBox","0 0 24 24"),de(o,"fill","currentColor"),de(o,"class","w-6 h-6")},m(S,c){u0(S,o,c),pe(o,t),pe(t,s),pe(o,h)},d(S){S&&we(o)}}}function S1(d){let o,t,s,h,S;return{c(){o=qe("button"),t=l0("svg"),s=l0("title"),h=d0("key-variant"),S=l0("path"),this.h()},l(c){o=Ye(c,"BUTTON",{class:!0,onclick:!0});var x=He(o);t=o0(x,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var H=He(t);s=o0(H,"title",{});var $=He(s);h=h0($,"key-variant"),$.forEach(we),S=o0(H,"path",{d:!0}),He(S).forEach(we),H.forEach(we),x.forEach(we),this.h()},h(){de(S,"d","M22,18V22H18V19H15V16H12L9.74,13.74C9.19,13.91 8.61,14 8,14A6,6 0 0,1 2,8A6,6 0 0,1 8,2A6,6 0 0,1 14,8C14,8.61 13.91,9.19 13.74,9.74L22,18M7,5A2,2 0 0,0 5,7A2,2 0 0,0 7,9A2,2 0 0,0 9,7A2,2 0 0,0 7,5Z"),de(t,"xmlns","http://www.w3.org/2000/svg"),de(t,"viewBox","0 0 24 24"),de(t,"fill","currentColor"),de(t,"class","w-6 h-6"),de(o,"class","btn"),de(o,"onclick","api_key_modal.showModal()")},m(c,x){u0(c,o,x),pe(o,t),pe(t,s),pe(s,h),pe(t,S)},d(c){c&&we(o)}}}function ii(d){let o,t,s,h,S,c,x,H,$,y,e=d[2].emoji+"",a,f,A,k,I,u,l,b,M,r=d[0]&&A1(d);function p(B,n){return B[4]?ai:ti}let L=p(d),P=L(d);function N(B,n){return B[5]?ni:ri}let V=N(d),Q=V(d),j=d[1]&&S1();return{c(){o=qe("nav"),t=qe("div"),s=i0(),h=qe("div"),S=qe("div"),c=d0("Chat"),x=i0(),H=qe("div"),$=qe("button"),y=qe("span"),a=d0(e),f=i0(),r&&r.c(),A=i0(),k=qe("button"),P.c(),I=i0(),u=qe("button"),Q.c(),l=i0(),j&&j.c(),this.h()},l(B){o=Ye(B,"NAV",{class:!0});var n=He(o);t=Ye(n,"DIV",{class:!0});var O=He(t);O.forEach(we),s=s0(n),h=Ye(n,"DIV",{class:!0});var q=He(h);S=Ye(q,"DIV",{class:!0});var Z=He(S);c=h0(Z,"Chat"),Z.forEach(we),q.forEach(we),x=s0(n),H=Ye(n,"DIV",{class:!0});var G=He(H);$=Ye(G,"BUTTON",{class:!0});var ee=He($);y=Ye(ee,"SPAN",{class:!0});var D=He(y);a=h0(D,e),D.forEach(we),ee.forEach(we),f=s0(G),r&&r.l(G),A=s0(G),k=Ye(G,"BUTTON",{class:!0});var F=He(k);P.l(F),F.forEach(we),I=s0(G),u=Ye(G,"BUTTON",{class:!0});var v=He(u);Q.l(v),v.forEach(we),l=s0(G),j&&j.l(G),G.forEach(we),n.forEach(we),this.h()},h(){de(t,"class","flex-none"),de(S,"class","font-bold normal-case text-xl px-3"),de(h,"class","flex-1"),de(y,"class","text-2xl"),de($,"class","btn btn-square btn-ghost"),de(k,"class","btn btn-square btn-ghost"),de(u,"class","btn btn-square btn-ghost"),de(H,"class","flex-none"),de(o,"class","navbar bg-base-200 bg-opacity-90 fixed top-0 z-50")},m(B,n){u0(B,o,n),pe(o,t),pe(o,s),pe(o,h),pe(h,S),pe(S,c),pe(o,x),pe(o,H),pe(H,$),pe($,y),pe(y,a),pe(H,f),r&&r.m(H,null),pe(H,A),pe(H,k),P.m(k,null),pe(H,I),pe(H,u),Q.m(u,null),pe(H,l),j&&j.m(H,null),b||(M=[Z0($,"click",d[6]),Z0(k,"click",d[8]),Z0(u,"click",d[9])],b=!0)},p(B,[n]){n&4&&e!==(e=B[2].emoji+"")&&M1(a,e),B[0]?r?r.p(B,n):(r=A1(B),r.c(),r.m(H,A)):r&&(r.d(1),r=null),L!==(L=p(B))&&(P.d(1),P=L(B),P&&(P.c(),P.m(k,null))),V!==(V=N(B))&&(Q.d(1),Q=V(B),Q&&(Q.c(),Q.m(u,null))),B[1]?j||(j=S1(),j.c(),j.m(H,null)):j&&(j.d(1),j=null)},i:rt,o:rt,d(B){B&&we(o),r&&r.d(),P.d(),Q.d(),j&&j.d(),b=!1,jt(M)}}}function si(d,o,t){let s,h,S,c,x;x0(d,Y1,f=>t(1,s=f)),x0(d,Qt,f=>t(2,h=f)),x0(d,Cn,f=>t(3,S=f)),x0(d,Ea,f=>t(4,c=f)),x0(d,Kt,f=>t(5,x=f)),w1(()=>{document.addEventListener("pointerup",f=>{f.target instanceof Element&&f.target.closest(".navbar")||t(0,H=!1)}),s&&api_key_modal.showModal()});let H=!1;return[H,s,h,S,c,x,()=>t(0,H=!H),f=>{Qt.set(f),t(0,H=!1)},()=>{Ea.set(!c)},()=>{Kt.set(!x)}]}class li extends Bt{constructor(o){super(),It(this,o,si,ii,kt,{})}}function oi(d){let o,t,s,h,S,c,x,H,$,y,e,a,f,A,k,I,u,l,b,M,r,p,L,P,N,V,Q,j,B,n,O,q,Z,G,ee,D,F,v,m;return{c(){o=qe("dialog"),t=qe("form"),s=qe("button"),h=d0(""),S=i0(),c=qe("h3"),x=d0("API Keys"),H=i0(),$=qe("div"),y=qe("label"),e=qe("span"),a=d0(`Please enter your OpenAI and Google Cloud (with Text-To-Speech enabled) API keys to use
          this demo. Your keys are not saved anywhere and only sent to their respective APIs. Your
          OpenAI key is used for chat completion and speech to text, and your Google Cloud key is
          used for text to speech.
          `),f=qe("br"),A=i0(),k=qe("br"),I=d0(`
          Using this demo may incur charges on your OpenAI and Google Cloud accounts.`),u=i0(),l=qe("div"),b=qe("label"),M=qe("span"),r=d0("OpenAI API Key"),p=i0(),L=qe("input"),P=i0(),N=qe("div"),V=qe("label"),Q=qe("span"),j=d0("Google Cloud API Key"),B=i0(),n=qe("input"),O=i0(),q=qe("button"),Z=d0("Save"),G=i0(),ee=qe("form"),D=qe("button"),F=d0("close"),this.h()},l(i){o=Ye(i,"DIALOG",{id:!0,class:!0});var T=He(o);t=Ye(T,"FORM",{method:!0,class:!0,id:!0});var K=He(t);s=Ye(K,"BUTTON",{class:!0});var ne=He(s);h=h0(ne,""),ne.forEach(we),S=s0(K),c=Ye(K,"H3",{class:!0});var g=He(c);x=h0(g,"API Keys"),g.forEach(we),H=s0(K),$=Ye(K,"DIV",{class:!0});var Y=He($);y=Ye(Y,"LABEL",{for:!0,class:!0});var re=He(y);e=Ye(re,"SPAN",{class:!0});var _e=He(e);a=h0(_e,`Please enter your OpenAI and Google Cloud (with Text-To-Speech enabled) API keys to use
          this demo. Your keys are not saved anywhere and only sent to their respective APIs. Your
          OpenAI key is used for chat completion and speech to text, and your Google Cloud key is
          used for text to speech.
          `),f=Ye(_e,"BR",{}),A=s0(_e),k=Ye(_e,"BR",{}),I=h0(_e,`
          Using this demo may incur charges on your OpenAI and Google Cloud accounts.`),_e.forEach(we),re.forEach(we),u=s0(Y),l=Ye(Y,"DIV",{class:!0});var he=He(l);b=Ye(he,"LABEL",{for:!0,class:!0});var ke=He(b);M=Ye(ke,"SPAN",{class:!0});var Se=He(M);r=h0(Se,"OpenAI API Key"),Se.forEach(we),ke.forEach(we),p=s0(he),L=Ye(he,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),he.forEach(we),P=s0(Y),N=Ye(Y,"DIV",{class:!0});var be=He(N);V=Ye(be,"LABEL",{class:!0,for:!0});var Le=He(V);Q=Ye(Le,"SPAN",{class:!0});var $e=He(Q);j=h0($e,"Google Cloud API Key"),$e.forEach(we),Le.forEach(we),B=s0(be),n=Ye(be,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),be.forEach(we),Y.forEach(we),O=s0(K),q=Ye(K,"BUTTON",{class:!0});var c0=He(q);Z=h0(c0,"Save"),c0.forEach(we),K.forEach(we),G=s0(T),ee=Ye(T,"FORM",{method:!0,class:!0});var _=He(ee);D=Ye(_,"BUTTON",{});var w=He(D);F=h0(w,"close"),w.forEach(we),_.forEach(we),T.forEach(we),this.h()},h(){de(s,"class","btn btn-sm btn-circle btn-ghost absolute right-2 top-2"),de(c,"class","font-bold text-lg"),de(e,"class","label-text"),de(y,"for","api-key-form"),de(y,"class","label"),de(M,"class","label-text"),de(b,"for","openai-api-key"),de(b,"class","label"),de(L,"id","openai-api-key"),de(L,"type","text"),de(L,"placeholder","Your key here"),de(L,"class","input input-bordered w-full"),de(l,"class","form-control w-full"),de(Q,"class","label-text"),de(V,"class","label"),de(V,"for","google-api-key"),de(n,"id","google-api-key"),de(n,"type","text"),de(n,"placeholder","Your key here"),de(n,"class","input input-bordered w-full"),de(N,"class","form-control w-full"),de($,"class","py-4"),de(q,"class","btn btn-success"),de(t,"method","dialog"),de(t,"class","modal-box"),de(t,"id","api-key-form"),de(ee,"method","dialog"),de(ee,"class","modal-backdrop"),de(o,"id","api_key_modal"),de(o,"class","modal")},m(i,T){u0(i,o,T),pe(o,t),pe(t,s),pe(s,h),pe(t,S),pe(t,c),pe(c,x),pe(t,H),pe(t,$),pe($,y),pe(y,e),pe(e,a),pe(e,f),pe(e,A),pe(e,k),pe(e,I),pe($,u),pe($,l),pe(l,b),pe(b,M),pe(M,r),pe(l,p),pe(l,L),yt(L,d[0]),pe($,P),pe($,N),pe(N,V),pe(V,Q),pe(Q,j),pe(N,B),pe(N,n),yt(n,d[1]),pe(t,O),pe(t,q),pe(q,Z),pe(o,G),pe(o,ee),pe(ee,D),pe(D,F),v||(m=[Z0(L,"input",d[2]),Z0(n,"input",d[3]),Z0(q,"click",d[4])],v=!0)},p(i,[T]){T&1&&L.value!==i[0]&&yt(L,i[0]),T&2&&n.value!==i[1]&&yt(n,i[1])},i:rt,o:rt,d(i){i&&we(o),v=!1,jt(m)}}}function _i(d,o,t){let s,h;x0(d,Ra,y=>t(5,s=y)),x0(d,Ma,y=>t(6,h=y));let S=h,c=s;function x(){S=this.value,t(0,S)}function H(){c=this.value,t(1,c)}return[S,c,x,H,()=>{Ma.set(S),Ra.set(c)}]}class ui extends Bt{constructor(o){super(),It(this,o,_i,oi,kt,{})}}function fi(d){let o,t,s,h,S,c;return o=new li({}),s=new ei({}),S=new ui({}),{c(){Gt(o.$$.fragment),t=i0(),Gt(s.$$.fragment),h=i0(),Gt(S.$$.fragment)},l(x){qt(o.$$.fragment,x),t=s0(x),qt(s.$$.fragment,x),h=s0(x),qt(S.$$.fragment,x)},m(x,H){Yt(o,x,H),u0(x,t,H),Yt(s,x,H),u0(x,h,H),Yt(S,x,H),c=!0},p:rt,i(x){c||(z0(o.$$.fragment,x),z0(s.$$.fragment,x),z0(S.$$.fragment,x),c=!0)},o(x){at(o.$$.fragment,x),at(s.$$.fragment,x),at(S.$$.fragment,x),c=!1},d(x){Ut(o,x),x&&we(t),Ut(s,x),x&&we(h),Ut(S,x)}}}class hi extends Bt{constructor(o){super(),It(this,o,null,fi,kt,{})}}export{hi as P,Mt as c,J1 as g};
